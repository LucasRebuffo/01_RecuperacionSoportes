import{h as ps,j as fs,y as gs}from"./bootstrap-vue-next.667fb585.js";import{e as de,r as g,g as ke,c as u,c3 as xe,C as _s,i as te,o as c,a as e,b as n,y as D,t as f,k as h,v,F as J,z as ce,x as ne,n as Q,j as s,w as M,d as $,c9 as hs,bY as Ge,f as T,aO as bs,A as G,p as he,l as ze,bb as vs,q as ys}from"./entry.5c5f6add.js";import{u as We}from"./composables.671b84f7.js";import{u as Je}from"./statistics.store.67d20fab.js";import{_ as Qe}from"./nuxt-link.851df10c.js";import{u as ue}from"./auth.store.db5a1ad4.js";import{_ as me}from"./_plugin-vue_export-helper.c27b6911.js";import{f as W}from"./fetch-wrapper.d0af2f5c.js";import{_ as be}from"./ToastComponent.vue.6c820df6.js";import{_ as Ve}from"./ModalComponent.vue.58c1e7f2.js";import{h as ve}from"./moment.55cb88ed.js";const Xe=de({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(k,{slots:m,attrs:y}){const r=g(!1);return ke(()=>{r.value=!0}),l=>{var E;if(r.value)return(E=m.default)==null?void 0:E.call(m);const _=m.fallback||m.placeholder;if(_)return _();const C=l.fallback||l.placeholder||"",i=l.fallbackTag||l.placeholderTag||"span";return u(i,y,C)}}}),ks=xe({id:"appSidebarMenu",state:()=>[{url:"/",icon:"fa-home",title:"Dashboard",isOpen:!1},{url:"/processes",icon:"fa-layer-group",title:"Processes",isOpen:!1},{url:"/instances",icon:"fa-server",title:"Instances",isOpen:!1},{url:"/insight",icon:"fa-chart-column",title:"Insight",isOpen:!1,children:[{url:"/insight/calendar",title:"Schedule for instances"},{url:"/insight/chart",title:"Execution chart"},{url:"/insight/chart_logs",title:"Logs error chart"},{url:"/execution",title:"Process execution"}]},{url:"/xperience",icon:"fa-rectangle-list",title:"Form Xperience",isOpen:!1,children:[{url:"/forms",title:"Forms"},{url:"/queues",title:"Queues"},{url:"/forms/users",title:"Forms Users"}]},{url:"/assets",icon:"fa-gears",title:"Assets",isOpen:!1},{url:"/ur",icon:"fa-users",title:"Users & Roles",isOpen:!1,children:[{url:"/users",title:"Users"},{url:"/roles",title:"Roles"}]},{url:"/logs",icon:"fa-file",title:"Logs",isOpen:!1},{url:"/config",icon:"fa-gear",title:"Config",isOpen:!1},{is_divider:!0,admin:!0},{url:"/clients",icon:"fa-user-tie",title:"Clients",isOpen:!1,admin:!0},{url:"/licenseadmin",icon:"fa-file-signature",title:"License Admin",isOpen:!1,admin:!0},{is_divider:!0}]}),we=xe({id:"appOption",state:()=>({appThemeClass:"theme-red",appDarkMode:"",appHeaderHide:!1,appHeaderFixed:!0,appHeaderInverse:!1,appHeaderSearchToggled:!1,appHeaderLanguageBar:!1,appSidebarTwo:!1,appSidebarHide:!1,appSidebarEnd:!1,appSidebarWide:!1,appSidebarLight:!0,appSidebarFixed:!0,appSidebarCollapsed:!1,appSidebarMobileToggled:!1,appSidebarMobileClosed:!1,appSidebarMinified:!1,appSidebarHover:!1,appSidebarSearch:!1,appSidebarEndToggled:!1,appSidebarEndMobileToggled:!1,appSidebarTransparent:!1,appTopMenu:!1,appContentFullHeight:!1,appContentClass:"",appFooter:!1,appFooterFixed:!1,appThemePanelToggled:!1})}),Ce=xe({id:"diskUsage",state:()=>({diskUsage:null,showDiskUsage:!0,loadingDiskUsage:!1,licenceExpiration:null}),actions:{setDiskUsage(k){this.diskUsage=k},disableDiskUsage(){this.showDiskUsage=!1},setLoadingDiskUsage(k){this.loadingDiskUsage=k},setLicenceExpiration(k){this.licenceExpiration=k}}}),xs={class:"menu-link"},ws={key:0,class:"menu-icon"},Cs={key:0,class:"w-5px h-5px rounded-3 bg-theme position-absolute top-0 end-0 mt-3px me-3px"},Ss={class:"menu-text ms-3"},$s={key:0,class:"menu-submenu"},Es={key:0,class:"menu-icon"},Us={key:0,class:"menu-label"},Ts=de({__name:"SidebarNav",props:{menu:{default:()=>({icon:"",text:"",url:"",highlight:!1,children:[],isOpen:!1})},index:{default:"-1"},isChild:{type:Boolean}},emits:["toggleSubmenu"],setup(k,{emit:m}){const y=_s(),r=ue(),l=m,_=i=>{const E=y.currentRoute.value.path;for(const F of i)if(F.url===E)return!0;return!1};let C=i=>{var E;return i.admin?((E=r==null?void 0:r.user)==null?void 0:E.entity_id)===1:!0};return(i,E)=>{const F=te("font-awesome-icon"),A=Qe;return i.menu.children?(c(),u("div",{key:0,class:Q(["menu-item has-sub cursor-pointer",{active:_(i.menu.children)}]),onClick:E[0]||(E[0]=B=>l("toggleSubmenu",i.index))},[e("a",xs,[i.menu.icon?(c(),u("span",ws,[n(F,{icon:i.menu.icon},null,8,["icon"]),i.menu.highlight?(c(),u("span",Cs)):D("",!0)])):D("",!0),e("span",Ss,f(i.menu.title),1),h(n(F,{icon:["fas","chevron-right"],class:"chevron-icon"},null,512),[[v,!i.menu.isOpen]]),h(n(F,{icon:["fas","chevron-down"],class:"chevron-icon"},null,512),[[v,i.menu.isOpen]])]),i.menu.isOpen?(c(),u("div",$s,[(c(!0),u(J,null,ce(i.menu.children,(B,U)=>(c(),ne(ye,{menu:B,index:U,isChild:!0},null,8,["menu","index"]))),256))])):D("",!0)],2)):s(C)(i.menu)?(c(),ne(s(hs),{key:1,to:i.menu.url,custom:""},{default:M(({isActive:B})=>[e("div",{class:Q(["menu-item",{active:B}])},[n(A,{href:i.menu.url,class:"menu-link"},{default:M(()=>[i.menu.icon?(c(),u("span",Es,[n(F,{icon:i.menu.icon},null,8,["icon"])])):D("",!0),e("span",{class:Q(["menu-text ms-3",{"text-gray-500":i.isChild}])},[$(f(i.menu.title)+" ",1),i.menu.label?(c(),u("span",Us,f(i.menu.label),1)):D("",!0)],2)]),_:1},8,["href"])],2)]),_:1},8,["to"])):D("",!0)}}});const ye=me(Ts,[["__scopeId","data-v-6cf8ed9c"]]),Ls={class:"m-2 px-3 sidebar-extra"},Ds={class:"m-0"},Ms={key:0,class:"w-100 d-flex justify-content-center"},Fs={class:"menu-item pointer mt-auto sidebar-extra"},Os={key:0,class:"w-100 d-flex justify-content-center"},Is={class:"card m-2 p-3 disk-usage"},Ns={key:0},Bs={class:"m-0"},As={key:1},Rs={class:"card-body border border-warning text-center"},Ps={class:"text-warning fs-6"},js={__name:"SidebarExtra",props:{actual_submits:{type:Number,default:0},total_submits:{type:Number,default:0},licenseExpirationFormatted:{type:String,default:""},loading_disk_usage:{type:Boolean,default:!1},loading_statistics:{type:Boolean,default:!1},storage_percentage:{type:Number,default:0},showDiskUse:{type:Boolean,default:!0}},setup(k){const m=Ce();return(y,r)=>{const l=te("font-awesome-icon"),_=te("h7");return c(),u(J,null,[r[5]||(r[5]=e("hr",{class:"sidebar-extra"},null,-1)),e("div",Ls,[r[0]||(r[0]=e("h5",{class:"mt-2"}," License expiration: ",-1)),e("h6",Ds,[h(e("span",null,f(k.licenseExpirationFormatted),513),[[v,!k.loading_disk_usage]])]),k.loading_disk_usage?(c(),u("div",Ms,[n(l,{icon:["fas","spinner"],spin:""})])):D("",!0)]),r[6]||(r[6]=e("hr",{class:"sidebar-extra"},null,-1)),e("div",Fs,[k.loading_disk_usage?(c(),u("div",Os,[n(l,{icon:["fas","spinner"],spin:""})])):D("",!0),e("div",Is,[k.showDiskUse?(c(),u("div",Ns,[r[2]||(r[2]=e("h5",null," Storage ",-1)),n(_,{class:"fw-bold d-flex align-items-center justify-content-start"},{default:M(()=>{var C,i;return[n(l,{class:"text-theme me-1",size:"sm",icon:["fas","hard-drive"]}),$(" "+f((C=s(m).diskUsage)==null?void 0:C.total_used)+" GB / "+f((i=s(m).diskUsage)==null?void 0:i.total_allowed)+" GB ("+f(k.storage_percentage)+"%) ",1)]}),_:1}),r[3]||(r[3]=e("hr",{class:"m-2"},null,-1)),e("div",null,[r[1]||(r[1]=e("h5",null," Monthly submits ",-1)),e("h6",Bs,[n(l,{class:"me-2 text-theme",size:"sm",icon:["fas","envelope"]}),h(n(l,{icon:["fas","spinner"],spin:""},null,512),[[v,k.loading_statistics]]),h(e("span",null,f(k.actual_submits)+" / "+f(k.total_submits),513),[[v,!k.loading_statistics]])])])])):(c(),u("div",As,[e("div",Rs,[e("span",Ps,[n(l,{icon:"fa-solid fa-triangle-exclamation"}),r[4]||(r[4]=$(" Your role does not allow you to see disk usage. "))])])]))])])],64)}}},Ye=js;const Hs={class:"app-sidebar-content"},qs={class:"menu h-100 d-flex flex-column"},zs={key:0,class:"menu-divider"},Vs=["tabindex"],Ys={class:"menu-item pointer"},Gs={class:"menu-icon"},Ws={class:"menu-item pointer"},Js={class:"menu-icon"},Qs={class:"menu h-100 d-flex flex-column"},Xs={key:0},Ks={key:0,class:"menu-divider"},Zs=["tabindex"],et={class:"menu-item pointer"},st={class:"menu-icon"},tt={class:"menu-item pointer"},nt={class:"menu-icon"},at={__name:"Sidebar",setup(k){const m=ue(),y=Ce(),r=Je(),l=Ge(),_=ks(),C=we(),i=d=>{var L;const b=!!((L=_[d])!=null&&L.isOpen);_.$reset(),_[d].isOpen=!b},E=d=>{var b;return d.admin?((b=m==null?void 0:m.user)==null?void 0:b.entity_id)===1:!0},F=We(),A=async()=>{try{await F.logout(),localStorage.getItem("alertLicense")&&localStorage.removeItem("alertLicense"),l.push({path:"/auth/login"})}catch(d){console.log(d)}},B=()=>{try{const d=document.documentElement;d.requestFullscreen?d.requestFullscreen():d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.msRequestFullscreen&&d.msRequestFullscreen(),document.fullscreenElement&&document.exitFullscreen()}catch(d){console.log(d)}},U=T(()=>y.showDiskUsage),o=T(()=>{var d,b,L;return((L=(b=(d=m==null?void 0:m.user)==null?void 0:d.entity)==null?void 0:b.options)==null?void 0:L.max_submits)||0}),R=T(()=>{var d,b;return(b=(d=r==null?void 0:r.statistics)==null?void 0:d.forms)==null?void 0:b.month}),H=T(()=>y.licenceExpiration?new Date(y.licenceExpiration).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"No license found"),j=T(()=>y.loadingDiskUsage),q=T(()=>r.statistics===null),z=T(()=>{try{return Math.round(y.diskUsage.total_used/y.diskUsage.total_allowed*100)}catch{return 0}});return(d,b)=>{const L=Xe,O=te("font-awesome-icon");return c(),u(J,null,[e("div",bs({id:"sidebar",class:"app-sidebar sidebar collapsed"},d.$attrs),[e("div",Hs,[e("div",qs,[e("div",null,[n(L,null,{default:M(()=>[(c(!0),u(J,null,ce(s(_),(x,I)=>(c(),u("div",{tabindex:1,key:x.url},[x.is_divider&&E(x)?(c(),u("div",zs)):(c(),u("div",{key:1,tabindex:I},[x.title?(c(),ne(ye,{key:0,menu:x,index:I,onToggleSubmenu:S=>i(I)},null,8,["menu","index","onToggleSubmenu"])):D("",!0)],8,Vs))]))),128))]),_:1}),e("div",Ys,[e("a",{onClick:A,class:"menu-link"},[e("span",Gs,[n(O,{icon:["fas","power-off"]})]),b[0]||(b[0]=e("span",{class:"menu-text ms-3"}," Logout ",-1))])]),e("div",Ws,[e("a",{onClick:B,class:"menu-link"},[e("span",Js,[n(O,{icon:["fas","expand"]})]),b[1]||(b[1]=e("span",{class:"menu-text ms-3"}," Full screen ",-1))])]),n(Ye,{licenseExpirationFormatted:s(H),loadingDiskUsage:s(j),actual_submits:s(R),total_submits:s(o),loading_statistics:s(q),storage_percentage:s(z),showDiskUse:s(U)},null,8,["licenseExpirationFormatted","loadingDiskUsage","actual_submits","total_submits","loading_statistics","storage_percentage","showDiskUse"])])])])],16),e("div",{id:"sidebar",class:Q(["mobile-sidebar",{"app-sidebar-grid":s(C).appSidebarGrid,"app-sidebar-transparent":s(C).appSidebarTransparent,"app-sidebar":!s(C).appSidebarCollapsed,"app-sidebar-minified":s(C).appSidebarCollapsed}])},[e("div",{class:Q(["app-sidebar-content",{"h-100":s(C).appSidebarFixed}])},[e("div",Qs,[s(C).appSidebarCollapsed?D("",!0):(c(),u("div",Xs,[n(L,null,{default:M(()=>[(c(!0),u(J,null,ce(s(_),(x,I)=>(c(),u("div",{tabindex:1,key:x.url},[x.is_divider&&E(x)?(c(),u("div",Ks)):(c(),u("div",{key:1,tabindex:I},[x.title?(c(),ne(ye,{key:0,menu:x,index:I,onToggleSubmenu:S=>i(I)},null,8,["menu","index","onToggleSubmenu"])):D("",!0)],8,Zs))]))),128))]),_:1}),e("div",et,[e("a",{onClick:A,class:"menu-link"},[e("span",st,[n(O,{icon:["fas","power-off"]})]),b[2]||(b[2]=e("span",{class:"menu-text"}," Logout ",-1))])]),e("div",tt,[e("a",{onClick:B,class:"menu-link"},[e("span",nt,[n(O,{icon:["fas","expand"]})]),b[3]||(b[3]=e("span",{class:"menu-text"}," Full screen ",-1))])]),n(Ye,{licenseExpirationFormatted:s(H),loadingDiskUsage:s(j),actual_submits:s(R),total_submits:s(o),loading_statistics:s(q),storage_percentage:s(z),showDiskUse:s(U)},null,8,["licenseExpirationFormatted","loadingDiskUsage","actual_submits","total_submits","loading_statistics","storage_percentage","showDiskUse"])]))])],2)],2)],64)}}},ot=me(at,[["__scopeId","data-v-625f3f0b"]]),it={id:"header",class:"app-header bg-rocketbot header-padding"},lt={class:"navbar-header flex-row flex-nowrap"},rt={class:"navbar-nav"},ct={class:"connectInstancesWrapper"},dt={class:"text-white d-none d-md-inline"},ut={href:"#","data-bs-toggle":"dropdown",class:"navbar-item text-white fs-20px fw-light text-nowrap d-flex align-items-center justify-content-center d-none d-lg-inline pointer text-decoration-none"},mt={class:"text-white"},pt={class:"navbar-item navbar-user dropdown"},ft={href:"#",class:"navbar-link dropdown-toggle d-flex align-items-center white","data-bs-toggle":"dropdown"},gt={class:"dropdown-menu dropdown-menu-end me-1 pt-0 rounded pointer"},_t={class:"mb-0"},ht={class:"text-muted"},bt={key:0,class:"navbar-divider d-none d-md-block"},vt={key:1,class:"navbar-item d-none d-md-block"},yt=de({__name:"Header",emits:["openCompanyModal"],setup(k,{emit:m}){const y=we(),r=ue(),l=Ge(),_=m;function C(){_("openCompanyModal")}function i(){y.appSidebarMobileToggled=!y.appSidebarMobileToggled}function E(){y.appSidebarEndToggled=!y.appSidebarEndToggled}function F(){window.addEventListener("resize",function(){let U=document.querySelector(".app-top-menu");U&&U.removeAttribute("style")})}ke(()=>{F()});const A=We(),B=async()=>{try{await A.logout(),localStorage.getItem("alertLicense")&&localStorage.removeItem("alertLicense"),l.push({path:"/auth/login"})}catch(U){console.log(U)}};return(U,o)=>{var H,j,q,z,d,b,L,O;const R=Qe;return c(),u("div",it,[e("div",lt,[n(R,{href:"/",class:"navbar-brand ps-0"},{default:M(()=>o[4]||(o[4]=[e("img",{style:{width:"30px"},src:"/img/ROC.png",alt:"Rocketbot Orchestrator"},null,-1),e("h2",{class:"ms-3 mb-0 text-white d-none d-xs-none d-sm-none d-md-block d-lg-block"},"Orchestrator",-1),e("small",{class:"text-white ms-2"},"by Rocketbot",-1)])),_:1}),s(y).appSidebarHide?D("",!0):(c(),u("button",{key:0,type:"button",class:"navbar-mobile-toggler",onClick:o[0]||(o[0]=x=>i())},[n(s(G),{style:{color:"white"},icon:["fas","bars"]})]))]),e("div",rt,[e("div",ct,[n(R,{href:"/instances",class:"btn btn-outline-light mx-4 connect"},{default:M(()=>o[5]||(o[5]=[$(" Connect Instances ")])),_:1})]),e("div",{onClick:o[1]||(o[1]=x=>C()),class:"navbar-item text-white fs-20px pointer text-nowrap d-flex align-items-center justify-content-center me-5"},[n(s(G),{class:"px-1",icon:"fa-briefcase",size:"xs"}),e("span",dt,f(((q=(j=(H=s(r))==null?void 0:H.user)==null?void 0:j.entity)==null?void 0:q.name)||"Company"),1)]),e("a",ut,[e("span",mt,f(((d=(z=s(r))==null?void 0:z.user)==null?void 0:d.name)||"User"),1)]),e("div",pt,[e("a",ft,[n(s(G),{icon:"fa-solid fa-user"}),o[6]||(o[6]=e("b",{class:"caret"},null,-1))]),e("div",gt,[n(R,{href:"/profile",class:"dropdown-item rounded-top"},{default:M(()=>{var x,I,S,Y,ae,oe;return[e("h4",_t,f(((I=(x=s(r))==null?void 0:x.user)==null?void 0:I.name)||"User"),1),e("span",ht,f((Y=(S=s(r))==null?void 0:S.user)!=null&&Y.email?`${(oe=(ae=s(r))==null?void 0:ae.user)==null?void 0:oe.email}`:""),1)]}),_:1}),o[10]||(o[10]=e("div",{class:"dropdown-divider"},null,-1)),n(R,{class:"dropdown-item pointer",href:"/profile"},{default:M(()=>[n(s(G),{icon:"fa-solid fa-user"}),o[7]||(o[7]=$(" My profile "))]),_:1}),e("a",{class:"dropdown-item pointer",onClick:o[2]||(o[2]=x=>C())},[n(s(G),{icon:"fa-briefcase"}),o[8]||(o[8]=$(" Profile ")),e("b",null,f(((O=(L=(b=s(r))==null?void 0:b.user)==null?void 0:L.entity)==null?void 0:O.name)||"Company"),1)]),o[11]||(o[11]=e("div",{class:"dropdown-divider"},null,-1)),e("a",{class:"dropdown-item d-flex align-items-center",onClick:o[3]||(o[3]=x=>B())},[n(s(G),{icon:"fa-solid fa-sign-out-alt"}),o[9]||(o[9]=$(" Log Out "))])])]),s(y).appSidebarTwo?(c(),u("div",bt)):D("",!0),s(y).appSidebarTwo?(c(),u("div",vt,[e("a",{href:"javascript:;",onClick:E,class:"navbar-link icon"},o[12]||(o[12]=[e("i",{class:"fa fa-th"},null,-1)]))])):D("",!0)])])}}});const kt=me(yt,[["__scopeId","data-v-10761a25"]]),xt={class:"row"},wt={class:"col"},Ct={class:"text-center text-break"},St={class:"row"},$t={class:"col d-flex justify-content-center"},Et={class:"container"},Ut={class:"row"},Tt={class:"col d-flex flex-row justify-content-between"},Lt={class:"m-0"},Dt=["readonly"],Mt={class:"btn-group"},Ft=["disabled"],Ot=["disabled"],It={class:"row mt-3"},Nt={class:"col"},Bt={class:"row mt-3"},At={class:"col-6 col-md-4 valueBox"},Rt={class:"row mt-3"},Pt={class:"col-md-12 valueBox"},jt=["disabled"],Ht=["disabled"],qt={class:"mt-3"},zt={class:"form-label text-start",for:"confirmationInput"},Vt={class:"input-group"},Yt=["disabled"],Gt={class:"row mt-3"},Wt={class:"col-md-12 valueBox"},Jt={class:"card mt-2"},Qt={class:"card-body border border-warning text-center"},Xt={class:"text-warning fs-5"},Kt=de({__name:"default",setup(k){const m=Ce(),{$bootstrap:y}=ys(),r=we(),l=ue(),_=Je(),C=g([{title:"Users",icon:"fa-solid fa-user",max_key:"max_users",key:"users"},{title:"Projects",icon:"fa-solid fa-box",max_key:"max_projects",key:"projects"},{title:"Processes",icon:"fa-solid fa-layer-group",max_key:"max_processes",key:"processes"},{title:"Instances",icon:"fa-solid fa-server",max_key:"max_instances",key:"instances"},{title:"Forms",icon:"fa-solid fa-rectangle-list",max_key:"max_forms",key:"forms"},{title:"Assets",icon:"fa-solid fa-gear",key:"assets"}]),i=g(null);g(null);const E=()=>{var t;(t=i.value)==null||t.classList.add("expanded");const a=document.getElementById("sidebar");a&&a.classList.remove("collapsed")},F=()=>{var t;(t=i.value)==null||t.classList.remove("expanded");const a=document.getElementById("sidebar");a&&a.classList.add("collapsed")},A=g(!1);let B=g(null),U=g(!1),o=g("");const R=T(()=>{var a,t;try{return JSON.parse((t=(a=l==null?void 0:l.user)==null?void 0:a.roles[0])==null?void 0:t.permissions.find(w=>w.slug==="config").pivot.extra).change_name}catch{return!1}});function H(){var a,t;A.value=!0,(t=(a=_==null?void 0:_.statistics)==null?void 0:a.forms)!=null&&t.month||j()}async function j(){S.value.loadingSubmits=!0;try{await W.post("/robots/statistics").then(a=>{_.storeStatistics(a.data),_.setShowStatistics(!0)})}catch{_.storeStatistics({forms:{month:0}}),X("Error getting statistics","danger"),_.setShowStatistics(!1)}finally{S.value.loadingSubmits=!1}}function q(){A.value=!1,d(),Ie()}function z(){var a,t;U.value=!0,o.value=(t=(a=l==null?void 0:l.user)==null?void 0:a.entity)==null?void 0:t.name}function d(){U.value=!1,o.value="",S.value.changingCompanyName=!1}const b=g(null),L=g(!1),O=g(!1),x=g("");function I(){L.value=!1,O.value&&localStorage.setItem("alertLicense","true")}let S=g({changingCompanyName:!1,loadingSubmits:!1});const Y=g({});ke(async()=>{try{const a=await W.post("/clients/me");pe(),j();const t=a.data.options.license;if(t){m.setLicenceExpiration(t);const p=ve(t),_e=ve(),se=p.diff(_e,"days");localStorage.getItem("alertLicense")===null&&(se<7||se<30)&&(x.value="Your license will expire in "+se+" days",L.value=!0)}Y.value=a.data.counts;const w=new URL(window.location.href);l.justLoggedIn&&w.origin.includes("orchestrator-v2.myrb.io")&&ae()}catch(a){console.log(a)}});const ae=()=>{let a=document.getElementById("orqToast");new y.Toast(a,{autohide:!1}).show()},oe=g("All changes you make on this new Orchestrator version will be real, they will be reflected on the old version."),Se=g(""),$e=g("warning");async function Ke(){S.value.changingCompanyName=!0;const a=await Ze();if(a.result)l.user.entity.name=o.value,d();else{Se.value=a.message,$e.value="danger";let t=document.getElementById("companyToast");new y.Toast(t,{autohide:!0}).show()}S.value.changingCompanyName=!1}async function Ze(){var a,t,w;try{const p=await W.post("/clients/name",{name:o.value,client_id:(a=l==null?void 0:l.user)==null?void 0:a.entity_id});return p.success?{result:!0}:{result:!1,message:((t=p==null?void 0:p.data)==null?void 0:t.message)||"Error changing company name"}}catch(p){return{result:!1,message:((w=p==null?void 0:p.data)==null?void 0:w.message)||"Error changing company name"}}}const es=T(()=>{try{if(l.user.entity.options.license)return ve(l.user.entity.options.license).format("DD/MM/YYYY")}catch{return""}}),ie=T(()=>m.loadingDiskUsage),Ee=T(()=>m.showDiskUsage),Ue=g(""),Te=g("danger"),pe=async function(){try{m.setLoadingDiskUsage(!0),await W.post("/diskUsage").then(a=>{if(a.success)fe.value=a.data.total_used,ge.value=a.data.total_allowed,m.setDiskUsage(a.data);else throw new Error("Error getting disk usage")})}catch{m.disableDiskUsage()}finally{m.setLoadingDiskUsage(!1)}},X=(a,t)=>{Ue.value=a,Te.value=t;let w=document.getElementById("dataLoadToast");new y.Toast(w,{autohide:!0}).show()},fe=g(null),ge=g(null),le=T(()=>{try{return Math.round(fe.value/ge.value*100)}catch{return 0}}),Le=T(()=>le.value>=90),ss=T(()=>le.value>=70),ts=()=>Le.value?"danger":ss.value?"warning":"success",De=T(()=>{var a,t,w;return((w=(t=(a=l==null?void 0:l.user)==null?void 0:a.entity)==null?void 0:t.options)==null?void 0:w.max_submits)||0}),Me=T(()=>{var a,t;return(t=(a=_==null?void 0:_.statistics)==null?void 0:a.forms)==null?void 0:t.month}),ns=T(()=>Me.value>=De.value),K=g(!1),V=g(""),P=g(null);class Fe{constructor(t=""){this.message=t}execute(){}}class as extends Fe{constructor(t,w){super(w),this.receiver=t}execute(){this.receiver.clearAll()}}class os extends Fe{constructor(t,w){super(w),this.receiver=t}execute(){this.receiver.clearProcessed()}}const Z=g(!1),ee=g(!1);class is{async clearAll(){try{Z.value=!0,await W.post("/deleteAllFiles").then(t=>{if(t.success)X("All files deleted successfully","success"),pe();else throw new Error("Error deleting all files")})}catch{X("Error deleting all files","danger")}finally{Z.value=!1}}async clearProcessed(){try{ee.value=!0,await W.post("/keepUnprocessed").then(t=>{if(t.success)X("Processed files deleted successfully","success"),pe();else throw new Error("Error deleting processed files")})}catch{X("Error deleting processed files","danger")}finally{ee.value=!1}}}const ls=()=>{K.value=!0,P.value=cs},rs=()=>{K.value=!0,P.value=ds},Oe=new is,cs=new as(Oe,"clear all"),ds=new os(Oe,"clear processed"),us=async()=>{V.value===P.value.message?(await P.value.execute(),K.value=!1,V.value="",P.value=null):alert(`Incorrect confirmation word. Please type '${P.value.message}' to proceed.`)},Ie=()=>{K.value=!1,V.value="",P.value=null};return(a,t)=>{const w=ps,p=te("font-awesome-icon"),_e=fs,se=gs,ms=Xe;return c(),ne(ms,null,{default:M(()=>{var Ne;return[n(be,{text:s(oe),variant:"warning",id:"orqToast"},null,8,["text"]),n(be,{text:s(Ue),variant:s(Te),id:"dataLoadToast"},null,8,["text","variant"]),n(be,{text:s(Se),variant:s($e),id:"companyToast"},null,8,["text","variant"]),e("div",{class:Q(["app app-header-fixed app-sidebar-fixed",{"app-sidebar-mobile-toggled":(Ne=s(r))==null?void 0:Ne.appSidebarMobileToggled}])},[n(kt,{onOpenCompanyModal:H}),n(ot,{onMouseenter:E,onMouseleave:F}),e("div",{ref_key:"appContent",ref:i,class:"app-content"},[n(Ve,{ref_key:"licenseDateModalRef",ref:b,show:s(L),header:{title:"Your license is about to expire",theme:"warning"},type:"confirmation",modalClass:"modal-md",onCancel:I},{default:M(()=>[e("div",xt,[e("div",wt,[e("h3",Ct,f(s(x)),1)])]),e("div",St,[e("div",$t,[n(w,{modelValue:s(O),"onUpdate:modelValue":t[0]||(t[0]=re=>he(O)?O.value=re:null)},{default:M(()=>t[3]||(t[3]=[$(" Do not show me again for the remainder of the session ")])),_:1},8,["modelValue"])])])]),_:1},8,["show"]),n(Ve,{ref_key:"companyModalRef",ref:B,show:s(A),header:{title:"Company info",theme:"dark"},type:"confirmation",modalClass:"modal-md",onCancel:q},{default:M(()=>{var re,Be,Ae,Re,Pe;return[e("div",Et,[e("div",Ut,[e("div",Tt,[h(e("h2",Lt,[n(p,{icon:"fa-solid fa-briefcase"}),$(" "+f((Ae=(Be=(re=s(l))==null?void 0:re.user)==null?void 0:Be.entity)==null?void 0:Ae.name),1)],512),[[v,!s(U)]]),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=N=>he(o)?o.value=N:o=N),readonly:s(S).changingCompanyName,type:"text",class:"form-control me-2"},null,8,Dt),[[v,s(U)],[ze,s(o)]]),h(e("button",{onClick:z,class:"btn btnInfoBorderLight"},[n(p,{icon:"fa-solid fa-pencil"})],512),[[v,!s(U)&&s(R)]]),h(e("div",Mt,[e("button",{onClick:Ke,disabled:s(o).trim()===""||s(S).changingCompanyName,class:"btn btnSuccessBorderLight text-nowrap"},[h(n(p,{icon:["fas","spinner"],spin:""},null,512),[[v,s(S).changingCompanyName]]),h(n(p,{icon:"fa-solid fa-check"},null,512),[[v,!s(S).changingCompanyName]])],8,Ft),e("button",{onClick:d,disabled:s(S).changingCompanyName,class:"btn btnErrorBorderLight"},[n(p,{icon:"fa-solid fa-xmark"})],8,Ot)],512),[[v,s(R)&&s(U)]])])]),e("div",It,[e("div",Nt,[e("h3",null," License expiration: "+f(s(es)),1)])]),e("div",Bt,[(c(!0),u(J,null,ce(s(C),N=>{var je,He,qe;return c(),u("div",At,[e("div",null,[e("h4",null,[n(p,{class:"me-1",icon:N.icon},null,8,["icon"]),$(" "+f(N.title),1)]),e("div",null,[h(e("h5",null,f(s(Y)[N.key]),513),[[v,!N.max_key]]),h(e("h5",null,f(s(Y)[N.key])+"/"+f(((qe=(He=(je=s(l))==null?void 0:je.user)==null?void 0:He.entity)==null?void 0:qe.options[N.max_key])||""),513),[[v,N.max_key]])])])])}),256))]),h(e("div",null,[e("div",Rt,[e("div",Pt,[e("h3",null,[t[4]||(t[4]=$(" Storage ")),h(n(p,{size:"sm",style:{color:"rgb(245, 156, 26)"},icon:["fas","triangle-exclamation"]},null,512),[[v,s(Le)]])]),h(e("h4",null,[n(p,{icon:["fas","spinner"],spin:""})],512),[[v,s(ie)]]),h(e("h4",null,[n(p,{class:"me-1",size:"sm",icon:["fas","hard-drive"]}),$(" "+f(s(fe))+" GB / "+f(s(ge))+" GB ("+f(s(le))+"%) ",1)],512),[[v,!s(ie)]]),n(_e,{striped:"",animated:s(ie),variant:ts(),value:s(le)},null,8,["animated","variant","value"]),n(se,{class:"mt-2 float-end"},{default:M(()=>[e("button",{class:"btn btnErrorBorderLight",disabled:s(Z)||s(ee),onClick:ls},[h(n(p,{icon:["fas","spinner"],spin:""},null,512),[[v,s(Z)]]),t[5]||(t[5]=$(" Clear all files "))],8,jt),e("button",{class:"btn btnWarningBorderLight",disabled:s(Z)||s(ee),onClick:rs},[h(n(p,{icon:["fas","spinner"],spin:""},null,512),[[v,s(ee)]]),t[6]||(t[6]=$(" Clear processed files "))],8,Ht)]),_:1}),h(e("div",qt,[e("label",zt,[t[7]||(t[7]=$(" Please type ")),e("b",null," '"+f((Re=s(P))==null?void 0:Re.message)+"' ",1),t[8]||(t[8]=$(" to confirm (case insensitive) "))]),e("div",Vt,[h(e("input",{type:"text",id:"confirmationInput",class:"form-control",autocomplete:"off","onUpdate:modelValue":t[2]||(t[2]=N=>he(V)?V.value=N:null)},null,512),[[ze,s(V)]]),e("button",{onClick:us,disabled:s(V).toLowerCase()!==((Pe=s(P))==null?void 0:Pe.message.toLowerCase()),type:"button",class:"btn btn-success"}," Confirm ",8,Yt),e("button",{onClick:Ie,type:"button",class:"btn btn-danger"},"Cancel")])],512),[[v,s(K)]])])]),e("div",Gt,[e("div",Wt,[e("h3",null,[t[9]||(t[9]=$(" Monthly submits ")),h(n(p,{size:"sm",style:{color:"rgb(245, 156, 26)"},icon:["fas","triangle-exclamation"]},null,512),[[v,!s(S).loadingSubmits&&s(ns)]])]),e("h4",null,[n(p,{class:"me-2",size:"sm",icon:["fas","envelope"]}),h(n(p,{icon:["fas","spinner"],spin:""},null,512),[[v,s(S).loadingSubmits]]),h(e("span",null,f(s(Me))+" / "+f(s(De)),513),[[v,!s(S).loadingSubmits]])])])])],512),[[v,s(ie)||s(Ee)]]),h(e("div",Jt,[e("div",Qt,[e("span",Xt,[n(p,{icon:"fa-solid fa-triangle-exclamation"}),t[10]||(t[10]=$(" Your role does not allow you to see disk usage. "))])])],512),[[v,!s(Ee)]])])]}),_:1},8,["show"]),e("div",null,[vs(a.$slots,"default",{},void 0,!0)])],512)],2)]}),_:3})}}});const un=me(Kt,[["__scopeId","data-v-07ea2e63"]]);export{un as default};
