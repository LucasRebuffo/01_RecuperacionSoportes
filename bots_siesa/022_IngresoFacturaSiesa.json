{"project":{"commands":[{"father":"trycatch","command":"","id":"19e15d07-8d5d-6822-d52c-ce656297bf4f","group":"logic","mode_live":false,"children":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso\"}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"cleanVars","id":"2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.1","execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.003996610641479492","extra":[]},{"father":"setVar","command":"False","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"64a65984-2395-df12-ab3c-a16e62ac2253","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.2","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0010006427764892578","extra":[],"description":"se inicializa bandera de proceso"},{"father":"setVar","command":"False","index":2,"execute_debugg":0,"img":"","screenshot":"","line":"1.3","description":"Se inicializo la variable para identificar la navegacion exitosa en el portal Siesa","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"346e7071-bdda-4847-dfa8-eab346718909","group":"system","mode_live":false,"var":"loc022ContinuarProceso","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"execScriptPython","command":"from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar(\"gblRutaLogs\")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj[\"profile\"][\"name\"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\nempresa = GetVar(\"gblPrefijoEmpresa\")\ncentro_costos = GetVar(\"gblCentroDeCostos\")\ntipo_documento = GetVar(\"gblTipoDeDocumento\")\nnumero_documento = GetVar(\"gblNumeroDocumento\")\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario[\"Empresa\"] = empresa\ndiccionario[\"Centro de costos\"] = centro_costos\ndiccionario[\"Tipo de documento\"] = tipo_documento\ndiccionario[\"Número de documento\"] = numero_documento\n\n# Registro informativo del contenido que se enviará\nlogger.info(f\"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}\")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar(\"loc022ListaIngresoInformacion\", lista_listas)","index":3,"execute_debugg":0,"img":"","screenshot":"","line":"1.4","description":"Se creará una lista de listas con la información que se ingresará en el aplicativo Siesa 8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"8454e51d-6443-7b97-9da7-5b6d6c3b5a23","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"for","command":"{\"iterable\":\"{loc022ListaIngresoInformacion}\",\"count\":0}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","var":"loc022ItemActual","id":"29eb5feb-8b91-a873-f1f2-3aa7ae3df98e","group":"logic","mode_live":false,"children":[{"father":"setVar","command":"{loc022ItemActual}[0]","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.5.1","description":"asiganamos el nombre de la opcion donde ingresamos la informacion","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"4718a463-997b-fb3b-47ed-a6ef85448447","group":"system","mode_live":false,"var":"loc022NombreOpcion","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"setVar","command":"{loc022ItemActual}[1]","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"1.5.2","description":"asiganamos el valor que ingresaremos en el aplicativo siesa 8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"65033dbc-3443-4d5f-9eac-c7aa41005595","group":"system","mode_live":false,"var":"loc022ValorOpcion","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"send_keys","command":"{\"text\":\"{loc022ValorOpcion}\"}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"6be04214-4021-5890-6572-ba4980d87137","group":"desktop","mode_live":false,"children":[],"else":[],"line":"1.5.3","execute":2,"index":2,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.18750357627868652","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}\"}","disabled":false,"index":3,"execute_debugg":0,"img":"","screenshot":"","line":"1.5.4","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"1624a967-1efa-8e0b-f9f3-c9519a6a3c42","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"wait","command":"1","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"0c7fed35-b382-d9d8-ace3-1ce877583b8a","group":"system","mode_live":false,"children":[],"else":[],"line":"1.5.5","execute":2,"index":4,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"1.0156588554382324","extra":[]}],"else":[],"line":"1.5","description":"Iteramos la información que debemos ingresar en el aplicativo Siesa 8.5.","execute":2,"index":4,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":false,"count":4}},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"Se envio un enter para confirmar el numero de documento ingresado\"}","index":5,"execute_debugg":0,"img":"","screenshot":"","line":"1.6","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"22f660a1-9920-3b46-8c5e-5b46e1e111b9","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"send_keys","command":"{\"key\":\"ENTER\"}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be","group":"desktop","mode_live":false,"children":[],"else":[],"line":"1.7","description":"Se envio un enter para confirmar el numero de documento ingresado","execute":2,"index":6,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.10937905311584473","extra":[]},{"father":"wait","command":"1","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"04edb12e-ff30-113e-182c-8f765c1c0fa5","group":"system","mode_live":false,"children":[],"else":[],"line":"1.8","execute":2,"index":7,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"1.015662431716919","extra":[]},{"father":"send_keys","command":"{\"text\":\"2\"}","index":8,"execute_debugg":0,"img":"","screenshot":"","line":"1.9","description":"Se envio el numero 2 para seleccionar la opcion NCIF del aplicativo Siesa 8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"76d049ad-15e0-5554-2b9e-72d15dde9402","group":"desktop","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.06251096725463867","extra":[]},{"father":"wait","command":"1","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"25626bbd-0d69-5894-daec-effff4debadb","group":"system","mode_live":false,"children":[],"else":[],"line":"1.10","execute":2,"index":9,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"1.0000391006469727","extra":[]},{"father":"execRocketBotDB","command":"004_ObtenerInformacionDePantallaSiesa8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"f941d7da-cd1d-b59f-4470-130cf1428c87","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.11","execute":2,"index":10,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"3.375136137008667","extra":[]},{"father":"evaluateIf","command":"\"\"\"{gblInfoPantalla}\"\"\" != \"\"","index":11,"execute_debugg":0,"img":"","screenshot":"","line":"1.12","description":"Se valido si se obtiene la informacion correspondiente del aplicativo Siesa","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"9d090eb6-bfbd-8b83-99d4-c41f02f3350c","group":"logic","mode_live":false,"children":[{"father":"execScriptPython","command":"from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar(\"gblRutaLogs\")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj[\"profile\"][\"name\"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar(\"gblInfoPantalla\")\nlogger.info(\"Se obtiene la información del portapapeles\")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find(\"contabilizacion\")\n\nif palabra_referencia != -1:\n    logger.info(\"Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente\")\n    SetVar(\"loc022ContinuarProceso\", True)\nelse:\n    logger.info(\"No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito\")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar(\"loc022ContinuarProceso\", False)","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.12.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"a09c2704-b0f5-b0b6-9c83-23198dc548b8","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"else":[],"execute":2,"message":"","time":"0.0","extra":{"res":"True"}},{"father":"evaluateIf","command":"not {loc022ContinuarProceso}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"32410a28-3fe1-da5e-8f7e-961a22059976","group":"logic","mode_live":false,"children":[{"father":"setVar","command":"False","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"357a8897-a538-ef60-edc5-06b4374a6567","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.13.1","execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0009999275207519531","extra":[],"description":"se inicializa bandera de proceso"},{"father":"stop","command":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"415dc673-14ba-1df8-04a1-b13e1db2a53e","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.13.2","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":""}],"else":[],"line":"1.13","description":"Se valido si fue posible ingresar la informacion y continuar con la siguiente parte del proceso","execute":2,"index":12,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":"False"}},{"father":"setVar","command":"True","index":13,"execute_debugg":0,"img":"","screenshot":"","line":"1.14","description":"se inicializa bandera de proceso","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"95751de0-5dbf-b255-96db-e536c8e4db61","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"else":[],"line":1,"execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0009992122650146484","extra":{"res":true}}],"ifs":[{"id":"9d090eb6-bfbd-8b83-99d4-c41f02f3350c"}],"modules":[{"name":"System++","status":"Installed","version":"2.5","last_version":"2.5"},{"name":"sendToLogs","status":"Installed","version":"2.0"},{"name":"Vortex-Utils","status":"Installed","version":"1.0"},{"name":"clipboard","status":"Installed","version":"3.2.1","last_version":"3.2.1"}],"profile":{"log_destination":"db_path","deactivate_log":false,"log_path":null,"name":"022_IngresoFacturaSiesa","description":"Bot diseñado para ingresar la información de las facturas en el aplicativo Siesa 8.5."},"vars":[{"name":"gblCentroDeCostos","data":"001","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"gblPrefijoEmpresa","data":"TI","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"gblTipoDeDocumento","data":"CA","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"gblNumeroDocumento","data":"296","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"loc022ListaIngresoInformacion","data":"","type":"string","category":"Estructura ingreso informacion siesa 8.5","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"loc022ItemActual","data":"","type":"string","category":"iteracion","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"loc022ValorOpcion","data":"","type":"string","category":"Estructura ingreso informacion siesa 8.5","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"loc022NombreOpcion","data":"","type":"string","category":"Estructura ingreso informacion siesa 8.5","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblInfoPantalla","data":"Using username \"energizando\".\r\nLast login: Tue Oct 21 12:35:33 2025 from 190.145.210.50\r\n+------------------------------------------------------------------------------+ | Ver.006.20250218           CONTABILIDAD GENERAL            OCTUBRE  21, 2025 | | UFCG1021            DOCUMENTOS - CONSULTA POR NUMERO                ROCKET   | +------------------------[ UFCG1C01.Ver.011.20250218 ]-------------------------+ +---------------------------------[ DOCUMENTO ]--------------------------------+ |Empresa : TI  C.O: 001 Doc.Nro: CA-000296 Fecha: 2021/04/30 Doct_Alt: RR077   | |Tercero : 891200200          CENTRALES ELECTRICAS DE NARINO SA                | |Doc_Ref.:     -29507832                                                       | | Libro          Valor_Docto       Valor_Debito      Valor_Credito             | | NCIF             67,810.00          67,810.00          67,810.00             | +------------------------------------------------------------------------------+                         +-------------------------+                                                      |   OPCIONES A CONSULTAR  |                                                      |-------------------------|                                                      |> Otros Datos Basicos    |                                                      |  Contabilizacion        |                                                      |  Movimiento - Cartera   |                                                      +-------------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                Enter-Acepta                                         PageDown PageUp ESC-Retorna na \r\n\r\n","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"loc022ContinuarProceso","data":"","type":"string","category":"validacion","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblBandProceso","data":"True","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true}],"expose":{"title":{"en":"022_IngresoFacturaSiesa expose","es":"022_IngresoFacturaSiesa expose","pr":"022_IngresoFacturaSiesa expose"},"description":{"en":"Bot diseñado para ingresar la información de las facturas en el aplicativo Siesa 8.5.","es":"Bot diseñado para ingresar la información de las facturas en el aplicativo Siesa 8.5.","pr":"Bot diseñado para ingresar la información de las facturas en el aplicativo Siesa 8.5."},"form":[]}}}