2025-11-05 14:33:46.683720 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:33:46.699120 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:33:46.699120 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:33:46.714755 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:33:46.730380 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:33:46.730380 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:33:46.730380 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:33:47.855397 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:33:47.871020 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:33:50.871714 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:33:51.371728 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:33:54.375133 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:33:54.703260 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:33:57.714042 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:33:57.729668 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:33:57.729668 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:33:57.729668 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:33:57.729668 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:33:58.740168 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:33:58.927673 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:33:58.927673 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:33:59.943320 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:00.005824 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:00.005824 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:01.005854 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:01.083972 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:01.099598 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:34:01.099598 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:34:01.099598 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:34:01.099598 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:34:01.130865 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:34:01.130865 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:34:01.130865 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:34:01.146478 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:34:01.162104 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:34:03.177780 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:34:03.177780 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:34:03.748793 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:34:04.123803 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:34:05.130995 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:34:05.240376 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:34:06.256023 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:34:06.756036 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:34:08.759726 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:34:08.775353 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:34:08.775353 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:34:08.775353 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:34:08.775353 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:34:09.791003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:34:09.978513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:34:09.978513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:34:10.994160 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:11.056665 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:11.056665 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:12.072314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:12.150439 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:12.150439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:34:12.150439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:34:12.150439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:34:12.150439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:34:12.181705 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:34:12.197320 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:34:12.197320 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:34:12.212942 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:13.214753 - rocketbot - INFO - For count: 0
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:13.214753 - rocketbot - INFO - For count: 1
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:34:13.214753 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:34:13.277260 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:34:13.277260 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:34:14.283734 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:14.299360 - rocketbot - INFO - For count: 2
2025-11-05 14:34:14.299360 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:34:14.299360 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:34:14.314985 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:34:14.377490 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:34:14.377490 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:34:15.393144 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:15.393144 - rocketbot - INFO - For count: 3
2025-11-05 14:34:15.393144 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:34:15.393144 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:34:15.393144 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:34:15.455643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:34:15.455643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:34:16.455671 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:16.455671 - rocketbot - INFO - For count: 4
2025-11-05 14:34:16.455671 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:34:16.455671 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:34:16.455671 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:34:16.518174 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:34:16.518174 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:34:17.525778 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:17.525778 - rocketbot - INFO - For count: 5
2025-11-05 14:34:17.525778 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:34:17.525778 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:34:17.525778 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:34:17.588280 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:34:17.588280 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:34:18.596082 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:34:18.596082 - rocketbot - INFO - For count: 5
2025-11-05 14:34:18.596082 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:34:18.611712 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:34:18.611712 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:34:18.611712 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:34:18.611712 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:34:19.614568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:34:19.802069 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:34:19.895826 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:34:20.895852 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:20.958358 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:20.958358 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:21.958386 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:34:22.036508 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:34:22.052138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:34:22.052138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:34:22.067760 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:34:22.067760 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:34:22.067760 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:25.077452 - rocketbot - INFO - For count: 0
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:25.077452 - rocketbot - INFO - For count: 1
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:34:25.077452 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:34:25.202458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:34:25.202458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:34:26.218107 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:26.218107 - rocketbot - INFO - For count: 2
2025-11-05 14:34:26.218107 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:34:26.218107 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:34:26.218107 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:34:26.405614 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:34:26.405614 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:34:27.421263 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:27.421263 - rocketbot - INFO - For count: 3
2025-11-05 14:34:27.421263 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:34:27.421263 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:34:27.421263 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:34:27.546268 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:34:27.546268 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:34:28.550138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:28.550138 - rocketbot - INFO - For count: 4
2025-11-05 14:34:28.550138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:34:28.550138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:34:28.550138 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:34:28.800348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:34:28.815980 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:34:29.832152 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:34:29.832152 - rocketbot - INFO - For count: 4
2025-11-05 14:34:29.832152 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:34:29.832152 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:34:29.941531 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:34:30.944293 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:34:31.006796 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:34:32.011584 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:34:32.027217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:34:32.027217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:34:32.027217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:34:32.027217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:34:33.042860 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:34:33.230365 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:34:33.230365 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:34:34.230391 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:34.292892 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:34.292892 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:35.295293 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:34:35.373423 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:34:35.389048 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:34:35.404671 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:34:35.404671 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:34:35.404671 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:34:38.416093 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:34:38.416093 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:34:38.431733 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:34:38.431733 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:34:38.431733 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:34:38.431733 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:34:39.447370 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:34:39.634877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:34:39.634877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:34:40.636896 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:40.699403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:40.699403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:41.699507 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:41.777632 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:41.777632 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:34:41.777632 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:34:41.777632 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:34:41.793265 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:34:41.793265 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:34:41.793265 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:34:41.808885 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:34:41.808885 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:34:41.808885 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:34:41.824510 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:34:41.824510 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:34:41.824510 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:34:41.824510 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:34:41.840135 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:34:41.840135 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:34:41.840135 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:34:41.855760 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:34:41.871387 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:34:41.871387 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:34:41.902637 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:34:41.902637 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:34:41.949522 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:34:41.949522 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:34:41.949522 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:34:41.965147 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:34:42.091899 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:34:42.091899 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:34:42.091899 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:34:43.841947 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:34:43.857569 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:34:43.873196 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:34:43.873196 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:34:43.873196 - rocketbot - INFO - For count: 2
2025-11-05 14:34:43.873196 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:34:43.888823 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:34:43.888823 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:34:43.888823 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:34:43.888823 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:34:43.904449 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:34:43.920077 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:34:43.920077 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:34:43.935698 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:34:43.935698 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:34:43.935698 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:34:43.951322 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:34:43.951322 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:34:43.951322 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:34:43.966949 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:34:43.966949 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:34:43.982574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:34:43.982574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:34:45.095379 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:34:45.095379 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:34:48.095457 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:34:48.611090 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:34:51.614796 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:34:51.942933 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:34:54.957659 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:34:54.973294 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:34:54.973294 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:34:54.973294 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:34:54.973294 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:34:55.988935 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:34:56.176441 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:34:56.176441 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:34:57.192092 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:34:57.254601 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:34:57.301470 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:34:58.301530 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:34:58.379654 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:34:58.379654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:34:58.379654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:34:58.379654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:34:58.379654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:34:58.410906 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:34:58.426531 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:34:58.426531 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:34:58.442155 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:34:58.442155 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:35:00.447347 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:35:00.447347 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:35:00.950613 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:35:01.325623 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:35:02.334979 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:35:02.444357 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:35:03.460007 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:35:03.960029 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:35:05.965030 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:35:05.980661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:35:05.980661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:35:05.980661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:35:05.980661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:35:06.996312 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:35:07.183811 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:35:07.183811 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:35:08.183838 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:35:08.246345 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:35:08.308844 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:35:09.321839 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:35:09.399966 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:35:09.399966 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:35:09.399966 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:35:09.399966 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:35:09.399966 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:35:09.431218 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:35:09.446846 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:35:09.446846 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:35:09.462472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:10.478119 - rocketbot - INFO - For count: 0
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:10.478119 - rocketbot - INFO - For count: 1
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:35:10.478119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:35:10.540621 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:35:10.540621 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:35:11.540648 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:11.540648 - rocketbot - INFO - For count: 2
2025-11-05 14:35:11.540648 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:35:11.540648 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:35:11.540648 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:35:11.603150 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:35:11.603150 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:35:12.608193 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:12.608193 - rocketbot - INFO - For count: 3
2025-11-05 14:35:12.608193 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:35:12.608193 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:35:12.608193 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:35:12.670690 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:35:12.670690 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:35:13.671375 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:13.671375 - rocketbot - INFO - For count: 4
2025-11-05 14:35:13.671375 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:35:13.671375 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:35:13.671375 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:35:13.733876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:35:13.733876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:35:14.733903 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:14.733903 - rocketbot - INFO - For count: 5
2025-11-05 14:35:14.733903 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:35:14.733903 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:35:14.733903 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:35:14.796404 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:35:14.796404 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:35:15.801938 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:35:15.801938 - rocketbot - INFO - For count: 5
2025-11-05 14:35:15.801938 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:35:15.817568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:35:15.817568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:35:15.817568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:35:15.817568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:35:16.818219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:35:17.005725 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:35:17.005725 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:35:18.020114 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:35:18.113871 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:35:18.113871 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:35:19.129518 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:35:19.207643 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:35:19.223268 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:35:19.238896 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:35:19.238896 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:35:19.238896 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:35:19.238896 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:22.244025 - rocketbot - INFO - For count: 0
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:22.244025 - rocketbot - INFO - For count: 1
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:35:22.244025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:35:22.369028 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:35:22.369028 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:35:23.369055 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:23.369055 - rocketbot - INFO - For count: 2
2025-11-05 14:35:23.369055 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:35:23.369055 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:35:23.369055 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:35:23.556560 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:35:23.556560 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:35:24.559297 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:24.559297 - rocketbot - INFO - For count: 3
2025-11-05 14:35:24.559297 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:35:24.559297 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:35:24.559297 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:35:24.684300 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:35:24.684300 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:35:25.697130 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:25.697130 - rocketbot - INFO - For count: 4
2025-11-05 14:35:25.697130 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:35:25.697130 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:35:25.697130 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:35:25.822133 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:35:25.822133 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:35:26.827872 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:35:26.827872 - rocketbot - INFO - For count: 4
2025-11-05 14:35:26.827872 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:35:26.827872 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:35:26.937250 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:35:27.952896 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:35:28.015404 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:35:29.031049 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:35:29.046675 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:35:29.046675 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:35:29.046675 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:35:29.046675 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:35:30.046701 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:35:30.234208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:35:30.234208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:35:31.238185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:35:31.300696 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:35:31.300696 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:35:32.316338 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:35:32.394464 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:35:32.410094 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:35:32.425719 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:35:32.425719 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:35:32.425719 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:35:35.432334 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:35:35.432334 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:35:35.447967 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:35:35.447967 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:35:35.447967 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:35:35.447967 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:35:36.463605 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:35:36.651116 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:35:36.651116 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:35:37.663239 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:35:37.725743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:35:37.725743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:35:38.741389 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:35:38.819518 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:35:38.819518 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:35:38.819518 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:35:38.819518 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:35:38.835141 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:35:38.835141 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:35:38.835141 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:35:38.850765 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:35:38.850765 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:35:38.850765 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:35:38.850765 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:35:38.866390 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:35:38.866390 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:35:38.882015 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:35:38.882015 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:35:38.882015 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:35:38.882015 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:35:38.913267 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:35:38.913267 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:35:38.944526 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:35:38.944526 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:35:38.944526 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:35:38.960145 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:35:38.960145 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:35:38.991396 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:35:41.216730 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.3 - rpascripts : module  id: febe532a-d844-808e-d9fa-56e8ae6f729e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre el navegador."}
2025-11-05 14:35:41.216730 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.4 - rpaweb : waitforobject  id: 44e55dfb-486d-1e3a-2598-4411101be563 - xpath - {"object":"//a[contains(@class,\"navbar\") and (contains(text(),\"WorkManager\"))]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:35:41.243412 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.5 - rpalogic : evaluateIf  id: 80fc7905-39f5-f845-f984-01bd1e34ace2 -  - not {loc007EsperaObjeto}
2025-11-05 14:35:41.244411 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.6 - rpascripts : module  id: b0556c99-4b80-edd6-7811-f9367076e4c7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a maximizar la pagina."}
2025-11-05 14:35:41.248415 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.7 - rpaweb : maximize  id: 26325fd6-e765-670d-a1b6-ce22486c116c -  - 
2025-11-05 14:35:41.253416 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.8 - rpascripts : execscriptpython  id: f26fd7ac-90fc-053b-7209-9697ecafbdcd -  - global logger\n\nfrom VortexLibrary import logger\nimport win32com.client\nimport pygetwindow as gw\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task = tmp_global_obj["profile"]["name"]\n\n\ntab_name = "Iniciar sesión - Workmanager"\nlogger.info(f"Buscando ventana con título: {tab_name}")\nwindows = gw.getAllWindows()\nshell = win32com.client.Dispatch("WScript.Shell")\n\nfound = None\nfor w in windows:\n    logger.info(f"Ventana encontrada: '{w.title}'")\n    if tab_name.lower() in w.title.lower():\n        found = w\n        logger.info(f"Ventana con el título '{tab_name}' encontrada: '{w.title}'")\n        break\n\nif found:\n    hwnd = found._hWnd  # handle de la ventana\n    try:\n        import win32gui\n        import win32con\n        shell.SendKeys('%')  # truco: envía ALT para permitir SetForegroundWindow\n        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # restaura si está minimizada\n        win32gui.ShowWindow(hwnd, win32con.SW_MAXIMIZE)\n        win32gui.SetForegroundWindow(hwnd)\n        logger.info(f"Ventana '{found.title}' traída al frente y maximizada.")\n        print(f"Ventana '{found.title}' traída al frente y maximizada.")\n    except Exception as e:\n        logger.error(f"Error al traer la ventana al frente: {e}")\n        print(f"Error al traer la ventana al frente: {e}")\nelse:\n    logger.warning(f"No se encontró ninguna ventana con: {tab_name}")\n    print(f"No se encontró ninguna ventana con: {tab_name}")
2025-11-05 14:35:41.321881 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.9 - rpascripts : module  id: 680c8f2d-d561-4299-e736-401f7c20d9bf -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El navegador se cargo correctamente."}
2025-11-05 14:35:41.338765 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.10 - rpasystem : setVar  id: ae15e49d-9fd8-6ff7-6df5-bf9b6974e00e -  - True
2025-11-05 14:35:41.349005 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:35:41.349005 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.19 - - 009_IniciarSesionWorkManager
2025-11-05 14:35:41.370975 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1 - rpalogic : trycatch  id: 35bda62d-d144-b099-0a15-ce60351f67c4 -  - 
2025-11-05 14:35:41.371970 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.1 - rpasystem : setVar  id: 4f81a886-b606-c281-1646-91d8d910189c -  - False
2025-11-05 14:35:41.372976 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.2 - rpascripts : module  id: 9d3390f9-2a29-3869-fc00-e73603e01da8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Comienza el inicio de sesión de WorkManager."}
2025-11-05 14:35:41.376973 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.3 - rpaweb : waitforobject  id: b32df2ed-e697-246e-c465-0a05d6717a62 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:35:41.396441 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.4 - rpalogic : evaluateIf  id: f002c160-ce98-64b6-8b25-104473668ff8 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:35:41.397441 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.5 - rpascripts : module  id: 581b378d-a3ff-b8dd-d356-28f706834e5e -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:35:41.555836 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.6 - rpaweb : waitforobject  id: 49bf1bbd-8da4-905f-b356-5e5e263d6ee7 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:35:41.572991 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.7 - rpalogic : evaluateIf  id: 471f57c1-e45f-2a8a-2028-64e09fe8568f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:35:41.574604 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.8 - rpascripts : module  id: 7b948fff-3cd6-7d46-b70d-4709f3bcb71d -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:35:41.702397 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.9 - rpaweb : waitforobject  id: ed0c3962-cac0-6f2b-b35b-4d0eee4013a6 - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:35:41.730125 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.10 - rpalogic : evaluateIf  id: 25d1c4e5-054e-1e19-bb4d-708e525ade35 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:35:41.731126 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.11 - rpascripts : module  id: ac09fc73-207c-ddee-b1c7-1cb802d05c54 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:35:42.288723 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.12 - rpaweb : waitforobject  id: 38701775-1ecd-ed68-7ecc-af4a1472aac7 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:35:44.814968 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13 - rpalogic : evaluateIf  id: 1a3e7857-cf29-77d0-0182-ccbb232d80b3 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:35:44.815966 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.14 - rpascripts : module  id: 13093157-0084-3c31-205c-cd096c07f525 -  - {"module_name":"webpro","module":"clickPro","data":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:35:45.166080 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 008_ChequearWorkManagerAbierto
2025-11-05 14:35:45.183076 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1 - rpalogic : trycatch  id: 4f7a770b-1545-60cd-3c43-95398623e355 -  - 
2025-11-05 14:35:45.184079 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.1 - rpasystem : setVar  id: 0b359a66-be39-94e4-09cb-e29f94ba4d67 -  - False
2025-11-05 14:35:45.185076 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.2 - rpascripts : module  id: aca309de-d599-8d68-6ead-d81b7bd55602 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a chequear que la sesión este iniciada."}
2025-11-05 14:35:45.190077 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.3 - rpaweb : waitforobject  id: 5cae235a-a9a1-f6a2-8427-bb7eb365fc7f - xpath - {"object":"//a[contains(text(),\"{gblUsuarioPortal}\")]/img[contains(@class,\"img-circle\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4 - rpalogic : evaluateIf  id: 9b695608-21ad-0cc7-ffb7-91a8a4c13142 -  - not {loc008SesionIniciada}
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4.1 - rpascripts : module  id: ce9afa1f-f6bc-8277-2bd4-df01ac4f6915 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta iniciada la sesion."}
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.5 - rpasystem : setVar  id: 23b30aa9-fbe8-9feb-8921-f5d81c67f09b -  - True
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.16 - rpalogic : evaluateIf  id: 46ca9fb0-760a-4295-6abc-c06763c249bd -  - not {gblBandProceso}
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.17 - rpasystem : setVar  id: 1e53549c-3fd7-a083-9f16-a8c6d90dae2b -  - True
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.20 - rpalogic : evaluateIf  id: 52a1a6c0-653f-da29-293b-314c088a01ea -  - not {gblBandProceso}
2025-11-05 14:36:00.576233 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.21 - - 010_NavegarAdministrarProcesos
2025-11-05 14:36:00.607484 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1 - rpalogic : trycatch  id: 85425d0e-eb4f-61e4-986b-9e8531454f30 -  - 
2025-11-05 14:36:00.607484 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.1 - rpasystem : setVar  id: d1d8e02a-531b-cf34-fa6c-bc7ac48c60d9 -  - False
2025-11-05 14:36:00.607484 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.2 - rpaweb : waitforobject  id: 0a15fe3b-1de2-365c-e413-681ebf639a85 - xpath - {"object":"//a[contains(normalize-space(.),\"Configuración\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:00.623106 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.3 - rpalogic : evaluateIf  id: 2123abfd-648e-28da-2d33-adfd081e7cf2 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:36:00.623106 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.4 - rpaweb : click_web  id: 5eeac613-699c-8d0b-c281-eb3beacdf60f -  - {"data":"//a[contains(normalize-space(.),\"Configuración\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:36:00.793950 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.5 - rpaweb : waitforobject  id: b08141db-5839-afbe-970f-1552bb8868e1 - xpath - {"object":"//a[contains(normalize-space(.),\"Administrar procesos\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:00.822671 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.6 - rpalogic : evaluateIf  id: 4147830b-e888-2fef-4b82-9c2d418d613b -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:36:00.823666 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.7 - rpaweb : click_web  id: c48fffbe-4aec-3a0b-6676-18921deb189d -  - {"data":"//a[contains(normalize-space(.),\"Administrar procesos\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:36:01.612914 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.8 - rpaweb : waitforobject  id: cb0908ea-c510-b6b7-47ae-0caabd40d0cc - xpath - {"object":"//a[contains(normalize-space(.),\"Eliminar\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:01.633107 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.9 - rpalogic : evaluateIf  id: c6485db6-f831-39c5-ab7c-52c9b3f8d5a1 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:36:01.633925 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.10 - rpaweb : click_web  id: cf746297-1312-e8c0-c084-61331a7d37ba -  - {"data":"//a[contains(normalize-space(.),\"Eliminar\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:36:01.777073 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.11 - rpasystem : setVar  id: b8670c90-9ab0-4f7a-9da2-5365091450a1 -  - True
2025-11-05 14:36:01.782070 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.12 - rpascripts : module  id: e250e3b1-3482-b477-4300-99c82e80eceb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se navego correctamente a Administrar procesos"}
2025-11-05 14:36:01.811071 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.22 - rpalogic : evaluateIf  id: 6b234a06-af1f-be45-355a-dee764d2263d -  - not {gblBandProceso}
2025-11-05 14:36:01.813069 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.23 - - 011_BuscarPorNumeroDeProceso
2025-11-05 14:36:01.837071 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1 - rpalogic : trycatch  id: 5a94df60-327d-5d78-9c98-18d0ce4f8f41 -  - 
2025-11-05 14:36:01.838075 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.1 - rpasystem : setVar  id: 8c5a28ec-9a70-2c3e-cbfa-188945bc69d5 -  - False
2025-11-05 14:36:01.839074 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.2 - rpaweb : waitforobject  id: 25f879cc-311f-0e42-df39-6a934ccf9604 - xpath - {"object":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:01.857074 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.3 - rpalogic : evaluateIf  id: 169529d6-4d9a-d9f6-8179-2cac1d2c190d -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:36:01.858074 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.4 - rpascripts : module  id: 04e8740c-8465-903c-5dc7-cdc1086c58c5 -  - {"module_name":"webpro","module":"clickPro","data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","data_type":"xpath","wait":"15"}
2025-11-05 14:36:02.699184 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.5 - rpasystem : wait  id: a3d19044-6256-341c-297f-1385c518a2a5 -  - 1
2025-11-05 14:36:03.700517 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.6 - rpasystem : setVar  id: 31f679f2-b82d-a27d-36fd-71bd9a02cc72 -  - {gblItemActual}["Nro de Proceso"]
2025-11-05 14:36:03.701527 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.7 - rpascripts : module  id: 39fa7b61-a4ae-3ba8-b4ef-aa925223bace -  - {"module_name":"webpro","module":"CleanInputs","texto":"{loc011NroProceso}","search_data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","tipo":"xpath","sleep_":true}
2025-11-05 14:36:04.794165 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.8 - rpaweb : waitforobject  id: e5f17a30-98e8-26ac-9d64-0a5b3db7c58c - id - {"object":"buscarProcesoEliminarButton","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:04.814166 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.9 - rpalogic : evaluateIf  id: a02fe4c4-28b9-6c5d-ec8e-b526cfa1ed5e -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:36:04.815168 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.10 - rpascripts : module  id: 4038b1c5-ba84-527b-c6e8-8a7c9070b697 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"se pudo encontrar el botón para buscar proceso."}
2025-11-05 14:36:04.818166 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.11 - rpascripts : module  id: 856ce597-4f6e-6f79-0192-1d30fe3d996d -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"buscarProcesoEliminarButton\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:36:05.145088 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.12 - rpascripts : module  id: 1db9fab3-744a-b947-5cf6-16b3e236b1bf -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se da click en el boton que permitira buscar el proceso"}
2025-11-05 14:36:05.148088 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.13 - rpaweb : waitforobject  id: e5d3257a-f229-c7d9-1474-e98e269d29cb - xpath - {"object":"//p[contains(translate(normalize-space(.), \"ÁÉÍÓÚáéíóú\", \"AEIOUaeiou\"), \"No se encontro ningun proceso\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:20.433342 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14 - rpalogic : evaluateIf  id: a0ed021f-d5b8-65bf-829d-0bd083f8408f -  - {loc011EsperaDisponibilidad}
2025-11-05 14:36:20.433342 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.15 - rpascripts : module  id: e723de89-60b5-0b64-0047-86c5e07e2751 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se encontraron registros con el numero de proceso buscado"}
2025-11-05 14:36:20.433342 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.16 - rpaweb : waitforobject  id: 94abd698-ab3d-3092-ef06-7a0e783ea9d5 - xpath - {"object":"//table[contains(@class, 'table-bordered')]/tbody/tr[last()]/td/a","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:20.448976 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17 - rpalogic : evaluateIf  id: e3deceb0-55f6-7640-6a4f-df4bff517f23 -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:36:20.448976 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.18 - rpascripts : module  id: c2de3f04-b922-bb88-609e-709764dc5cb9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se logro detectar el ultimo elemento de la tabla"}
2025-11-05 14:36:20.448976 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.19 - rpaweb : click_web  id: 20c2a680-72a5-40d4-2175-2a83139ce54a -  - {"data":"//table[contains(@class, 'table-bordered')]/tbody/tr[last()]/td/a","data_type":"xpath","wait_time":"10","move":true}
2025-11-05 14:36:20.649301 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.20 - rpascripts : module  id: 23040cc0-7257-0f7d-5143-f062ec82a218 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Damos click en el ultimo elemento de la tabla"}
2025-11-05 14:36:20.652671 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.21 - rpascripts : module  id: 6adba0f3-7cfd-0b1d-b54c-6297c99a75de -  - {"module_name":"webpro","module":"switchByTitle","title_":"Detalle Tarea","var_":"loc011EsperaCambioTab"}
2025-11-05 14:36:22.494469 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.22 - rpalogic : evaluateIf  id: e9471d53-bf66-d84b-4e52-1516fcd8d0ce -  - not {loc011EsperaCambioTab}
2025-11-05 14:36:22.495466 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.23 - rpasystem : setVar  id: d04f85a1-f860-005c-3045-033de4858db4 -  - True
2025-11-05 14:36:22.496469 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.24 - rpasystem : setVar  id: 9e6b4a19-240c-d7a5-75d0-ce350af773ec -  - True
2025-11-05 14:36:22.499469 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24 - rpalogic : evaluateIf  id: 1967ed9c-96c0-554c-9092-351d68485942 -  - not {gblBandProceso}
2025-11-05 14:36:22.500469 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.25 - rpalogic : evaluateIf  id: 0d4ca8c8-77d8-489f-9f6a-c57f10f5379e -  - not {loc025BusquedaExitosa}
2025-11-05 14:36:22.500469 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.26 - - 012_DescargarArchivosDeProceso
2025-11-05 14:36:22.517467 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1 - rpalogic : trycatch  id: e18699b6-46f9-1241-50ff-858c7f4c1629 -  - 
2025-11-05 14:36:22.518468 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.1 - rpalogic : group  id: 4f0ddf8f-d3bf-e6c7-9337-de322562948f -  - 
2025-11-05 14:36:22.519470 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.1.1 - rpascripts : module  id: e226cbd1-22b6-75a8-110d-c09b78d52cc5 -  - {"module_name":"System++","module":"cleanVars","vars":"loc012DocumentoActual,loc012NombreDocumento,loc012IdDocumento,loc012Extension,loc012ExtensionValida"}
2025-11-05 14:36:22.522467 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.1.2 - rpascripts : module  id: f9038720-596d-65b5-247e-2a0913ec0a58 -  - {"module_name":"System++","module":"cleanVars","vars":"loc012Error,loc012UltimaCarpetaCreada,loc012ArchivosDescargados,loc012RutaArchivo,loc012RutaArchivoDestino,loc012ArchivoMovido,loc012ArchivosBorrados,loc012ResultadoExtraccion,loc012CheckResultado"}
2025-11-05 14:36:22.525469 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.1.3 - rpascripts : module  id: 6daa71dd-3259-b2e1-eb8c-1324ed8c6e86 -  - {"module_name":"System++","module":"cleanVars","vars":"loc012EsperaDisponibilidad,loc012TipoDocumento,loc012NumeroDocumento,loc012CarpetasCreadas,loc012Detalle"}
2025-11-05 14:36:22.530467 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.2 - rpasystem : setVar  id: c85d4c7b-2089-8b02-7a04-31463f47e668 -  - False
2025-11-05 14:36:22.531468 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.3 - rpascripts : execscriptpython  id: 6b40d92f-9692-81b9-79d1-66a3008c6748 -  - """\nCreamos el diccionario para setear de manera general la información en las variables necesarias para crear las carpetas.\n\nEstructura:\n- Clave: es el nombre con el cual podremos consultar al diccionario global de ítems manejado en el proceso.\n- Valor: indica la variable a la cual se le seteará la información.\n"""\n\nDiccionarioVariables = {\n    'TipoDoc': 'loc012TipoDocumento',\n    'NumeroDoc': 'loc012NumeroDocumento'\n}\n\n# La estructura ya está definida anteriormente\nitems = {gblItemActual}\n\nfor clave, valor in DiccionarioVariables.items():\n    if clave in items:\n        opcionDiccionario = items.get(clave)\n        SetVar(valor, opcionDiccionario)
2025-11-05 14:36:22.532467 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.4 - rpaweb : getWindowTitle  id: a58cc8fd-c374-aaf6-a037-f7103a25f2f7 -  - {loc012ResultadoExtraccion}
2025-11-05 14:36:22.561471 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.5 - rpaweb : execJs  id: f5aa6bf0-0233-eba3-17ec-830370e3e745 - latin-1 - return (() => {\n    const div = document.querySelector('#archivos_wf');\n    if (!div) {\n      console.warn('No se encontró el div con id="archivos_wf"');\n      return [];\n    }\n  \n    const direcciones = div.querySelectorAll('address');\n    const resultados = [];\n  \n    direcciones.forEach(addr => {\n      const data = {};\n  \n      // Buscar el enlace principal del archivo\n      const link = addr.querySelector('a.abrir_archivo');\n      if (link) {\n        data.id = link.getAttribute('data-id') || null;\n        data.nombre = link.textContent.trim().replace('\n',' ');\n      }\n  \n      // Buscar los párrafos con la información adicional\n      const parrafos = addr.querySelector('small.text-info');\n      if (parrafos) {\n        // Buscar el elemento small con clase text-info para el detalle\n        const detalleElement = parrafos;\n\n        if (detalleElement) {\n          data.detalle = detalleElement.textContent;\n  \n          // Extraer la extensión desde el texto del detalle\n          const match = data.detalle.match(/Extensión:\s*([.A-Za-z0-9]+)/i);\n          data.extension = match ? match[1] : null;\n        } else {\n        //   data.detalle = null;\n          data.extension = null;\n        }\n      } else {\n        // data.detalle = null;\n        data.extension = null;\n      }\n  \n      resultados.push(data);\n    });\n  \n    // console.table(resultados);\n    return resultados;\n  })();
2025-11-05 14:36:22.571470 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.6 - rpascripts : module  id: 68aaf94a-96ec-e494-65db-7a74216758a9 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtiene la tabla de archivos: {loc012ResultadoExtraccion}"}
2025-11-05 14:36:22.576468 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.7 - rpascripts : execscriptpython  id: 3b3f703a-1068-c9a1-cd89-a9a30d049b36 -  - from VortexLibrary import logger\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Iniciando verificación del resultado de extracción (loc012ResultadoExtraccion)...")\n\nresultado = {loc012ResultadoExtraccion}\n\nlogger.info(f"Resultado recibido: {resultado}")\n\nif resultado:\n    hay_resultado = True\n    logger.info("Se detectó que hay resultado (hay_resultado=True).")\nelse:\n    hay_resultado = False\n    logger.warning("No se detectó resultado (hay_resultado=False).")\n\nSetVar("loc012CheckResultado", hay_resultado)\nlogger.info(f"Variable 'loc012CheckResultado' seteada a: {hay_resultado}")
2025-11-05 14:36:22.582468 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.8 - rpalogic : evaluateIf  id: eb51a331-0081-d0d1-e0db-0583b6589291 -  - not {loc012CheckResultado}
2025-11-05 14:36:22.583469 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:36:22.584473 - rocketbot - INFO - For count: 0
2025-11-05 14:36:22.585473 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:36:22.587470 - rocketbot - INFO - For count: 1
2025-11-05 14:36:22.588477 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:36:22.591469 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:36:22.593469 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:36:22.595470 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:36:22.599469 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:22.600470 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:36:22.632604 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:22.653746 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:22.654745 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:36:22.663868 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:22.664867 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:36:27.822907 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:36:27.830908 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:36:27.831909 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:36:27.832909 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:36:27.864091 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:36:27.907302 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:36:30.924819 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:30.925825 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:36:31.294432 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:36:31.299428 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:36:35.301852 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:36:36.363369 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:36:36.363369 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:36:36.363369 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:36:36.566510 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:36:36.566510 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:36:36.566510 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:36:36.566510 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:36:36.566510 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:36:36.863363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:36:36.863363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:36:36.863363 - rocketbot - INFO - For count: 2
2025-11-05 14:36:36.863363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:36:36.863363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:36:36.863363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:36:36.878989 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:36:36.878989 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:36.878989 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:36:36.894618 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:36.910244 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:36.925870 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:36:36.925870 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:36.925870 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:36:42.065750 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:36:42.065750 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:36:42.065750 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:36:42.065750 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:36:42.097001 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:36:42.143881 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:36:45.148289 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:45.148289 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:36:45.501745 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:36:45.506742 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:36:49.514224 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:36:50.560558 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:36:50.560558 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:36:50.560558 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:36:50.779318 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:36:50.779318 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:36:50.794945 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:36:50.794945 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:36:50.794945 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:36:51.096442 - rocketbot - INFO - For count: 3
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:36:51.096442 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:36:51.112067 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:51.112067 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:36:51.127693 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:36:51.158947 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:51.158947 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:36:51.158947 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:36:51.158947 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:36:56.293363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:36:56.293363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:36:56.293363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:36:56.293363 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:36:56.324614 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:36:56.371492 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:36:59.371646 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:36:59.371646 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:36:59.737426 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:36:59.742427 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:37:03.748279 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:37:04.811672 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:37:04.811672 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:37:04.811672 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:37:05.042340 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:37:05.043337 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:05.044973 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:37:05.053819 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:37:05.054817 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:37:05.437846 - rocketbot - INFO - For count: 4
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:37:05.437846 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:37:05.453481 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:05.453481 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:37:05.469096 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:37:05.484723 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:05.484723 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:37:05.500352 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:05.500352 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:37:10.651209 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:10.651209 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:37:10.651209 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:37:10.651209 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:37:10.682458 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:37:10.729332 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:37:13.734407 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:13.734407 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:37:14.101541 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:37:14.106541 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:37:18.109741 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:37:19.171786 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:37:19.171786 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:37:19.171786 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:37:19.390547 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:37:19.390547 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:19.406173 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:37:19.406173 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:37:19.406173 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:37:19.671812 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:37:19.718689 - rocketbot - INFO - For count: 5
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:19.718689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:37:19.749948 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:37:19.765572 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:19.765572 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:37:19.781195 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:19.781195 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:37:24.919788 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:24.919788 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:37:24.919788 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:37:24.919788 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:37:24.951032 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:37:24.997912 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:37:28.004326 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:28.004326 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:37:28.387929 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:37:28.392927 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:37:32.402894 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:37:33.464605 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:37:33.464605 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:37:33.464605 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:37:33.697179 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:37:33.699176 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:33.700997 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:37:33.708340 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:37:33.709335 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:37:33.980604 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:37:33.980604 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:37:33.980604 - rocketbot - INFO - For count: 6
2025-11-05 14:37:33.980604 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:37:33.996230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:37:33.996230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:37:33.996230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:37:33.996230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:33.996230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:37:34.011869 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:37:34.043106 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:34.043106 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:37:34.043106 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:34.043106 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:37:39.198715 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:39.214342 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:37:39.214342 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:37:39.214342 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:37:39.245593 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:37:39.276847 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:37:42.307093 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:42.307093 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:37:42.659637 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:37:42.664634 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:37:46.674700 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:37:47.746588 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:37:47.746588 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:37:47.746588 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:37:47.965349 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:37:47.965349 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:47.980976 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:37:47.980976 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:37:47.980976 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:37:48.262239 - rocketbot - INFO - For count: 7
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:37:48.262239 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:48.277863 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:37:48.293491 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:37:48.309117 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:48.309117 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:37:48.324742 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:37:48.324742 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:37:53.460688 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:37:53.468689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:37:53.469684 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:37:53.470685 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:37:53.511230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:37:53.555265 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:37:56.582825 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:37:56.582825 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:37:56.981600 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:37:56.985611 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:38:00.990379 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:38:02.054768 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:38:02.054768 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:38:02.054768 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:38:02.289158 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:38:02.289158 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:02.289158 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:38:02.289158 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:38:02.289158 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:38:04.014255 - rocketbot - INFO - For count: 8
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:38:04.014255 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:38:04.029871 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:04.029871 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:38:04.045503 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:38:04.076752 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:04.076752 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:38:04.076752 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:04.076752 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:38:09.228976 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:09.237124 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:38:09.238121 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:38:09.240125 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:38:09.370634 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:38:09.403416 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:38:12.404843 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:12.404843 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:38:12.787734 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:38:12.791726 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:38:16.794583 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:38:17.871629 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:38:17.871629 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:38:17.871629 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:38:18.106015 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:38:18.106015 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:18.106015 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:38:18.106015 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:38:18.106015 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:38:19.928762 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:38:19.928762 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:38:19.944389 - rocketbot - INFO - For count: 9
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:19.944389 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:38:19.975647 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:38:19.991271 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:19.991271 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:38:19.991271 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:20.006894 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:38:25.125232 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:25.133230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:38:25.134230 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:38:25.135231 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:38:25.209412 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:38:25.779689 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:38:28.808228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:28.823854 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:38:29.237958 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:38:29.242959 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:38:33.246368 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:38:34.306163 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:38:34.306163 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:38:34.306163 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:38:34.540539 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:38:34.540539 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:34.540539 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:38:34.540539 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:38:34.556162 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:38:36.908802 - rocketbot - INFO - For count: 10
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:38:36.908802 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:38:36.924428 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:36.924428 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:38:36.940061 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:38:36.955678 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:36.955678 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:38:36.971305 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:36.971305 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:38:42.123266 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:42.123266 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:38:42.123266 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:38:42.123266 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:38:42.185199 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:38:42.217931 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:38:45.233693 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:45.286075 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:38:45.686655 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:38:45.691654 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:38:49.706413 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:38:50.784824 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:38:50.784824 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:38:50.784824 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:38:51.034837 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:38:51.034837 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:51.034837 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:38:51.034837 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:38:51.034837 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:38:52.651450 - rocketbot - INFO - For count: 11
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:38:52.651450 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:38:52.667077 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:52.667077 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:38:52.682709 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:38:52.698330 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:38:52.698330 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:38:52.713957 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:38:52.713957 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:38:57.856934 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:38:57.856934 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:38:57.856934 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:38:57.856934 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:38:57.888188 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:38:57.935063 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:39:00.938251 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:00.938251 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:39:01.290202 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:39:01.294204 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:39:05.304978 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:39:06.374273 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:39:06.374273 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:39:06.374273 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:39:06.609017 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:39:06.610020 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:39:06.618145 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:39:06.619146 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:39:06.620145 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:39:06.891228 - rocketbot - INFO - For count: 12
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:39:06.891228 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:39:06.906856 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:06.906856 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:39:06.922488 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:39:06.938103 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:06.938103 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:39:06.953730 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:06.953730 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:39:12.106767 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:39:12.106767 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:39:12.106767 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:39:12.106767 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:39:12.138016 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:39:12.169268 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:39:15.185032 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:15.185032 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:39:15.541198 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:39:15.546197 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:39:19.560187 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:39:20.623351 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:39:20.623351 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:39:20.623351 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:39:20.842110 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:39:20.857733 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:39:20.857733 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:39:20.857733 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:39:20.857733 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:39:21.154819 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:39:21.154819 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:39:21.154819 - rocketbot - INFO - For count: 13
2025-11-05 14:39:21.154819 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:39:21.170451 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:39:21.170451 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:39:21.170451 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:39:21.170451 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:21.170451 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:39:21.186086 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:39:21.217324 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:21.217324 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:39:21.217324 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:21.217324 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:39:26.373941 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.10 - rpascripts : module  id: d35f3fcc-5d85-d055-9f87-92804af2e441 -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:39:26.373941 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11 - rpalogic : evaluateIf  id: 76f29b42-cf20-01fb-f081-8e5772336ada -  - len({loc012ArchivosDescargados}) == 0
2025-11-05 14:39:26.373941 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1 - rpalogic : evaluateIf  id: dd4a79ef-aa4a-f6b0-f2a6-7fa638430110 -  - {loc012DocumentoActual}["extension"].lower() == ".pdf"
2025-11-05 14:39:26.373941 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.1 - rpaweb : switchToWindow  id: 89c76a1a-f70f-8d1c-def4-8f8d448ef0e2 - last - work_manager_instace
2025-11-05 14:39:26.405192 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.2 - rpaweb : swichtoframe  id: 3f475a5d-b648-3989-a079-0e4013804726 - id - iframeId
2025-11-05 14:39:26.436447 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.3 - rpaweb : waitforobject  id: 3b2f6ad7-ebf9-fca8-e197-9c9b99dd344c - xpath - {"object":"//button[@id=\"download\"]","wait_time":"15","wait_for":"present","before":"","after":"3"}
2025-11-05 14:39:29.463978 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.4 - rpalogic : evaluateIf  id: 06c6340c-c39e-e63c-b7eb-c93510d4c867 -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:29.463978 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.5 - rpascripts : module  id: ee5e9d15-b2d9-cabc-7476-e134b112235f -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"download\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:39:29.815952 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.6 - rpascripts : module  id: 472fa40f-f485-a440-f331-5772f8c7e367 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se hace click en boton download."}
2025-11-05 14:39:29.820951 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.7 - rpasystem : wait  id: ac7039a4-a360-6171-1cb4-147488c75d81 -  - 4
2025-11-05 14:39:33.827871 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.8 - rpaweb : closewindow  id: 64102db5-4b89-83fe-d9de-c294bb0253d6 - last - 
2025-11-05 14:39:34.906141 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.9 - rpascripts : module  id: b35dbe99-5710-9622-3b66-3754dd38c756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cierra la ultima pestania."}
2025-11-05 14:39:34.906141 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.11.1.10 - rpaweb : switchToWindow  id: ec488ca2-cfe2-468d-e4bd-75e2499b735a - 2 - work_manager_instace
2025-11-05 14:39:34.906141 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.12 - rpascripts : execscriptpython  id: 833104f8-825e-b630-322a-56caa5c6e8b9 -  - def crear_estructura(tipo_doc, num_doc, nombre_archivo, base_path="."):\n    """\n    Crea una carpeta con nombre tipoDoc-numDOC y dentro otra con el nombre del archivo.\n    Si ya existen, no hace nada.\n\n    :param tipo_doc: str, tipo de documento (por ej. 'DNI', 'CUIT', etc.)\n    :param num_doc: str o int, número del documento\n    :param nombre_archivo: str, nombre de la subcarpeta\n    :param base_path: str, ruta base donde se crearán las carpetas (por defecto el directorio actual)\n    """\n    import os\n    # Crear nombre de la carpeta principal\n    carpeta_principal = f"{tipo_doc}-{num_doc}"\n    ruta_principal = os.path.join(base_path, carpeta_principal)\n\n    # Crear carpeta principal si no existe\n    os.makedirs(ruta_principal, exist_ok=True)\n\n    # Crear subcarpeta dentro de la principal\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre_archivo)\n    os.makedirs(ruta_subcarpeta, exist_ok=True)\n\n    \ntipo, num, nombre, ruta_base = "{loc012TipoDocumento}","{loc012NumeroDocumento}","{loc012Detalle}", "{gblCarpetaCompartida}"\n\ntry:\n    import os\n    carpeta_principal = f"{tipo}-{num}"\n    ruta_principal = os.path.join(ruta_base, carpeta_principal).replace(os.sep, "/")\n    ruta_subcarpeta = os.path.join(ruta_principal, nombre).replace(os.sep, "/")\n\n    crear_estructura(tipo, num, nombre, ruta_base)\n	\n    SetVar("loc012CarpetasCreadas", True)\n    SetVar("loc012UltimaCarpetaCreada", ruta_subcarpeta)\nexcept Exception as e:\n    SetVar("loc012CarpetasCreadas",False)\n    SetVar("loc012Error",e) \n
2025-11-05 14:39:35.147395 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.13 - rpalogic : evaluateIf  id: 06c5101d-1804-fee3-31bb-42120e215bfb -  - not {loc012CarpetasCreadas}
2025-11-05 14:39:35.148409 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.14 - rpascripts : module  id: 8d8d832e-9501-7feb-8d80-67e0665c481a -  - {"module_name":"Files","module":"listFiles","path":"{gblRutaInput}/Descargas","option":"type","result":"loc012ArchivosDescargados"}
2025-11-05 14:39:35.156696 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.15 - rpasystem : setVar  id: 329f58e5-8d1a-08b0-6af6-2cb222c48cbb -  - "{gblRutaInput}"+"/Descargas/"+{loc012ArchivosDescargados}[0]
2025-11-05 14:39:35.157697 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.16 - rpasystem : setVar  id: 153d8e80-f45f-0bc5-e01a-a6b84b3280df -  - "{loc012UltimaCarpetaCreada}"+"/"+"{loc012NombreDocumento}"+"{loc012Extension}".lower()
2025-11-05 14:39:35.158698 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.17 - rpafile : movefile  id: 770dddd8-7614-1c30-1c03-0207d43f650d -  - {"from":"{loc012RutaArchivo}","to":"{loc012RutaArchivoDestino}"}
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.18 - rpalogic : evaluateIf  id: b3f1496a-b148-50ef-0e51-cf6ea704accb -  - "{loc012ArchivoMovido}" == "False"
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9 - rpalogic : for  id: c400953d-bcb3-1499-c45d-ea47d8804a9b -  - {"iterable":"{loc012ResultadoExtraccion}","count":0}
2025-11-05 14:39:35.437740 - rocketbot - INFO - For count: 14
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.1 - rpascripts : execscriptpython  id: 26314528-f2b3-5d87-07b3-689c7b9c01f1 -  - doc = {loc012DocumentoActual}\n\nif doc["extension"].lower() not in [".msg"]:\n  extension_valida = True\nelse:\n  extension_valida = False\n\nSetVar("loc012NombreDocumento",doc["nombre"])\nSetVar("loc012IdDocumento",doc["id"])\nSetVar("loc012Extension",doc["extension"])\nSetVar("loc012ExtensionValida",extension_valida)
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2 - rpalogic : evaluateIf  id: 6b336e26-2e0b-695d-681c-51da5a0669d9 -  - {loc012ExtensionValida}
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.1 - rpascripts : execscriptpython  id: 8ac65cde-23ce-7025-cac0-81becd778164 -  - import os\nfrom VortexLibrary import logger\n\nlogger.log_path = f"{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ncarpeta = "{gblRutaInput}"+"/Descargas"\nif not os.path.exists(carpeta):\n    logger.info(f'La carpeta "{carpeta}" no existe. Creando carpeta...')\n    os.mkdir(carpeta)\n    logger.info(f'Carpeta "{carpeta}" creada exitosamente.')\nelse:\n    logger.info(f'La carpeta "{carpeta}" ya existe.')
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.2 - rpascripts : execscriptpython  id: dd29ab99-b94a-eb6c-3e16-3aeabb148444 -  - import os\n\ndef borrar_contenido_carpeta_sin_gitkeep(ruta_carpeta):\n    """\n    Borra todos los archivos y subcarpetas de la carpeta dada,\n    excepto el archivo .gitkeep.\n    """\n    from VortexLibrary import logger\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n	\n    SetVar("loc012ArchivosBorrados", True)\n    for nombre in os.listdir(ruta_carpeta):\n        ruta_elemento = os.path.join(ruta_carpeta, nombre)\n        if ".gitkeep" in nombre:\n            continue\n        try:\n            if os.path.isfile(ruta_elemento) or os.path.islink(ruta_elemento):\n                os.remove(ruta_elemento)\n                logger.info(f"Archivo eliminado: {ruta_elemento}")\n            elif os.path.isdir(ruta_elemento):\n                import shutil\n                shutil.rmtree(ruta_elemento)\n                logger.info(f"Carpeta eliminada: {ruta_elemento}")\n			\n        except Exception as e:\n            SetVar("loc012ArchivosBorrados", False)\n            logger.error(f"No se pudo eliminar '{ruta_elemento}': {e}")\n            break\n            \nlogger.info("Comienza el proceso de borrado de carpeta.")\nborrar_contenido_carpeta_sin_gitkeep("{gblRutaInput}"+"/Descargas")\nlogger.info("Finaliza el proceso de borrado de carpetas.")
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.3 - rpalogic : evaluateIf  id: 821bd1b7-8341-fde8-dbd6-e6b8599c7442 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:35.437740 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.4 - rpascripts : module  id: c98ef4aa-e896-e8ca-78bf-89f7ca924317 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se borra contenido de carpeta de descargas."}
2025-11-05 14:39:35.468993 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.5 - rpaweb : waitforobject  id: f3781867-2461-f57b-df56-968abc0f4098 - xpath - {"object":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:39:35.500244 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.6 - rpalogic : evaluateIf  id: ebac427f-c0d4-01ab-3f84-b0932a32d08b -  - not {loc012EsperaDisponibilidad}
2025-11-05 14:39:35.500244 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.7 - rpascripts : module  id: 57567640-8698-a235-a84b-ed9fadad161b -  - {"module_name":"Files","module":"delete_folder_content","path":"{gblRutaInput}/Descargas","result_":"loc012ArchivosBorrados"}
2025-11-05 14:39:35.515872 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.8 - rpalogic : evaluateIf  id: 80cf1268-d280-cafe-92a7-a2bbe6b21d86 -  - not {loc012ArchivosBorrados}
2025-11-05 14:39:35.515872 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.9.2.9 - rpaweb : click_web  id: 20ac2b70-2c3b-d8d2-5c0b-0168dab7671f -  - {"data":"//a[contains(@data-id,\"{loc012IdDocumento}\")]","data_type":"xpath","wait_time":"15","after":"5"}
2025-11-05 14:39:50.787840 - rpaweb - ERROR - EXCEPTION IN (<string> rpaweb, L_1157 ""): ElementNotInteractableException: Message: element not interactable\n  (Session info: chrome=142.0.7444.60)\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n	0x16358c3\n	0x1635904\n	0x144e5bb\n	0x149b2dd\n	0x148fdf5\n	0x14bc96c\n	0x148f854\n	0x14bcb24\n	0x14deea6\n	0x14bc766\n	0x148dac0\n	0x148ede4\n	0x18b7974\n	0x18b2bea\n	0x165e5b4\n	0x164dd28\n	0x1654d8d\n	0x163ded8\n	0x163e09c\n	0x1627d1a\n	0x73d262c4\n	0x76f20989\n	0x76f20954\n
2025-11-05 14:39:50.959728 - rocketbot - INFO - request: 012_DescargarArchivosDeProceso : line 1.1 - rpascripts : module  id: 5ab90d20-bf02-6b5f-2066-9afb6b452d1a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"error","text":"Ocurrió un error al descargar archivos del proceso."}
2025-11-05 14:39:50.975345 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.27 - rpalogic : evaluateIf  id: 68029ad1-5ced-6719-1566-3ffc1fad2070 -  - not {gblBandProceso}
2025-11-05 14:39:50.975345 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.27.1 - rpascripts : execscriptpython  id: 4a7eca6c-d0f1-2112-8182-2146affdd63e -  - item = {gblItemActual}\n\nitem['Observaciones'] = "Ocurrio un error al descargar documentos de Workmanager. Revisar archivo de logs."\n\nSetVar("gblItemActual",item)
2025-11-05 14:39:50.975345 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.27.2 - rpascripts : module  id: 090624df-8026-95f2-27c1-33128fff6aac -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Ocurrio un error al descargar los archivos."}
2025-11-05 14:39:50.990975 - rocketbot - INFO - request: scripts : line 1.27.3 - rpascripts : stop - id: 45930171-d39f-3764-15f2-cd1ffbf786ea- - 
2025-11-05 14:39:50.990975 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:39:50.990975 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 14:39:51.006601 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 14:39:51.022231 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 14:39:51.022231 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 14:39:51.022231 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 14:39:51.022231 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 14:39:51.037851 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 14:39:53.817424 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 14:39:53.817424 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 14:39:53.817424 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 14:39:53.817424 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:39:53.833051 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:39:53.833051 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:39:53.833051 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:39:53.848678 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:39:55.661242 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:39:55.692503 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:39:55.692503 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:39:55.692503 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:39:55.708233 - rocketbot - INFO - For count: 3
2025-11-05 14:39:55.708233 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:39:55.723757 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:39:55.723757 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:39:55.723757 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:39:55.723757 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:39:55.723757 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:39:55.739386 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:39:55.739386 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:39:55.755006 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:39:55.755006 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:39:55.755006 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:39:55.786259 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:39:55.786259 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:39:55.786259 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:39:55.801885 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:39:55.801885 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:39:55.801885 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:39:55.801885 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:39:56.913068 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:39:56.913068 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:39:59.916698 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:40:00.416718 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:40:03.422635 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:40:03.750770 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:40:06.766438 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:40:06.782067 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:40:06.782067 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:40:06.782067 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:40:06.782067 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:40:07.797729 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:40:07.986043 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:40:07.986043 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:40:08.987266 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:40:09.049775 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:40:09.049775 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:40:10.050012 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:40:10.128144 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:40:10.128144 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:40:10.128144 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:40:10.128144 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:40:10.143763 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:40:10.159396 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:40:10.175016 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:40:10.175016 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:40:10.190649 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:40:10.190649 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:40:12.198429 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:40:12.198429 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:40:12.729700 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:40:13.104715 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:40:14.104753 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:40:14.214133 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:40:15.214172 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:40:15.714192 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:40:17.721116 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:40:17.736738 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:40:17.736738 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:40:17.736738 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:40:17.736738 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:40:18.740046 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:40:18.927554 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:40:18.927554 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:40:19.928268 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:40:19.990770 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:40:19.990770 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:40:20.990809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:40:21.068942 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:40:21.068942 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:40:21.068942 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:40:21.068942 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:40:21.068942 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:40:21.100191 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:40:21.115818 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:40:21.115818 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:40:21.131448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:22.147105 - rocketbot - INFO - For count: 0
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:22.147105 - rocketbot - INFO - For count: 1
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:40:22.147105 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:40:22.209613 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:40:22.209613 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:40:23.225271 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:23.225271 - rocketbot - INFO - For count: 2
2025-11-05 14:40:23.225271 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:40:23.225271 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:40:23.225271 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:40:23.287774 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:40:23.287774 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:40:24.296176 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:24.296176 - rocketbot - INFO - For count: 3
2025-11-05 14:40:24.296176 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:40:24.296176 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:40:24.296176 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:40:24.358683 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:40:24.358683 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:40:25.358723 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:25.358723 - rocketbot - INFO - For count: 4
2025-11-05 14:40:25.358723 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:40:25.358723 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:40:25.358723 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:40:25.421220 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:40:25.421220 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:40:26.421263 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:26.421263 - rocketbot - INFO - For count: 5
2025-11-05 14:40:26.421263 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:40:26.421263 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:40:26.421263 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:40:26.483768 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:40:26.483768 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:40:27.499426 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:40:27.499426 - rocketbot - INFO - For count: 5
2025-11-05 14:40:27.499426 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:40:27.515054 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:40:27.515054 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:40:27.515054 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:40:27.515054 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:40:28.516853 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:40:28.704917 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:40:28.704917 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:40:29.720587 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:40:29.783092 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:40:29.783092 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:40:30.798747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:40:30.861256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:40:30.876880 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:40:30.892501 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:40:30.892501 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:40:30.908126 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:40:30.908126 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:40:30.908126 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:33.918014 - rocketbot - INFO - For count: 0
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:33.918014 - rocketbot - INFO - For count: 1
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:40:33.918014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:40:34.043018 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:40:34.043018 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:40:35.046235 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:35.046235 - rocketbot - INFO - For count: 2
2025-11-05 14:40:35.046235 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:40:35.046235 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:40:35.046235 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:40:35.233748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:40:35.233748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:40:36.249407 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:36.249407 - rocketbot - INFO - For count: 3
2025-11-05 14:40:36.249407 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:40:36.249407 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:40:36.249407 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:40:36.374412 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:40:36.374412 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:40:37.380109 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:37.380109 - rocketbot - INFO - For count: 4
2025-11-05 14:40:37.380109 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:40:37.380109 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:40:37.380109 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:40:37.505110 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:40:37.520735 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:40:38.524035 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:40:38.524035 - rocketbot - INFO - For count: 4
2025-11-05 14:40:38.524035 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:40:38.524035 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:40:38.633414 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:40:39.633453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:40:39.695955 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:40:40.695994 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:40:40.711626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:40:40.711626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:40:40.711626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:40:40.711626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:40:41.727284 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:40:41.914797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:40:41.914797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:40:42.930462 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:40:42.992959 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:40:42.992959 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:40:43.992997 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:40:44.071131 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:40:44.086753 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:40:44.102379 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:40:44.102379 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:40:44.102379 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:40:47.110551 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:40:47.110551 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:40:47.126177 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:40:47.126177 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:40:47.126177 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:40:47.126177 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:40:48.141841 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:40:48.329347 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:40:48.329347 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:40:49.329815 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:40:49.392324 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:40:49.392324 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:40:50.407982 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:40:50.486109 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:40:50.486109 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:40:50.486109 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:40:50.486109 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:40:50.501738 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:40:50.501738 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:40:50.501738 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:40:50.517368 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:40:50.517368 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:40:50.517368 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:40:50.532990 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:40:50.532990 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:40:50.532990 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:40:50.532990 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:40:50.548614 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:40:50.548614 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:40:50.564240 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:40:50.564240 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:40:50.595490 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:40:50.595490 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:40:50.611116 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:40:50.611116 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:40:50.657993 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:40:50.657993 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:40:50.673623 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:40:50.689250 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:40:50.689250 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:40:50.689250 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:40:50.689250 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:40:52.486187 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:40:52.517443 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:40:52.517443 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:40:52.517443 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:40:52.533065 - rocketbot - INFO - For count: 4
2025-11-05 14:40:52.533065 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:40:52.548691 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:40:52.548691 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:40:52.548691 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:40:52.548691 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:40:52.548691 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:40:52.579953 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:40:52.579953 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:40:52.595571 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:40:52.595571 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:40:52.595571 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:40:52.611198 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:40:52.611198 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:40:52.611198 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:40:52.626820 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:40:52.626820 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:40:52.626820 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:40:52.626820 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:40:53.751864 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:40:53.751864 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:40:56.756775 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:40:57.256795 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:41:00.256915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:41:00.569428 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:41:03.585166 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:41:03.600797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:41:03.600797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:41:03.600797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:41:03.600797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:41:04.600836 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:41:04.788338 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:41:04.788338 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:41:05.788382 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:41:05.850884 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:41:05.850884 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:41:06.860461 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:41:06.938572 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:41:06.938572 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:41:06.938572 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:41:06.954197 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:41:06.954197 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:41:06.985456 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:41:06.985456 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:41:06.985456 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:41:07.001077 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:41:07.001077 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:41:09.001158 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:41:09.001158 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:41:09.506782 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:41:09.879217 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:41:10.883919 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:41:10.993298 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:41:11.993817 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:41:12.496241 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:41:14.499208 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:41:14.514835 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:41:14.514835 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:41:14.514835 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:41:14.514835 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:41:15.530494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:41:15.717998 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:41:15.717998 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:41:16.718039 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:41:16.780544 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:41:16.780544 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:41:17.796206 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:41:17.874338 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:41:17.874338 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:41:17.874338 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:41:17.874338 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:41:17.874338 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:41:17.921211 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:41:17.921211 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:41:17.921211 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:41:17.936840 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:41:17.936840 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:41:17.936840 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:41:17.936840 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:41:17.936840 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:41:17.952463 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:41:18.963824 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:41:19.010703 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:19.010703 - rocketbot - INFO - For count: 0
2025-11-05 14:41:19.010703 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:19.010703 - rocketbot - INFO - For count: 1
2025-11-05 14:41:19.010703 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:41:19.026329 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:41:19.026329 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:41:19.088829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:41:19.088829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:41:20.088868 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:20.088868 - rocketbot - INFO - For count: 2
2025-11-05 14:41:20.088868 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:41:20.088868 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:41:20.088868 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:41:20.151376 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:41:20.151376 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:41:21.167035 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:21.167035 - rocketbot - INFO - For count: 3
2025-11-05 14:41:21.167035 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:41:21.167035 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:41:21.167035 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:41:21.229537 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:41:21.229537 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:41:22.229581 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:22.229581 - rocketbot - INFO - For count: 4
2025-11-05 14:41:22.229581 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:41:22.229581 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:41:22.229581 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:41:22.292080 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:41:22.292080 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:41:23.307749 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:23.307749 - rocketbot - INFO - For count: 5
2025-11-05 14:41:23.307749 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:41:23.307749 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:41:23.307749 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:41:23.370246 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:41:23.370246 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:41:24.370285 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:41:24.370285 - rocketbot - INFO - For count: 5
2025-11-05 14:41:24.370285 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:41:24.385918 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:41:24.385918 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:41:24.385918 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:41:24.385918 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:41:25.387028 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:41:25.574535 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:41:25.574535 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:41:26.590195 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:41:26.652703 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:41:26.652703 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:41:27.668361 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:41:27.746493 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:41:27.762115 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:41:27.762115 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:41:27.777743 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:41:27.777743 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:41:27.777743 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:30.778682 - rocketbot - INFO - For count: 0
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:30.778682 - rocketbot - INFO - For count: 1
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:41:30.778682 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:41:30.906030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:41:30.906030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:41:31.906095 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:31.906095 - rocketbot - INFO - For count: 2
2025-11-05 14:41:31.906095 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:41:31.906095 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:41:31.906095 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:41:32.093598 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:41:32.093598 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:41:33.109261 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:33.109261 - rocketbot - INFO - For count: 3
2025-11-05 14:41:33.109261 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:41:33.109261 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:41:33.109261 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:41:33.234267 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:41:33.234267 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:41:34.249932 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:34.296808 - rocketbot - INFO - For count: 4
2025-11-05 14:41:34.296808 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:41:34.296808 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:41:34.296808 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:41:34.499941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:41:34.499941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:41:35.499984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:41:35.499984 - rocketbot - INFO - For count: 4
2025-11-05 14:41:35.499984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:41:35.499984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:41:35.609359 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:41:36.628490 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:41:36.690993 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:41:37.694685 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:41:37.710316 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:41:37.710316 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:41:37.710316 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:41:37.710316 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:41:38.723127 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:41:38.910635 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:41:38.910635 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:41:39.912568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:41:39.975075 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:41:39.975075 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:41:40.990735 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:41:41.053241 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:41:41.072140 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:41:41.072140 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:41:41.072140 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:41:41.072140 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:41:41.084490 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:41:41.084490 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:41:41.100113 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:41:41.100113 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:41:41.100113 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:41:41.100113 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:41:44.100231 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:41:44.100231 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:41:44.115870 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:41:44.115870 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:41:44.115870 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:41:44.115870 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:41:45.131527 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:41:45.319029 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:41:45.319029 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:41:46.319160 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:41:46.381671 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:41:46.381671 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:41:47.397326 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:41:47.475453 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:41:47.475453 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:41:47.475453 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:41:47.475453 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:41:47.491079 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:41:47.491079 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:41:47.491079 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:41:47.506706 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:41:47.506706 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:41:47.506706 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:41:47.522332 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:41:47.522332 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:41:47.522332 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:41:47.522332 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:41:47.537956 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:41:47.537956 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:41:47.553583 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:41:47.553583 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:41:47.569215 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:41:47.569215 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:41:47.600465 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:41:47.600465 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:41:47.616084 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:41:47.616084 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:41:47.662975 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:41:47.678590 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:41:47.678590 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:41:47.678590 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:41:47.694212 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:41:49.538041 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:41:49.569297 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:41:49.569297 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:41:49.569297 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:41:49.584915 - rocketbot - INFO - For count: 5
2025-11-05 14:41:49.584915 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:41:49.600545 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:41:49.600545 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:41:49.600545 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:41:49.600545 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:41:49.600545 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:41:49.631796 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:41:49.631796 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:41:49.647427 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:41:49.647427 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:41:49.647427 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:41:49.663043 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:41:49.663043 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:41:49.663043 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:41:49.678674 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:41:49.678674 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:41:49.678674 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:41:49.678674 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:41:50.994910 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:41:50.994910 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:41:53.995026 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:41:54.508956 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:41:57.509072 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:41:57.837208 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:42:00.848793 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:00.864422 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:00.864422 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:00.864422 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:00.864422 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:01.864464 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:02.051966 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:02.051966 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:42:03.061106 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:42:03.123613 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:42:03.123613 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:42:04.134525 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:42:04.212651 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:42:04.212651 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:42:04.212651 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:42:04.228278 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:42:04.228278 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:42:04.243912 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:42:04.259532 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:42:04.259532 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:42:04.275156 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:42:04.275156 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:42:06.278842 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:42:06.278842 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:42:06.794483 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:42:07.169495 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:42:08.169528 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:42:08.278908 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:42:09.279822 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:42:09.779837 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:42:11.791351 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:11.806983 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:11.806983 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:11.806983 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:11.806983 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:12.822635 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:13.010146 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:13.010146 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:42:14.010563 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:42:14.073066 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:42:14.073066 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:42:15.073103 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:42:15.151224 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:42:15.151224 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:42:15.151224 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:42:15.151224 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:42:15.151224 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:42:15.182481 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:42:15.182481 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:42:15.198100 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:42:15.213732 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:16.229386 - rocketbot - INFO - For count: 0
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:16.229386 - rocketbot - INFO - For count: 1
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:42:16.229386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:42:16.291888 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:42:16.291888 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:42:17.291925 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:17.291925 - rocketbot - INFO - For count: 2
2025-11-05 14:42:17.291925 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:42:17.291925 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:42:17.291925 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:42:17.354430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:42:17.354430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:42:18.370082 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:18.370082 - rocketbot - INFO - For count: 3
2025-11-05 14:42:18.370082 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:42:18.370082 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:42:18.370082 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:42:18.432584 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:42:18.432584 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:42:19.432617 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:19.432617 - rocketbot - INFO - For count: 4
2025-11-05 14:42:19.432617 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:42:19.432617 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:42:19.432617 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:42:19.495119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:42:19.495119 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:42:20.495153 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:20.495153 - rocketbot - INFO - For count: 5
2025-11-05 14:42:20.495153 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:42:20.495153 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:42:20.495153 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:42:20.557653 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:42:20.557653 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:42:21.557692 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:42:21.557692 - rocketbot - INFO - For count: 5
2025-11-05 14:42:21.557692 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:21.573314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:21.573314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:21.573314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:21.573314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:22.575469 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:22.762974 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:22.762974 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:42:23.763006 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:42:23.825512 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:42:23.825512 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:42:24.841167 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:42:24.919297 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:42:24.934923 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:42:24.934923 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:42:24.950547 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:42:24.950547 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:42:24.950547 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:27.963189 - rocketbot - INFO - For count: 0
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:27.963189 - rocketbot - INFO - For count: 1
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:42:27.963189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:42:28.088194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:42:28.088194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:42:29.089370 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:29.089370 - rocketbot - INFO - For count: 2
2025-11-05 14:42:29.089370 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:42:29.089370 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:42:29.089370 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:42:29.276880 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:42:29.276880 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:42:30.292532 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:30.292532 - rocketbot - INFO - For count: 3
2025-11-05 14:42:30.292532 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:42:30.292532 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:42:30.292532 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:42:30.417536 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:42:30.417536 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:42:31.417570 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:31.417570 - rocketbot - INFO - For count: 4
2025-11-05 14:42:31.417570 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:42:31.417570 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:42:31.417570 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:42:31.605081 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:42:31.605081 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:42:32.620734 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:42:32.620734 - rocketbot - INFO - For count: 4
2025-11-05 14:42:32.620734 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:42:32.620734 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:42:32.730113 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:42:33.730145 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:42:33.808278 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:42:34.823932 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:34.839562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:34.839562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:34.839562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:34.839562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:35.844395 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:36.031898 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:36.031898 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:42:37.031931 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:42:37.094431 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:42:37.094431 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:42:38.094464 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:42:38.172599 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:42:38.188217 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:42:38.203840 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:42:38.203840 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:42:38.203840 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:42:38.203840 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:42:41.212965 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:42:41.212965 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:41.228726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:41.228726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:41.228726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:41.228726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:42.244252 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:42.431753 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:42.431753 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:42:43.431787 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:42:43.556791 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:42:43.556791 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:42:44.556823 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:42:44.634955 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:42:44.634955 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:42:44.634955 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:42:44.634955 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:42:44.650575 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:42:44.650575 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:42:44.650575 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:42:44.666203 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:42:44.681828 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:42:44.697453 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:42:44.697453 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:42:44.713076 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:42:44.713076 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:42:44.728707 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:42:44.744331 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:42:44.759955 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:42:44.759955 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:42:44.775582 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:42:44.775582 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:42:44.916210 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:42:44.931838 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:42:44.931838 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:42:44.931838 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:42:44.931838 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:42:46.744396 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:42:46.775660 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:42:46.775660 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:42:46.775660 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:42:46.775660 - rocketbot - INFO - For count: 6
2025-11-05 14:42:46.775660 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:42:46.791272 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:42:46.791272 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:42:46.806896 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:42:46.806896 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:42:46.806896 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:42:46.822532 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:42:46.822532 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:42:46.838157 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:42:46.853776 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:42:46.853776 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:42:46.869408 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:42:46.869408 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:42:46.869408 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:42:46.885034 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:42:46.885034 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:42:46.885034 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:42:46.885034 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:42:47.994779 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:42:47.994779 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:42:51.010498 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:42:51.526139 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:42:54.529182 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:42:54.841690 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:42:57.866328 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:42:57.881962 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:42:57.881962 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:42:57.881962 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:42:57.881962 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:42:58.897612 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:42:59.085123 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:42:59.085123 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:00.100776 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:00.163281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:00.163281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:01.166248 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:01.244374 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:01.244374 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:43:01.244374 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:43:01.244374 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:43:01.244374 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:43:01.275631 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:43:01.275631 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:43:01.291256 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:43:01.306879 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:43:01.306879 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:43:03.306949 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:43:03.306949 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:43:03.822587 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:43:04.197598 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:43:05.197631 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:43:05.307010 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:43:06.307775 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:43:06.807793 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:43:08.808029 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:43:08.823657 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:43:08.823657 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:43:08.823657 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:43:08.823657 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:43:09.839312 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:43:10.026818 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:43:10.026818 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:11.038815 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:11.101319 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:11.195068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:12.195102 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:12.273230 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:12.273230 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:43:12.273230 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:43:12.273230 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:43:12.273230 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:43:12.304488 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:43:12.320109 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:43:12.320109 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:43:12.335743 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:13.351390 - rocketbot - INFO - For count: 0
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:13.351390 - rocketbot - INFO - For count: 1
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:43:13.351390 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:43:13.413894 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:43:13.413894 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:43:14.415472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:14.415472 - rocketbot - INFO - For count: 2
2025-11-05 14:43:14.415472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:43:14.415472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:43:14.415472 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:43:14.478104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:43:14.478104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:43:15.493631 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:15.493631 - rocketbot - INFO - For count: 3
2025-11-05 14:43:15.493631 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:43:15.493631 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:43:15.493631 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:43:15.556138 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:43:15.556138 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:43:16.560677 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:16.560677 - rocketbot - INFO - For count: 4
2025-11-05 14:43:16.560677 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:43:16.560677 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:43:16.560677 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:43:16.623183 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:43:16.623183 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:43:17.630466 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:17.630466 - rocketbot - INFO - For count: 5
2025-11-05 14:43:17.630466 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:43:17.630466 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:43:17.630466 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:43:17.692969 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:43:17.692969 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:43:18.703737 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:43:18.703737 - rocketbot - INFO - For count: 5
2025-11-05 14:43:18.703737 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:43:18.719368 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:43:18.719368 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:43:18.719368 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:43:18.719368 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:43:19.735021 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:43:19.922527 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:43:19.922527 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:20.924034 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:20.986540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:20.986540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:22.002194 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:43:22.080321 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:43:22.095946 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:43:22.095946 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:43:22.111573 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:43:22.111573 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:43:22.111573 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:25.113147 - rocketbot - INFO - For count: 0
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:25.113147 - rocketbot - INFO - For count: 1
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:43:25.113147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:43:25.238155 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:43:25.238155 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:43:26.253809 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:26.253809 - rocketbot - INFO - For count: 2
2025-11-05 14:43:26.253809 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:43:26.253809 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:43:26.253809 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:43:26.441900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:43:26.441900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:43:27.444528 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:27.444528 - rocketbot - INFO - For count: 3
2025-11-05 14:43:27.444528 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:43:27.444528 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:43:27.444528 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:43:27.569531 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:43:27.569531 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:43:28.569563 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:28.569563 - rocketbot - INFO - For count: 4
2025-11-05 14:43:28.569563 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:43:28.569563 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:43:28.569563 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:43:28.757070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:43:28.757070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:43:29.759984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:43:29.759984 - rocketbot - INFO - For count: 4
2025-11-05 14:43:29.759984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:43:29.759984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:43:29.869363 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:43:30.869396 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:43:30.931987 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:43:31.932020 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:43:31.947649 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:43:31.947649 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:43:31.947649 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:43:31.947649 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:43:32.963303 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:43:33.150809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:43:33.150809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:34.150842 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:34.213344 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:34.213344 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:35.213376 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:43:35.307129 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:43:35.322757 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:43:35.322757 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:43:35.338383 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:43:35.338383 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:43:38.340887 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:43:38.340887 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:43:38.356513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:43:38.356513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:43:38.356513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:43:38.356513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:43:39.356546 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:43:39.544051 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:43:39.544051 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:40.559712 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:40.622211 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:40.622211 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:41.637869 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:41.716000 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:41.716000 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:43:41.716000 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:43:41.716000 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:43:41.731624 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:43:41.731624 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:43:41.731624 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:43:41.762874 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:43:41.762874 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:43:41.762874 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:43:41.762874 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:43:41.762874 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:43:41.778501 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:43:41.778501 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:43:41.794126 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:43:41.794126 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:43:41.794126 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:43:41.794126 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:43:41.825375 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:43:41.825375 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:43:41.856637 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:43:41.856637 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:43:41.856637 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:43:41.856637 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:43:41.872253 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:43:41.887878 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:43:41.919132 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:43:41.934756 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:43:41.934756 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:43:43.825442 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:43:43.856693 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:43:43.856693 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:43:43.856693 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:43:43.872320 - rocketbot - INFO - For count: 7
2025-11-05 14:43:43.872320 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:43:43.887947 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:43:43.887947 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:43:43.887947 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:43:43.887947 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:43:43.887947 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:43:43.919196 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:43:43.919196 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:43:43.934829 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:43:43.934829 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:43:43.934829 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:43:43.950447 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:43:43.950447 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:43:43.950447 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:43:43.966072 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:43:43.966072 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:43:43.981698 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:43:43.981698 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:43:45.091108 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:43:45.091108 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:43:48.097301 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:43:48.628569 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:43:51.628668 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:43:51.941179 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:43:54.958940 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:43:54.974569 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:43:54.974569 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:43:54.974569 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:43:54.974569 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:43:55.990224 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:43:56.177731 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:43:56.177731 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:43:57.177765 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:43:57.240272 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:43:57.240272 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:43:58.255925 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:43:58.334053 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:43:58.334053 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:43:58.334053 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:43:58.334053 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:43:58.349676 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:43:58.380926 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:43:58.380926 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:43:58.380926 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:43:58.396553 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:43:58.396553 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:44:00.397103 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:44:00.397103 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:44:00.912749 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:44:01.287763 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:44:02.287796 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:44:02.397168 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:44:03.408374 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:44:03.908389 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:44:05.970957 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:44:05.986592 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:44:05.986592 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:44:05.986592 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:44:05.986592 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:44:07.002248 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:44:07.189746 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:44:07.189746 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:44:08.189780 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:44:08.252281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:44:08.252281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:44:09.252314 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:44:09.330439 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:44:09.330439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:44:09.330439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:44:09.330439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:44:09.330439 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:44:09.424193 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:44:09.455449 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:44:09.455449 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:44:09.471071 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:10.471104 - rocketbot - INFO - For count: 0
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:10.471104 - rocketbot - INFO - For count: 1
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:44:10.471104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:44:10.533607 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:44:10.533607 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:44:11.534880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:11.534880 - rocketbot - INFO - For count: 2
2025-11-05 14:44:11.534880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:44:11.534880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:44:11.534880 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:44:11.597382 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:44:11.597382 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:44:12.605410 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:12.605410 - rocketbot - INFO - For count: 3
2025-11-05 14:44:12.605410 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:44:12.605410 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:44:12.605410 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:44:12.667911 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:44:12.667911 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:44:13.670159 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:13.670159 - rocketbot - INFO - For count: 4
2025-11-05 14:44:13.670159 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:44:13.670159 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:44:13.670159 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:44:13.732662 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:44:13.732662 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:44:14.735433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:14.735433 - rocketbot - INFO - For count: 5
2025-11-05 14:44:14.735433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:44:14.735433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:44:14.735433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:44:14.797936 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:44:14.797936 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:44:15.811147 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:44:15.811147 - rocketbot - INFO - For count: 5
2025-11-05 14:44:15.811147 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:44:15.826779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:44:15.826779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:44:15.826779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:44:15.826779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:44:16.842430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:44:17.029939 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:44:17.029939 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:44:18.031157 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:44:18.093662 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:44:18.093662 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:44:19.109321 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:44:19.187446 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:44:19.203067 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:44:19.218697 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:44:19.218697 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:44:19.218697 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:44:19.218697 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:22.230405 - rocketbot - INFO - For count: 0
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:22.230405 - rocketbot - INFO - For count: 1
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:44:22.230405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:44:22.355409 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:44:22.355409 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:44:23.371067 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:23.371067 - rocketbot - INFO - For count: 2
2025-11-05 14:44:23.371067 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:44:23.371067 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:44:23.371067 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:44:23.559897 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:44:23.559897 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:44:24.559952 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:24.575576 - rocketbot - INFO - For count: 3
2025-11-05 14:44:24.575576 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:44:24.591202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:44:24.591202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:44:24.716206 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:44:24.716206 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:44:25.716239 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:25.716239 - rocketbot - INFO - For count: 4
2025-11-05 14:44:25.716239 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:44:25.716239 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:44:25.716239 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:44:25.893039 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:44:25.939936 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:44:26.944630 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:44:26.944630 - rocketbot - INFO - For count: 4
2025-11-05 14:44:26.944630 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:44:26.944630 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:44:27.054016 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:44:28.069673 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:44:28.132170 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:44:29.147829 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:44:29.163465 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:44:29.163465 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:44:29.163465 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:44:29.163465 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:44:30.179112 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:44:30.367715 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:44:30.367715 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:44:31.367784 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:44:31.430292 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:44:31.508419 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:44:32.508454 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:44:32.586572 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:44:32.602199 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:44:32.602199 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:44:32.617825 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:44:32.617825 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:44:35.620420 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:44:35.620420 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:44:35.636052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:44:35.636052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:44:35.636052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:44:35.636052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:44:36.651699 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:44:36.839202 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:44:36.839202 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:44:37.839235 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:44:37.901743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:44:37.901743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:44:38.902380 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:44:38.980505 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:44:38.980505 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:44:38.980505 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:44:38.980505 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:44:38.996134 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:44:38.996134 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:44:38.996134 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:44:39.011759 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:44:39.011759 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:44:39.027383 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:44:39.027383 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:44:39.027383 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:44:39.027383 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:44:39.027383 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:44:39.043010 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:44:39.043010 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:44:39.058638 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:44:39.058638 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:44:39.074263 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:44:39.074263 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:44:39.105514 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:44:39.105514 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:44:39.152402 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:44:39.152402 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:44:39.168015 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:44:39.183651 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:44:39.183651 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:44:39.183651 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:44:39.183651 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:44:40.902446 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:44:40.933696 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:44:40.933696 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:44:40.933696 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:44:40.949322 - rocketbot - INFO - For count: 8
2025-11-05 14:44:40.949322 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:44:40.964950 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:44:41.089952 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:44:41.089952 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:44:41.089952 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:44:41.089952 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:44:41.105578 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:44:41.105578 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:44:41.121205 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:44:41.121205 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:44:41.136828 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:44:41.152459 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:44:41.152459 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:44:41.152459 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:44:41.168082 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:44:41.168082 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:44:41.168082 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:44:41.168082 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:44:42.293125 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:44:42.293125 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:44:45.308841 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:44:45.824482 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:44:48.833039 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:44:49.145550 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:44:52.163562 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:44:52.179190 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:44:52.179190 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:44:52.179190 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:44:52.179190 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:44:53.184098 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:44:53.371605 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:44:53.371605 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:44:54.371638 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:44:54.434140 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:44:54.434140 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:44:55.434172 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:44:55.512310 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:44:55.512310 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:44:55.512310 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:44:55.512310 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:44:55.527924 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:44:55.543559 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:44:55.559180 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:44:55.559180 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:44:55.574814 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:44:55.574814 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:44:57.590493 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:44:57.590493 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:44:58.090510 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:44:58.465524 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:44:59.466660 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:44:59.576043 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:45:00.591695 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:45:01.091714 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:45:03.107403 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:45:03.123032 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:45:03.123032 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:45:03.123032 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:45:03.123032 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:45:04.134897 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:45:04.322403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:45:04.322403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:45:05.324282 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:45:05.386784 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:45:05.386784 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:45:06.389557 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:45:06.467685 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:45:06.467685 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:45:06.467685 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:45:06.467685 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:45:06.467685 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:45:06.498944 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:45:06.514561 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:45:06.514561 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:45:06.530191 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:07.545846 - rocketbot - INFO - For count: 0
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:07.545846 - rocketbot - INFO - For count: 1
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:45:07.545846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:45:07.608354 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:45:07.608354 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:45:08.624007 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:08.624007 - rocketbot - INFO - For count: 2
2025-11-05 14:45:08.624007 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:45:08.624007 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:45:08.624007 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:45:08.686509 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:45:08.686509 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:45:09.702167 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:09.702167 - rocketbot - INFO - For count: 3
2025-11-05 14:45:09.702167 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:45:09.702167 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:45:09.702167 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:45:09.764669 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:45:09.764669 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:45:10.766463 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:10.766463 - rocketbot - INFO - For count: 4
2025-11-05 14:45:10.766463 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:45:10.766463 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:45:10.766463 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:45:10.828967 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:45:10.828967 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:45:11.844626 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:11.844626 - rocketbot - INFO - For count: 5
2025-11-05 14:45:11.844626 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:45:11.844626 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:45:11.844626 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:45:11.907127 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:45:11.907127 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:45:12.907160 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:45:12.938410 - rocketbot - INFO - For count: 5
2025-11-05 14:45:12.938410 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:45:12.954038 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:45:12.954038 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:45:12.954038 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:45:12.969663 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:45:13.985320 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:45:14.172826 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:45:14.172826 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:45:15.174109 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:45:15.236617 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:45:15.236617 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:45:16.249970 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:45:16.328097 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:45:16.343780 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:45:16.343780 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:45:16.359406 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:45:16.359406 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:45:16.359406 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:19.360194 - rocketbot - INFO - For count: 0
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:19.360194 - rocketbot - INFO - For count: 1
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:45:19.360194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:45:19.487115 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:45:19.487115 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:45:20.491296 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:20.491296 - rocketbot - INFO - For count: 2
2025-11-05 14:45:20.491296 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:45:20.491296 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:45:20.491296 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:45:20.671835 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:45:20.671835 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:45:21.671867 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:21.671867 - rocketbot - INFO - For count: 3
2025-11-05 14:45:21.671867 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:45:21.671867 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:45:21.671867 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:45:21.796866 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:45:21.796866 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:45:22.796900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:22.796900 - rocketbot - INFO - For count: 4
2025-11-05 14:45:22.796900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:45:22.796900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:45:22.796900 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:45:22.984405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:45:22.984405 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:45:23.987474 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:45:23.987474 - rocketbot - INFO - For count: 4
2025-11-05 14:45:23.987474 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:45:23.987474 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:45:24.096853 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:45:25.096886 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:45:25.159388 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:45:26.159422 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:45:26.175052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:45:26.175052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:45:26.175052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:45:26.175052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:45:27.190705 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:45:27.378211 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:45:27.378211 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:45:28.379239 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:45:28.441746 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:45:28.441746 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:45:29.445797 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:45:29.523922 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:45:29.711429 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:45:29.711429 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:45:29.727059 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:45:29.727059 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:45:29.727059 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:45:29.742683 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:45:29.758307 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:45:29.758307 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:45:29.758307 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:45:29.758307 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:45:32.773208 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:45:32.773208 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:45:32.788834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:45:32.788834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:45:32.788834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:45:32.788834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:45:33.788867 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:45:33.976372 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:45:33.976372 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:45:34.976405 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:45:35.038907 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:45:35.085784 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:45:36.085818 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:45:36.163995 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:45:36.163995 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:45:36.163995 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:45:36.163995 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:45:36.179570 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:45:36.179570 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:45:36.179570 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:45:36.195205 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:45:36.195205 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:45:36.195205 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:45:36.210821 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:45:36.210821 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:45:36.210821 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:45:36.210821 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:45:36.226447 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:45:36.226447 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:45:36.242072 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:45:36.242072 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:45:36.257697 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:45:36.257697 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:45:36.288951 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:45:36.288951 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:45:36.335835 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:45:36.335835 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:45:36.351452 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:45:36.367082 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:45:36.367082 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:45:36.367082 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:45:36.367082 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:45:38.179637 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:45:38.210887 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:45:38.210887 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:45:38.210887 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:45:38.226513 - rocketbot - INFO - For count: 9
2025-11-05 14:45:38.226513 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:45:38.242137 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:45:38.242137 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:45:38.242137 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:45:38.242137 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:45:38.242137 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:45:38.257763 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:45:38.273389 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:45:38.289014 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:45:38.289014 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:45:38.289014 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:45:38.304648 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:45:38.304648 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:45:38.304648 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:45:38.320270 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:45:38.320270 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:45:38.320270 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:45:38.320270 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:45:39.431368 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:45:39.431368 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:45:42.435011 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:45:42.935028 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:45:45.946671 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:45:46.259180 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:45:49.281217 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:45:49.296844 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:45:49.296844 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:45:49.296844 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:45:49.296844 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:45:50.297365 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:45:50.484872 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:45:50.484872 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:45:51.487223 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:45:51.549725 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:45:51.549725 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:45:52.549759 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:45:52.627890 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:45:52.627890 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:45:52.627890 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:45:52.627890 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:45:52.643512 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:45:52.659142 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:45:52.674765 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:45:52.674765 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:45:52.690390 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:45:52.690390 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:45:54.704334 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:45:54.704334 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:45:55.219977 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:45:55.594997 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:45:56.610646 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:45:56.720026 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:45:57.720336 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:45:58.220356 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:46:00.235543 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:00.251174 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:00.251174 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:00.251174 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:00.251174 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:01.261048 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:01.448554 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:01.448554 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:02.448588 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:02.511095 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:02.511095 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:46:03.526747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:46:03.604875 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:46:03.604875 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:46:03.604875 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:46:03.604875 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:46:03.604875 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:46:03.636131 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:46:03.636131 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:46:03.651756 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:46:03.667381 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:04.668507 - rocketbot - INFO - For count: 0
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:04.668507 - rocketbot - INFO - For count: 1
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:46:04.668507 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:46:04.731010 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:46:04.731010 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:46:05.733779 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:05.733779 - rocketbot - INFO - For count: 2
2025-11-05 14:46:05.733779 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:46:05.733779 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:46:05.733779 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:46:05.799373 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:46:05.799373 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:46:06.799425 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:06.830676 - rocketbot - INFO - For count: 3
2025-11-05 14:46:06.830676 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:46:06.830676 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:46:06.830676 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:46:06.893178 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:46:06.893178 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:46:07.893210 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:07.893210 - rocketbot - INFO - For count: 4
2025-11-05 14:46:07.893210 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:46:07.893210 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:46:07.893210 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:46:07.955714 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:46:07.955714 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:46:08.962775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:08.962775 - rocketbot - INFO - For count: 5
2025-11-05 14:46:08.962775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:46:08.962775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:46:08.962775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:46:09.025274 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:46:09.025274 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:46:10.025310 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:46:10.025310 - rocketbot - INFO - For count: 5
2025-11-05 14:46:10.025310 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:10.040944 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:10.040944 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:10.040944 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:10.040944 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:11.043720 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:11.231230 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:11.231230 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:12.232060 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:12.294561 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:12.294561 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:46:13.310214 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:46:13.388343 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:46:13.403969 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:46:13.403969 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:46:13.419594 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:46:13.419594 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:46:13.419594 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:46:16.419763 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:46:16.419763 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:16.419763 - rocketbot - INFO - For count: 0
2025-11-05 14:46:16.419763 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:16.419763 - rocketbot - INFO - For count: 1
2025-11-05 14:46:16.419763 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:46:16.435388 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:46:16.435388 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:46:16.560392 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:46:16.560392 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:46:17.564488 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:17.564488 - rocketbot - INFO - For count: 2
2025-11-05 14:46:17.564488 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:46:17.564488 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:46:17.564488 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:46:17.753600 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:46:17.769483 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:46:18.784912 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:18.784912 - rocketbot - INFO - For count: 3
2025-11-05 14:46:18.784912 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:46:18.784912 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:46:18.784912 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:46:18.912056 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:46:18.912056 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:46:19.912089 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:19.912089 - rocketbot - INFO - For count: 4
2025-11-05 14:46:19.912089 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:46:19.912089 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:46:19.912089 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:46:20.099594 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:46:20.099594 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:46:21.099627 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:46:21.099627 - rocketbot - INFO - For count: 4
2025-11-05 14:46:21.099627 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:46:21.099627 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:46:21.209006 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:46:22.224664 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:46:22.287167 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:46:23.302824 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:23.318457 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:23.318457 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:23.318457 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:23.318457 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:24.334109 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:24.522117 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:24.522117 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:25.522149 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:25.584653 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:25.584653 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:46:26.584987 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:46:26.663114 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:46:26.678736 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:46:26.694361 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:46:26.694361 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:46:26.694361 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:46:29.704453 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:46:29.704453 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:29.720081 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:29.720081 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:29.720081 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:29.720081 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:30.720117 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:30.907619 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:30.907619 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:31.923278 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:31.985779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:31.985779 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:46:32.985812 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:46:33.126449 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:46:33.126449 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:46:33.126449 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:46:33.126449 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:46:33.142065 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:46:33.142065 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:46:33.142065 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:46:33.173319 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:46:33.173319 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:46:33.173319 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:46:33.173319 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:46:33.173319 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:46:33.188945 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:46:33.188945 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:46:33.204572 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:46:33.204572 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:46:33.204572 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:46:33.204572 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:46:33.220193 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:46:33.235820 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:46:33.251445 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:46:33.267069 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:46:33.267069 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:46:33.267069 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:46:33.267069 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:46:33.282696 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:46:33.313952 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:46:33.313952 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:46:33.329577 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:46:35.110881 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:46:35.142135 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:46:35.142135 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:46:35.142135 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:46:35.142135 - rocketbot - INFO - For count: 10
2025-11-05 14:46:35.142135 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:46:35.157761 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:46:35.157761 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:46:35.173386 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:46:35.173386 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:46:35.173386 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:46:35.189009 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:46:35.189009 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:46:35.204643 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:46:35.204643 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:46:35.220263 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:46:35.235943 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:46:35.235943 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:46:35.235943 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:46:35.251521 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:46:35.251521 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:46:35.251521 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:46:35.251521 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:46:36.365716 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:46:36.365716 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:46:39.365814 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:46:39.881464 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:46:42.897185 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:46:43.209689 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:46:46.222500 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:46.238128 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:46.238128 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:46.238128 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:46.238128 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:47.238164 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:47.426850 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:47.426850 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:48.428875 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:48.491385 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:48.491385 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:46:49.507035 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:46:49.585167 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:46:49.585167 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:46:49.585167 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:46:49.585167 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:46:49.585167 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:46:49.616417 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:46:49.632038 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:46:49.632038 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:46:49.647677 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:46:49.647677 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:46:51.654843 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:46:51.654843 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:46:52.154866 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:46:52.529871 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:46:53.561155 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:46:53.670534 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:46:54.670567 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:46:55.170589 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:46:57.172108 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:46:57.187747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:46:57.187747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:46:57.187747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:46:57.187747 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:46:58.191020 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:46:58.378526 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:46:58.378526 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:46:59.378559 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:46:59.441061 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:46:59.441061 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:00.441094 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:00.519220 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:00.519220 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:47:00.519220 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:47:00.519220 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:47:00.519220 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:47:00.550475 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:47:00.566100 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:47:00.566100 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:47:00.581725 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:01.596411 - rocketbot - INFO - For count: 0
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:01.596411 - rocketbot - INFO - For count: 1
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:01.596411 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:01.658915 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:01.658915 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:02.671834 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:02.671834 - rocketbot - INFO - For count: 2
2025-11-05 14:47:02.671834 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:02.671834 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:02.671834 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:02.734336 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:02.734336 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:03.743098 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:03.743098 - rocketbot - INFO - For count: 3
2025-11-05 14:47:03.743098 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:03.743098 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:03.743098 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:03.805601 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:03.836854 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:04.837307 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:04.837307 - rocketbot - INFO - For count: 4
2025-11-05 14:47:04.837307 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:04.837307 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:04.837307 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:04.899810 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:04.899810 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:05.899842 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:05.899842 - rocketbot - INFO - For count: 5
2025-11-05 14:47:05.899842 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:05.899842 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:05.899842 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:05.962350 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:05.962350 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:06.978003 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:06.978003 - rocketbot - INFO - For count: 5
2025-11-05 14:47:06.978003 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:47:06.993633 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:47:06.993633 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:47:06.993633 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:47:06.993633 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:47:07.996934 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:47:08.200066 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:47:08.200066 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:47:09.200098 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:47:09.262601 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:47:09.262601 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:10.264264 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:47:10.342389 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:47:10.358025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:47:10.358025 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:47:10.373645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:47:10.373645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:47:10.373645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:13.376422 - rocketbot - INFO - For count: 0
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:13.376422 - rocketbot - INFO - For count: 1
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:47:13.376422 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:47:13.501433 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:47:13.501433 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:47:14.504030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:14.504030 - rocketbot - INFO - For count: 2
2025-11-05 14:47:14.504030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:47:14.504030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:47:14.504030 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:47:14.691536 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:47:14.691536 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:47:15.707189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:15.707189 - rocketbot - INFO - For count: 3
2025-11-05 14:47:15.707189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:47:15.707189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:47:15.707189 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:47:15.832193 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:47:15.832193 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:47:16.833548 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:16.833548 - rocketbot - INFO - For count: 4
2025-11-05 14:47:16.833548 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:47:16.833548 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:47:16.833548 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:47:17.015132 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:47:17.015132 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:47:18.030786 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:47:18.030786 - rocketbot - INFO - For count: 4
2025-11-05 14:47:18.030786 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:47:18.030786 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:47:18.140164 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:47:19.141014 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:47:19.203516 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:47:20.234805 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:47:20.250428 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:47:20.250428 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:47:20.250428 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:47:20.250428 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:47:21.266085 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:47:21.454354 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:47:21.454354 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:47:22.456272 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:47:22.518776 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:47:22.518776 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:23.531947 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:47:23.610082 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:47:23.641326 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:47:23.641326 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:47:23.641326 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:47:23.641326 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:47:26.643690 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:47:26.643690 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:47:26.659329 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:47:26.659329 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:47:26.659329 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:47:26.659329 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:47:27.669108 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:47:27.856614 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:47:27.856614 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:47:28.856647 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:47:28.919154 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:47:28.950399 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:29.950433 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:30.028560 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:30.028560 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:47:30.028560 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:47:30.028560 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:47:30.044190 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:47:30.044190 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:47:30.044190 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:47:30.059816 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:47:30.059816 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:47:30.059816 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:47:30.075440 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:47:30.075440 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:47:30.075440 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:47:30.075440 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:47:30.091062 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:47:30.091062 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:47:30.091062 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:47:30.106686 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:47:30.122311 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:47:30.122311 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:47:30.153568 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:47:30.153568 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:47:30.200456 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:47:30.200456 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:47:30.200456 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:47:30.231697 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:47:30.231697 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:47:30.231697 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:47:30.231697 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:47:32.028627 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:47:32.059880 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:47:32.059880 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:47:32.075506 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:47:32.075506 - rocketbot - INFO - For count: 11
2025-11-05 14:47:32.075506 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:47:32.091132 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:47:32.091132 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:47:32.091132 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:47:32.091132 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:47:32.106756 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:47:32.122384 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:47:32.122384 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:47:32.138014 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:47:32.138014 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:47:32.138014 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:47:32.153633 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:47:32.153633 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:47:32.153633 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:47:32.169260 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:47:32.184889 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:47:32.184889 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:47:32.184889 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:47:33.309920 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:47:33.309920 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:47:36.310071 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:47:36.810088 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:47:39.819120 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:47:40.194134 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:47:43.194231 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:47:43.209862 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:47:43.209862 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:47:43.209862 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:47:43.209862 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:47:44.225520 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:47:44.413028 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:47:44.413028 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:47:45.413063 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:47:45.475556 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:47:45.475556 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:46.477443 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:46.555574 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:46.555574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:47:46.555574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:47:46.555574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:47:46.571199 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:47:46.586831 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:47:46.602446 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:47:46.602446 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:47:46.618079 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:47:46.618079 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:47:48.620667 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:47:48.620667 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:47:49.136303 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:47:49.511316 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:47:50.526973 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:47:50.636352 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:47:51.636384 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:47:52.136406 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:47:54.152093 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:47:54.167724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:47:54.167724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:47:54.167724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:47:54.167724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:47:55.183377 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:47:55.370883 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:47:55.370883 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:47:56.370916 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:47:56.433417 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:47:56.433417 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:47:57.433451 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:47:57.511578 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:47:57.511578 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:47:57.511578 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:47:57.527204 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:47:57.527204 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:47:57.558454 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:47:57.558454 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:47:57.558454 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:47:57.574083 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:58.589740 - rocketbot - INFO - For count: 0
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:58.589740 - rocketbot - INFO - For count: 1
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:58.589740 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:58.652242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:58.652242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:47:59.667908 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:47:59.667908 - rocketbot - INFO - For count: 2
2025-11-05 14:47:59.667908 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:47:59.667908 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:47:59.667908 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:47:59.730408 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:47:59.730408 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:00.733510 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:00.733510 - rocketbot - INFO - For count: 3
2025-11-05 14:48:00.733510 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:00.733510 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:00.733510 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:00.796012 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:00.796012 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:01.800867 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:01.800867 - rocketbot - INFO - For count: 4
2025-11-05 14:48:01.800867 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:01.800867 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:01.800867 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:01.863364 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:01.863364 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:02.879021 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:02.879021 - rocketbot - INFO - For count: 5
2025-11-05 14:48:02.879021 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:02.879021 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:02.879021 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:02.941524 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:02.941524 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:03.941912 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:03.941912 - rocketbot - INFO - For count: 5
2025-11-05 14:48:03.941912 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:48:03.957540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:48:03.957540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:48:03.957540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:48:03.957540 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:48:04.973196 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:48:05.160707 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:48:05.160707 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:48:06.176367 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:48:06.238872 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:48:06.238872 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:48:07.240975 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:48:07.319096 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:48:07.334726 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:48:07.334726 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:48:07.350352 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:48:07.350352 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:48:07.350352 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:10.366070 - rocketbot - INFO - For count: 0
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:10.366070 - rocketbot - INFO - For count: 1
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:48:10.366070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:48:10.491080 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:48:10.491080 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:48:11.506733 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:11.506733 - rocketbot - INFO - For count: 2
2025-11-05 14:48:11.506733 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:48:11.506733 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:48:11.506733 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:48:11.694247 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:48:11.694247 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:48:12.709910 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:12.709910 - rocketbot - INFO - For count: 3
2025-11-05 14:48:12.709910 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:48:12.709910 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:48:12.709910 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:48:12.834904 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:48:12.834904 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:48:13.834937 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:13.834937 - rocketbot - INFO - For count: 4
2025-11-05 14:48:13.834937 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:48:13.834937 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:48:13.834937 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:48:14.023237 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:48:14.023237 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:48:15.023270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:48:15.023270 - rocketbot - INFO - For count: 4
2025-11-05 14:48:15.023270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:48:15.023270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:48:15.132651 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:48:16.148308 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:48:16.210809 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:48:17.226465 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:48:17.242093 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:48:17.242093 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:48:17.242093 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:48:17.242093 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:48:18.257752 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:48:18.445258 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:48:18.445258 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:48:19.460916 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:48:19.523425 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:48:19.523425 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:48:20.539078 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:48:20.617202 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:48:20.632835 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:48:20.648458 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:48:20.648458 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:48:20.648458 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:48:23.654532 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:48:23.654532 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:48:23.670175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:48:23.670175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:48:23.670175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:48:23.670175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:48:24.676179 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:48:24.863685 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:48:24.863685 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:48:25.863717 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:48:25.926225 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:48:25.926225 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:48:26.926259 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:48:27.004378 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:48:27.004378 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:48:27.004378 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:48:27.004378 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:48:27.020015 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:48:27.020015 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:48:27.020015 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:48:27.035631 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:48:27.035631 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:48:27.051257 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:48:27.051257 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:48:27.051257 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:48:27.051257 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:48:27.051257 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:48:27.066886 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:48:27.066886 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:48:27.082510 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:48:27.082510 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:48:27.098132 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:48:27.098132 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:48:27.129390 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:48:27.129390 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:48:27.176270 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:48:27.176270 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:48:27.191894 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:48:27.207516 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:48:27.207516 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:48:27.207516 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:48:27.207516 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:48:29.020078 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:48:29.051324 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:48:29.051324 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:48:29.051324 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:48:29.066951 - rocketbot - INFO - For count: 12
2025-11-05 14:48:29.066951 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:48:29.082577 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:48:29.082577 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:48:29.082577 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:48:29.082577 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:48:29.082577 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:48:29.113827 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:48:29.113827 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:48:29.129452 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:48:29.129452 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:48:29.129452 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:48:29.145079 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:48:29.145079 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:48:29.145079 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:48:29.160704 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:48:29.160704 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:48:29.160704 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:48:29.160704 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:48:30.291661 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:48:30.291661 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:48:33.297045 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:48:33.797060 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:48:36.808047 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:48:37.120556 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:48:40.120641 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:48:40.136276 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:48:40.136276 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:48:40.136276 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:48:40.136276 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:48:41.150323 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:48:41.337827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:48:41.337827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:48:42.337864 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:48:42.400362 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:48:42.400362 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:48:43.400394 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:48:43.478517 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:48:43.478517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:48:43.478517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:48:43.478517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:48:43.478517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:48:43.509775 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:48:43.525395 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:48:43.525395 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:48:43.541022 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:48:43.541022 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:48:45.550103 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:48:45.550103 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:48:46.050118 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:48:46.425127 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:48:47.518910 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:48:47.628288 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:48:48.631871 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:48:49.131882 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:48:51.131938 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:48:51.147567 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:48:51.147567 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:48:51.147567 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:48:51.147567 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:48:52.151284 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:48:52.338794 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:48:52.338794 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:48:53.338820 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:48:53.401317 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:48:53.401317 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:48:54.401636 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:48:54.479762 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:48:54.479762 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:48:54.479762 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:48:54.479762 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:48:54.479762 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:48:54.511022 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:48:54.526643 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:48:54.526643 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:48:54.542270 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:55.557918 - rocketbot - INFO - For count: 0
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:55.557918 - rocketbot - INFO - For count: 1
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:55.557918 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:55.620421 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:55.620421 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:56.620448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:56.620448 - rocketbot - INFO - For count: 2
2025-11-05 14:48:56.620448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:56.620448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:56.620448 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:56.682953 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:56.682953 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:57.698605 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:57.698605 - rocketbot - INFO - For count: 3
2025-11-05 14:48:57.698605 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:57.698605 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:57.698605 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:57.761108 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:57.761108 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:58.776759 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:58.776759 - rocketbot - INFO - For count: 4
2025-11-05 14:48:58.776759 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:58.776759 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:58.776759 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:58.839262 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:58.839262 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:48:59.854914 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:48:59.854914 - rocketbot - INFO - For count: 5
2025-11-05 14:48:59.854914 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:48:59.854914 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:48:59.854914 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:48:59.917417 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:48:59.917417 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:00.928835 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:00.928835 - rocketbot - INFO - For count: 5
2025-11-05 14:49:00.928835 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:00.944463 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:00.944463 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:00.944463 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:00.944463 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:01.945500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:02.133006 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:02.133006 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:49:03.134911 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:49:03.213041 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:49:03.213041 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:49:04.226743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:49:04.304873 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:49:04.320499 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:49:04.320499 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:49:04.336123 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:49:04.336123 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:49:04.336123 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:07.339624 - rocketbot - INFO - For count: 0
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:07.339624 - rocketbot - INFO - For count: 1
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:49:07.339624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:49:07.464633 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:49:07.464633 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:49:08.465117 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:08.465117 - rocketbot - INFO - For count: 2
2025-11-05 14:49:08.465117 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:49:08.465117 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:49:08.465117 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:49:08.652624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:49:08.652624 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:49:09.653813 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:09.653813 - rocketbot - INFO - For count: 3
2025-11-05 14:49:09.653813 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:49:09.653813 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:49:09.653813 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:49:09.778816 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:49:09.778816 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:49:10.783652 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:10.783652 - rocketbot - INFO - For count: 4
2025-11-05 14:49:10.783652 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:49:10.783652 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:49:10.783652 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:49:10.971163 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:49:10.971163 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:49:11.971194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:49:11.971194 - rocketbot - INFO - For count: 4
2025-11-05 14:49:11.971194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:49:11.971194 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:49:12.080573 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:49:13.082568 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:49:13.145089 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:49:14.145118 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:14.160745 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:14.160745 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:14.160745 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:14.160745 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:15.160774 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:15.348278 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:15.348278 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:49:16.355881 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:49:16.418389 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:49:16.418389 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:49:17.434041 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:49:17.512167 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:49:17.527793 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:49:17.527793 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:49:17.543419 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:49:17.543419 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:49:20.556157 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:49:20.556157 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:20.571801 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:20.571801 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:20.571801 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:20.571801 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:21.587434 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:21.774941 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:21.774941 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:49:22.778077 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:49:22.887426 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:49:22.887426 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:49:23.903079 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:49:23.981208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:49:23.981208 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:49:23.981208 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:49:23.981208 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:49:23.996833 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:49:23.996833 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:49:23.996833 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:49:24.012464 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:49:24.012464 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:49:24.012464 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:49:24.028079 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:49:24.028079 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:49:24.028079 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:49:24.028079 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:49:24.043707 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:49:24.043707 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:49:24.043707 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:49:24.059332 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:49:24.074956 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:49:24.074956 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:49:24.106217 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:49:24.121837 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:49:24.231211 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:49:24.231211 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:49:24.246837 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:49:24.262463 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:49:24.262463 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:49:24.262463 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:49:24.262463 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:49:26.012509 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:49:26.043775 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:49:26.043775 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:49:26.043775 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:49:26.059399 - rocketbot - INFO - For count: 13
2025-11-05 14:49:26.059399 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:49:26.075320 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:49:26.075320 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:49:26.075320 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:49:26.075320 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:49:26.075320 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:49:26.106263 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:49:26.106263 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:49:26.121901 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:49:26.121901 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:49:26.121901 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:49:26.137514 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:49:26.137514 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:49:26.137514 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:49:26.153138 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:49:26.153138 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:49:26.153138 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:49:26.168769 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:49:27.326823 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:49:27.326823 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:49:30.329273 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:49:30.829287 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:49:33.841352 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:49:34.169490 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:49:37.170741 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:37.186367 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:37.186367 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:37.186367 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:37.201994 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:38.217645 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:38.405152 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:38.405152 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:49:39.405181 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:49:39.470644 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:49:39.470644 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:49:40.470670 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:49:40.548802 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:49:40.548802 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:49:40.548802 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:49:40.548802 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:49:40.548802 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:49:40.580049 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:49:40.595676 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:49:40.595676 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:49:40.611301 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:49:40.611301 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:49:42.616698 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:49:42.616698 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:49:43.116713 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:49:43.491732 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:49:44.498779 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:49:44.608162 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:49:45.623808 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:49:46.123824 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:49:48.136626 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:48.152256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:48.152256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:48.152256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:48.152256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:49.157577 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:49.345084 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:49.345084 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:49:50.355862 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:49:50.418365 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:49:50.418365 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:49:51.418391 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:49:51.496515 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:49:51.496515 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:49:51.496515 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:49:51.496515 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:49:51.496515 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:49:51.543404 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:49:51.543404 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:49:51.543404 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:49:51.559027 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:52.567522 - rocketbot - INFO - For count: 0
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:52.567522 - rocketbot - INFO - For count: 1
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:49:52.567522 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:49:52.630023 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:49:52.630023 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:53.631931 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:53.631931 - rocketbot - INFO - For count: 2
2025-11-05 14:49:53.631931 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:49:53.631931 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:49:53.631931 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:49:53.694433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:49:53.694433 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:54.710084 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:54.710084 - rocketbot - INFO - For count: 3
2025-11-05 14:49:54.710084 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:49:54.710084 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:49:54.710084 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:49:54.772590 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:49:54.772590 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:55.788242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:55.788242 - rocketbot - INFO - For count: 4
2025-11-05 14:49:55.788242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:49:55.788242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:49:55.788242 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:49:55.850745 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:49:55.850745 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:56.852241 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:56.852241 - rocketbot - INFO - For count: 5
2025-11-05 14:49:56.852241 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:49:56.852241 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:49:56.852241 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:49:56.914742 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:49:56.914742 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:49:57.930395 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:49:57.930395 - rocketbot - INFO - For count: 5
2025-11-05 14:49:57.930395 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:49:57.946024 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:49:57.946024 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:49:57.946024 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:49:57.946024 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:49:58.960497 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:49:59.148003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:49:59.148003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:00.163653 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:00.226155 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:00.226155 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:01.226183 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:50:01.304308 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:50:01.319938 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:50:01.319938 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:50:01.335562 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:50:01.335562 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:50:01.335562 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:04.337838 - rocketbot - INFO - For count: 0
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:04.337838 - rocketbot - INFO - For count: 1
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:50:04.337838 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:50:04.462848 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:50:04.462848 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:50:05.465479 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:05.465479 - rocketbot - INFO - For count: 2
2025-11-05 14:50:05.465479 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:50:05.465479 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:50:05.465479 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:50:05.652984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:50:05.652984 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:50:06.668631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:06.668631 - rocketbot - INFO - For count: 3
2025-11-05 14:50:06.668631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:50:06.668631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:50:06.668631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:50:06.793640 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:50:06.793640 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:50:07.799070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:07.799070 - rocketbot - INFO - For count: 4
2025-11-05 14:50:07.799070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:50:07.799070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:50:07.799070 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:50:07.986799 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:50:07.986799 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:50:08.986602 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:50:08.986602 - rocketbot - INFO - For count: 4
2025-11-05 14:50:08.986602 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:50:08.986602 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:50:09.095986 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:50:10.096887 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:50:10.159389 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:50:11.162158 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:50:11.177792 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:50:11.177792 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:50:11.177792 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:50:11.177792 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:50:12.193435 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:50:12.380945 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:50:12.380945 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:13.383857 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:13.446364 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:13.446364 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:14.462015 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:14.540951 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:50:14.556577 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:50:14.572209 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:50:14.572209 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:50:14.572209 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:50:14.572209 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:50:17.577759 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:50:17.577759 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:50:17.593383 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:50:17.593383 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:50:17.593383 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:50:17.593383 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:50:18.593410 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:50:18.782775 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:50:18.782775 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:19.798429 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:19.860934 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:19.860934 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:20.862273 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:20.940403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:20.940403 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:50:20.940403 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:50:20.940403 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:50:20.956029 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:50:20.956029 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:50:20.956029 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:50:20.971654 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:50:20.987279 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:50:20.987279 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:50:20.987279 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:50:20.987279 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:50:20.987279 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:50:21.002904 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:50:21.002904 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:50:21.018531 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:50:21.018531 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:50:21.018531 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:50:21.034155 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:50:21.034155 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:50:21.065404 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:50:21.081028 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:50:21.081028 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:50:21.081028 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:50:21.081028 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:50:21.096654 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:50:21.127907 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:50:21.127907 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:50:21.127907 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:50:22.987335 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:50:23.019027 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:50:23.019027 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:50:23.019027 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:50:23.019027 - rocketbot - INFO - For count: 14
2025-11-05 14:50:23.019027 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:50:23.034212 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:50:23.034212 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:50:23.049848 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:50:23.049848 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:50:23.049848 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:50:23.065470 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:50:23.065470 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:50:23.096715 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:50:23.096715 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:50:23.096715 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:50:23.112349 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:50:23.112349 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:50:23.112349 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:50:23.127973 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:50:23.127973 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:50:23.127973 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:50:23.127973 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:50:24.268622 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:50:24.268622 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:50:27.284332 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:50:27.784353 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:50:30.793529 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:50:31.106041 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:50:34.132546 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:50:34.148175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:50:34.148175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:50:34.148175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:50:34.148175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:50:35.149007 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:50:35.336517 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:50:35.336517 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:36.337729 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:36.400231 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:36.400231 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:37.400264 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:37.478386 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:37.478386 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:50:37.478386 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:50:37.478386 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:50:37.494018 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:50:37.525267 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:50:37.525267 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:50:37.525267 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:50:37.540897 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:50:37.540897 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:50:39.556572 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:50:39.556572 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:50:40.056590 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:50:40.431602 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:50:41.447250 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:50:41.556630 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:50:42.556663 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:50:43.056674 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:50:45.056728 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:50:45.072357 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:50:45.072357 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:50:45.072357 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:50:45.072357 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:50:46.088011 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:50:46.276901 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:50:46.276901 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:47.280037 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:47.342539 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:47.342539 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:48.342566 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:48.420696 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:48.420696 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:50:48.420696 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:50:48.420696 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:50:48.420696 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:50:48.467578 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:50:48.467578 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:50:48.467578 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:50:48.483207 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:49.498852 - rocketbot - INFO - For count: 0
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:49.498852 - rocketbot - INFO - For count: 1
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:50:49.498852 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:50:49.561353 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:50:49.561353 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:50:50.561383 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:50.561383 - rocketbot - INFO - For count: 2
2025-11-05 14:50:50.561383 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:50:50.561383 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:50:50.561383 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:50:50.623883 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:50:50.623883 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:50:51.626712 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:51.626712 - rocketbot - INFO - For count: 3
2025-11-05 14:50:51.626712 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:50:51.626712 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:50:51.626712 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:50:51.689215 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:50:51.689215 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:50:52.689245 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:52.689245 - rocketbot - INFO - For count: 4
2025-11-05 14:50:52.689245 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:50:52.689245 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:50:52.689245 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:50:52.751746 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:50:52.751746 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:50:53.751772 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:53.751772 - rocketbot - INFO - For count: 5
2025-11-05 14:50:53.751772 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:50:53.751772 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:50:53.751772 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:50:53.814273 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:50:53.814273 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:50:54.815080 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:50:54.815080 - rocketbot - INFO - For count: 5
2025-11-05 14:50:54.815080 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:50:54.830705 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:50:54.830705 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:50:54.830705 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:50:54.830705 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:50:55.832756 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:50:56.051513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:50:56.051513 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:50:57.051539 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:50:57.114044 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:50:57.114044 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:50:58.129698 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:50:58.207853 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:50:58.223450 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:50:58.223450 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:50:58.239075 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:50:58.239075 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:50:58.239075 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:01.242843 - rocketbot - INFO - For count: 0
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:01.242843 - rocketbot - INFO - For count: 1
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:01.242843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:01.367631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:01.367631 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:51:02.370915 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:02.370915 - rocketbot - INFO - For count: 2
2025-11-05 14:51:02.370915 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:02.370915 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:02.370915 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:02.558420 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:02.558420 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:51:03.558735 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:03.558735 - rocketbot - INFO - For count: 3
2025-11-05 14:51:03.558735 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:03.558735 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:03.558735 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:03.683744 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:03.683744 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:51:04.699393 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:04.699393 - rocketbot - INFO - For count: 4
2025-11-05 14:51:04.699393 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:04.699393 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:04.699393 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:04.886898 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:04.886898 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:51:05.886930 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:05.886930 - rocketbot - INFO - For count: 4
2025-11-05 14:51:05.886930 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:51:05.886930 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:51:05.996308 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:51:07.011959 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:51:07.074461 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:51:08.074489 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:51:08.090120 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:51:08.090120 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:51:08.090120 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:51:08.090120 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:51:09.105771 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:51:09.293278 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:51:09.293278 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:51:10.293309 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:51:10.355806 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:51:10.355806 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:51:11.355832 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:51:11.433958 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:51:11.449590 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:51:11.465210 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:51:11.465210 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:51:11.465210 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:51:14.476752 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:51:14.476752 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:51:14.492379 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:51:14.492379 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:51:14.492379 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:51:14.492379 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:51:15.493548 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:51:15.681052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:51:15.681052 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:51:16.681078 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:51:16.743585 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:51:16.743585 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:51:17.759234 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:51:17.837369 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:51:17.837369 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:51:17.837369 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:51:17.837369 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:51:17.852991 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:51:17.852991 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:51:17.852991 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:51:17.868617 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:51:17.868617 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:51:17.868617 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:51:17.884241 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:51:17.884241 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:51:17.884241 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 14:51:17.884241 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 14:51:17.899871 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:51:17.899871 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:51:17.915488 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:51:17.915488 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:51:17.931113 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:51:17.946746 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:51:17.962369 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:51:17.977996 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 14:51:18.009255 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:51:18.009255 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:51:18.024874 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:51:18.134253 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:51:18.134253 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:51:18.134253 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:51:18.149875 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:51:19.884295 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:51:19.915552 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:51:19.915552 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:51:19.915552 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:51:19.931172 - rocketbot - INFO - For count: 15
2025-11-05 14:51:19.931172 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:51:19.946797 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:51:19.946797 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:51:19.946797 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:51:19.946797 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:51:19.946797 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:51:19.978049 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:51:19.978049 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:51:19.993672 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:51:19.993672 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:51:19.993672 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:51:20.009295 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:51:20.009295 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:51:20.009295 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:51:20.024923 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:51:20.024923 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:51:20.024923 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:51:20.040550 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:51:21.149958 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:51:21.149958 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:51:24.162653 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:51:24.662668 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:51:27.669045 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:51:27.997176 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:51:30.998221 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:51:31.013847 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:51:31.013847 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:51:31.013847 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:51:31.013847 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:51:32.024996 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:51:32.200258 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:51:32.200258 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:51:33.215915 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:51:33.391626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:51:33.391626 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:51:34.391654 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:51:34.469784 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:51:34.469784 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:51:34.469784 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:51:34.469784 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:51:34.485404 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:51:34.516658 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:51:34.516658 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:51:34.516658 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:51:34.532291 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:51:34.532291 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:51:36.547967 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:51:36.547967 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:51:37.047982 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:51:37.422990 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:51:38.424208 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:51:38.533587 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:51:39.549243 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:51:40.049259 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:51:42.051449 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:51:42.067085 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:51:42.067085 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:51:42.067085 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:51:42.067085 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:51:43.068921 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:51:43.256427 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:51:43.256427 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:51:44.266702 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:51:44.329203 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:51:44.329203 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:51:45.342261 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:51:45.420614 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:51:45.420614 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:51:45.420614 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:51:45.420614 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:51:45.420614 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:51:45.451650 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:51:45.467272 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:51:45.467272 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:51:45.482900 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:46.498542 - rocketbot - INFO - For count: 0
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:46.498542 - rocketbot - INFO - For count: 1
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:51:46.498542 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:51:46.561045 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:51:46.561045 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:51:47.573435 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:47.573435 - rocketbot - INFO - For count: 2
2025-11-05 14:51:47.573435 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:51:47.573435 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:51:47.573435 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:51:47.635941 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:51:47.635941 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:51:48.651594 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:48.651594 - rocketbot - INFO - For count: 3
2025-11-05 14:51:48.651594 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:51:48.651594 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:51:48.651594 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:51:48.714097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:51:48.714097 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:51:49.716156 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:49.716156 - rocketbot - INFO - For count: 4
2025-11-05 14:51:49.716156 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:51:49.716156 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:51:49.716156 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:51:49.778664 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:51:49.778664 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:51:50.784709 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:50.784709 - rocketbot - INFO - For count: 5
2025-11-05 14:51:50.784709 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:51:50.784709 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:51:50.784709 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:51:50.847206 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:51:50.847206 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:51:51.847231 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:51:51.847231 - rocketbot - INFO - For count: 5
2025-11-05 14:51:51.847231 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:51:51.862867 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:51:51.862867 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:51:51.862867 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:51:51.862867 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:51:52.878512 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:51:53.066018 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:51:53.066018 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:51:54.066047 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:51:54.128551 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:51:54.144174 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:51:55.144200 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:51:55.222325 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:51:55.237955 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:51:55.237955 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:51:55.253581 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:51:55.253581 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:51:55.253581 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:58.255891 - rocketbot - INFO - For count: 0
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:58.255891 - rocketbot - INFO - For count: 1
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:58.255891 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:58.380894 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:58.380894 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:51:59.380932 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:51:59.380932 - rocketbot - INFO - For count: 2
2025-11-05 14:51:59.380932 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:51:59.380932 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:51:59.380932 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:51:59.568432 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:51:59.568432 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:52:00.568458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:52:00.568458 - rocketbot - INFO - For count: 3
2025-11-05 14:52:00.568458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:52:00.568458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:52:00.568458 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:52:00.681009 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:52:00.681009 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:52:01.688348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:52:01.688348 - rocketbot - INFO - For count: 4
2025-11-05 14:52:01.688348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:52:01.688348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:52:01.688348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:52:01.875859 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:52:01.875859 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:52:02.891509 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:52:02.891509 - rocketbot - INFO - For count: 4
2025-11-05 14:52:02.891509 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:52:02.891509 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:52:03.000887 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:52:04.007221 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:52:04.069724 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:52:05.070440 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:52:05.086068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:52:05.086068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:52:05.086068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:52:05.086068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:52:06.086105 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:52:06.273600 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:52:06.273600 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:52:07.289251 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:52:07.351749 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:52:07.351749 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:52:08.351786 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:52:08.429911 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:52:08.445536 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:52:08.445536 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:52:08.461158 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:52:08.461158 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:52:08.461158 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:52:11.475576 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:52:11.475576 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:52:11.491208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:52:11.491208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:52:11.491208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:52:11.491208 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:52:12.493605 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:52:12.681107 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:52:12.681107 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:52:13.681137 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:52:13.743637 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:52:13.743637 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:52:14.747585 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:52:14.825710 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:52:14.841345 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:52:14.841345 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:52:14.856964 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:52:14.872590 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:52:14.872590 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:52:14.872590 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:52:14.888220 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:52:14.888220 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:52:14.888220 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:52:14.888220 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:52:14.888220 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:52:14.903847 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:52:14.919478 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:52:14.919478 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:52:14.919478 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:52:14.919478 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:52:14.950718 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:52:14.950718 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:52:14.981977 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:52:14.981977 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:52:15.028852 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:52:15.044475 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:52:15.044475 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:52:15.044475 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:52:17.168465 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.3 - rpascripts : module  id: febe532a-d844-808e-d9fa-56e8ae6f729e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre el navegador."}
2025-11-05 14:52:17.173462 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.4 - rpaweb : waitforobject  id: 44e55dfb-486d-1e3a-2598-4411101be563 - xpath - {"object":"//a[contains(@class,\"navbar\") and (contains(text(),\"WorkManager\"))]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:17.208780 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.5 - rpalogic : evaluateIf  id: 80fc7905-39f5-f845-f984-01bd1e34ace2 -  - not {loc007EsperaObjeto}
2025-11-05 14:52:17.209787 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.6 - rpascripts : module  id: b0556c99-4b80-edd6-7811-f9367076e4c7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a maximizar la pagina."}
2025-11-05 14:52:17.214782 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.7 - rpaweb : maximize  id: 26325fd6-e765-670d-a1b6-ce22486c116c -  - 
2025-11-05 14:52:17.219782 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.8 - rpascripts : execscriptpython  id: f26fd7ac-90fc-053b-7209-9697ecafbdcd -  - global logger\n\nfrom VortexLibrary import logger\nimport win32com.client\nimport pygetwindow as gw\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task = tmp_global_obj["profile"]["name"]\n\n\ntab_name = "Iniciar sesión - Workmanager"\nlogger.info(f"Buscando ventana con título: {tab_name}")\nwindows = gw.getAllWindows()\nshell = win32com.client.Dispatch("WScript.Shell")\n\nfound = None\nfor w in windows:\n    logger.info(f"Ventana encontrada: '{w.title}'")\n    if tab_name.lower() in w.title.lower():\n        found = w\n        logger.info(f"Ventana con el título '{tab_name}' encontrada: '{w.title}'")\n        break\n\nif found:\n    hwnd = found._hWnd  # handle de la ventana\n    try:\n        import win32gui\n        import win32con\n        shell.SendKeys('%')  # truco: envía ALT para permitir SetForegroundWindow\n        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # restaura si está minimizada\n        win32gui.ShowWindow(hwnd, win32con.SW_MAXIMIZE)\n        win32gui.SetForegroundWindow(hwnd)\n        logger.info(f"Ventana '{found.title}' traída al frente y maximizada.")\n        print(f"Ventana '{found.title}' traída al frente y maximizada.")\n    except Exception as e:\n        logger.error(f"Error al traer la ventana al frente: {e}")\n        print(f"Error al traer la ventana al frente: {e}")\nelse:\n    logger.warning(f"No se encontró ninguna ventana con: {tab_name}")\n    print(f"No se encontró ninguna ventana con: {tab_name}")
2025-11-05 14:52:17.286282 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.9 - rpascripts : module  id: 680c8f2d-d561-4299-e736-401f7c20d9bf -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El navegador se cargo correctamente."}
2025-11-05 14:52:17.305761 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.10 - rpasystem : setVar  id: ae15e49d-9fd8-6ff7-6df5-bf9b6974e00e -  - True
2025-11-05 14:52:17.313538 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:52:17.314534 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.19 - - 009_IniciarSesionWorkManager
2025-11-05 14:52:17.331532 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1 - rpalogic : trycatch  id: 35bda62d-d144-b099-0a15-ce60351f67c4 -  - 
2025-11-05 14:52:17.332532 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.1 - rpasystem : setVar  id: 4f81a886-b606-c281-1646-91d8d910189c -  - False
2025-11-05 14:52:17.334533 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.2 - rpascripts : module  id: 9d3390f9-2a29-3869-fc00-e73603e01da8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Comienza el inicio de sesión de WorkManager."}
2025-11-05 14:52:17.339533 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.3 - rpaweb : waitforobject  id: b32df2ed-e697-246e-c465-0a05d6717a62 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:17.356534 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.4 - rpalogic : evaluateIf  id: f002c160-ce98-64b6-8b25-104473668ff8 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:52:17.357533 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.5 - rpascripts : module  id: 581b378d-a3ff-b8dd-d356-28f706834e5e -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:52:17.525084 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.6 - rpaweb : waitforobject  id: 49bf1bbd-8da4-905f-b356-5e5e263d6ee7 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:17.542080 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.7 - rpalogic : evaluateIf  id: 471f57c1-e45f-2a8a-2028-64e09fe8568f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:52:17.579480 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.8 - rpascripts : module  id: 7b948fff-3cd6-7d46-b70d-4709f3bcb71d -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:52:17.718757 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.9 - rpaweb : waitforobject  id: ed0c3962-cac0-6f2b-b35b-4d0eee4013a6 - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:17.740931 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.10 - rpalogic : evaluateIf  id: 25d1c4e5-054e-1e19-bb4d-708e525ade35 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:52:17.741931 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.11 - rpascripts : module  id: ac09fc73-207c-ddee-b1c7-1cb802d05c54 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:52:20.526596 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.12 - rpaweb : waitforobject  id: 38701775-1ecd-ed68-7ecc-af4a1472aac7 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:52:23.041841 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13 - rpalogic : evaluateIf  id: 1a3e7857-cf29-77d0-0182-ccbb232d80b3 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:52:23.042842 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.14 - rpascripts : module  id: 13093157-0084-3c31-205c-cd096c07f525 -  - {"module_name":"webpro","module":"clickPro","data":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:52:23.376225 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 008_ChequearWorkManagerAbierto
2025-11-05 14:52:23.393380 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1 - rpalogic : trycatch  id: 4f7a770b-1545-60cd-3c43-95398623e355 -  - 
2025-11-05 14:52:23.394382 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.1 - rpasystem : setVar  id: 0b359a66-be39-94e4-09cb-e29f94ba4d67 -  - False
2025-11-05 14:52:23.395382 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.2 - rpascripts : module  id: aca309de-d599-8d68-6ead-d81b7bd55602 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a chequear que la sesión este iniciada."}
2025-11-05 14:52:23.400384 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.3 - rpaweb : waitforobject  id: 5cae235a-a9a1-f6a2-8427-bb7eb365fc7f - xpath - {"object":"//a[contains(text(),\"{gblUsuarioPortal}\")]/img[contains(@class,\"img-circle\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4 - rpalogic : evaluateIf  id: 9b695608-21ad-0cc7-ffb7-91a8a4c13142 -  - not {loc008SesionIniciada}
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4.1 - rpascripts : module  id: ce9afa1f-f6bc-8277-2bd4-df01ac4f6915 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta iniciada la sesion."}
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.5 - rpasystem : setVar  id: 23b30aa9-fbe8-9feb-8921-f5d81c67f09b -  - True
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.16 - rpalogic : evaluateIf  id: 46ca9fb0-760a-4295-6abc-c06763c249bd -  - not {gblBandProceso}
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.17 - rpasystem : setVar  id: 1e53549c-3fd7-a083-9f16-a8c6d90dae2b -  - True
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.20 - rpalogic : evaluateIf  id: 52a1a6c0-653f-da29-293b-314c088a01ea -  - not {gblBandProceso}
2025-11-05 14:52:38.450439 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.21 - - 010_NavegarAdministrarProcesos
2025-11-05 14:52:38.481682 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1 - rpalogic : trycatch  id: 85425d0e-eb4f-61e4-986b-9e8531454f30 -  - 
2025-11-05 14:52:38.481682 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.1 - rpasystem : setVar  id: d1d8e02a-531b-cf34-fa6c-bc7ac48c60d9 -  - False
2025-11-05 14:52:38.481682 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.2 - rpaweb : waitforobject  id: 0a15fe3b-1de2-365c-e413-681ebf639a85 - xpath - {"object":"//a[contains(normalize-space(.),\"Configuración\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:38.497318 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.3 - rpalogic : evaluateIf  id: 2123abfd-648e-28da-2d33-adfd081e7cf2 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:52:38.497318 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.4 - rpaweb : click_web  id: 5eeac613-699c-8d0b-c281-eb3beacdf60f -  - {"data":"//a[contains(normalize-space(.),\"Configuración\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:52:38.658027 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.5 - rpaweb : waitforobject  id: b08141db-5839-afbe-970f-1552bb8868e1 - xpath - {"object":"//a[contains(normalize-space(.),\"Administrar procesos\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:38.676924 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.6 - rpalogic : evaluateIf  id: 4147830b-e888-2fef-4b82-9c2d418d613b -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:52:38.677920 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.7 - rpaweb : click_web  id: c48fffbe-4aec-3a0b-6676-18921deb189d -  - {"data":"//a[contains(normalize-space(.),\"Administrar procesos\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:52:39.419012 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.8 - rpaweb : waitforobject  id: cb0908ea-c510-b6b7-47ae-0caabd40d0cc - xpath - {"object":"//a[contains(normalize-space(.),\"Eliminar\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:39.439013 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.9 - rpalogic : evaluateIf  id: c6485db6-f831-39c5-ab7c-52c9b3f8d5a1 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:52:39.440012 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.10 - rpaweb : click_web  id: cf746297-1312-e8c0-c084-61331a7d37ba -  - {"data":"//a[contains(normalize-space(.),\"Eliminar\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:52:39.606241 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.11 - rpasystem : setVar  id: b8670c90-9ab0-4f7a-9da2-5365091450a1 -  - True
2025-11-05 14:52:39.620240 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.12 - rpascripts : module  id: e250e3b1-3482-b477-4300-99c82e80eceb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se navego correctamente a Administrar procesos"}
2025-11-05 14:52:39.628240 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.22 - rpalogic : evaluateIf  id: 6b234a06-af1f-be45-355a-dee764d2263d -  - not {gblBandProceso}
2025-11-05 14:52:39.629241 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.23 - - 011_BuscarPorNumeroDeProceso
2025-11-05 14:52:39.645240 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1 - rpalogic : trycatch  id: 5a94df60-327d-5d78-9c98-18d0ce4f8f41 -  - 
2025-11-05 14:52:39.647241 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.1 - rpasystem : setVar  id: 8c5a28ec-9a70-2c3e-cbfa-188945bc69d5 -  - False
2025-11-05 14:52:39.648240 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.2 - rpaweb : waitforobject  id: 25f879cc-311f-0e42-df39-6a934ccf9604 - xpath - {"object":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:39.667243 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.3 - rpalogic : evaluateIf  id: 169529d6-4d9a-d9f6-8179-2cac1d2c190d -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:52:39.668242 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.4 - rpascripts : module  id: 04e8740c-8465-903c-5dc7-cdc1086c58c5 -  - {"module_name":"webpro","module":"clickPro","data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","data_type":"xpath","wait":"15"}
2025-11-05 14:52:40.516355 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.5 - rpasystem : wait  id: a3d19044-6256-341c-297f-1385c518a2a5 -  - 1
2025-11-05 14:52:41.517634 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.6 - rpasystem : setVar  id: 31f679f2-b82d-a27d-36fd-71bd9a02cc72 -  - {gblItemActual}["Nro de Proceso"]
2025-11-05 14:52:41.518635 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.7 - rpascripts : module  id: 39fa7b61-a4ae-3ba8-b4ef-aa925223bace -  - {"module_name":"webpro","module":"CleanInputs","texto":"{loc011NroProceso}","search_data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","tipo":"xpath","sleep_":true}
2025-11-05 14:52:42.628990 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.8 - rpaweb : waitforobject  id: e5f17a30-98e8-26ac-9d64-0a5b3db7c58c - id - {"object":"buscarProcesoEliminarButton","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:42.645992 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.9 - rpalogic : evaluateIf  id: a02fe4c4-28b9-6c5d-ec8e-b526cfa1ed5e -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:52:42.646991 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.10 - rpascripts : module  id: 4038b1c5-ba84-527b-c6e8-8a7c9070b697 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"se pudo encontrar el botón para buscar proceso."}
2025-11-05 14:52:42.648993 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.11 - rpascripts : module  id: 856ce597-4f6e-6f79-0192-1d30fe3d996d -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"buscarProcesoEliminarButton\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:52:42.984230 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.12 - rpascripts : module  id: 1db9fab3-744a-b947-5cf6-16b3e236b1bf -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se da click en el boton que permitira buscar el proceso"}
2025-11-05 14:52:42.987229 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.13 - rpaweb : waitforobject  id: e5d3257a-f229-c7d9-1474-e98e269d29cb - xpath - {"object":"//p[contains(translate(normalize-space(.), \"ÁÉÍÓÚáéíóú\", \"AEIOUaeiou\"), \"No se encontro ningun proceso\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:52:43.519379 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14 - rpalogic : evaluateIf  id: a0ed021f-d5b8-65bf-829d-0bd083f8408f -  - {loc011EsperaDisponibilidad}
2025-11-05 14:52:43.520375 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14.1 - rpascripts : module  id: f4c836dd-8374-d04a-2bda-3aed02650967 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No hay resultados para la busqueda."}
2025-11-05 14:52:43.524377 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14.2 - rpasystem : setVar  id: 1d4f70c8-9160-db01-ceed-70cb30350c12 -  - False
2025-11-05 14:52:43.525377 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14.3 - rpasystem : setVar  id: 48119cd1-53ca-5a8e-c950-4f81cb3a6f60 -  - True
2025-11-05 14:52:43.526376 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14.4 - rpascripts : execscriptpython  id: a2461090-3ca7-46a1-aae7-da8aad7d7c2e -  - item = {gblItemActual}\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\n\nSetVar("gblItemActual", item)
2025-11-05 14:52:43.527377 - rocketbot - INFO - request: scripts : line 1.14.5 - rpascripts : stop - id: 21f40324-45e2-739d-d24a-bc4df768a440- - 
2025-11-05 14:52:43.529377 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24 - rpalogic : evaluateIf  id: 1967ed9c-96c0-554c-9092-351d68485942 -  - not {gblBandProceso}
2025-11-05 14:52:43.530377 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.25 - rpalogic : evaluateIf  id: 0d4ca8c8-77d8-489f-9f6a-c57f10f5379e -  - not {loc025BusquedaExitosa}
2025-11-05 14:52:43.531377 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.25.1 - rpascripts : execscriptpython  id: e5b6c6b9-59f5-c3d1-c1af-8520132bab4d -  - item = {gblItemActual}\n\nitem['Observaciones'] = "No se encontraron resultados de la busqueda por proceso."\n\nSetVar("gblItemActual",item)
2025-11-05 14:52:43.532378 - rocketbot - INFO - request: scripts : line 1.25.2 - rpascripts : stop - id: c7798ce1-438f-8e58-52e6-0e6d29066397- - 
2025-11-05 14:52:43.534377 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:52:43.535376 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 14:52:43.540377 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:52:43.556376 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:52:43.558377 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:52:43.559377 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:52:43.563378 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:52:45.403893 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:52:45.432022 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:52:45.436121 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:52:45.437128 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:52:45.445121 - rocketbot - INFO - For count: 16
2025-11-05 14:52:45.446121 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:52:45.461219 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:52:45.462221 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:52:45.463220 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:52:45.466220 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:52:45.470220 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:52:45.489325 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:52:45.490325 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:52:45.507421 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:52:45.508417 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:52:45.510419 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:52:45.526548 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:52:45.527547 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:52:45.528548 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:52:45.544650 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:52:45.545654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:52:45.546654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:52:45.550654 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:52:46.655976 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:52:46.663975 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:52:49.680358 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:52:50.195994 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:52:53.201977 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:52:53.514523 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:52:56.517242 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:52:56.532877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:52:56.532877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:52:56.532877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:52:56.532877 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:52:57.536528 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:52:57.724036 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:52:57.724036 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:52:58.724068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:52:58.786572 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:52:58.786572 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:52:59.786607 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:52:59.864729 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:52:59.864729 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:52:59.864729 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:52:59.864729 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:52:59.880359 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:52:59.911615 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:52:59.911615 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:52:59.911615 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:52:59.927244 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:52:59.927244 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:53:01.930623 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:53:01.930623 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:53:02.433734 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:53:02.808749 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:53:03.817605 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:53:03.926980 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:53:04.927018 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:53:05.427029 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:53:07.428863 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:53:07.444494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:53:07.444494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:53:07.444494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:53:07.444494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:53:08.460152 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:53:08.647658 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:53:08.757030 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:53:09.760170 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:53:09.822672 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:53:09.822672 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:53:10.824151 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:53:10.902270 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:53:10.902270 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:53:10.902270 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:53:10.902270 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:53:10.902270 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:53:10.933536 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:53:10.949146 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:53:10.949146 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:53:10.964775 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:11.980432 - rocketbot - INFO - For count: 0
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:11.980432 - rocketbot - INFO - For count: 1
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:53:11.980432 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:53:12.042935 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:53:12.042935 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:53:13.047452 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:13.047452 - rocketbot - INFO - For count: 2
2025-11-05 14:53:13.047452 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:53:13.047452 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:53:13.047452 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:53:13.109955 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:53:13.109955 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:53:14.116716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:14.116716 - rocketbot - INFO - For count: 3
2025-11-05 14:53:14.116716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:53:14.116716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:53:14.116716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:53:14.179223 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:53:14.179223 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:53:15.194876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:15.194876 - rocketbot - INFO - For count: 4
2025-11-05 14:53:15.194876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:53:15.194876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:53:15.194876 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:53:15.257386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:53:15.257386 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:53:16.273037 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:16.273037 - rocketbot - INFO - For count: 5
2025-11-05 14:53:16.273037 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:53:16.273037 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:53:16.273037 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:53:16.335544 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:53:16.335544 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:53:17.351198 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:53:17.351198 - rocketbot - INFO - For count: 5
2025-11-05 14:53:17.351198 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:53:17.366827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:53:17.366827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:53:17.366827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:53:17.366827 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:53:18.371752 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:53:18.590510 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:53:18.590510 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:53:19.590542 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:53:19.653045 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:53:19.653045 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:53:20.668699 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:53:20.746829 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:53:20.762460 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:53:20.762460 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:53:20.778076 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:53:20.778076 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:53:20.778076 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:23.778175 - rocketbot - INFO - For count: 0
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:23.778175 - rocketbot - INFO - For count: 1
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:53:23.778175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:53:23.903185 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:53:23.934431 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:53:24.948143 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:24.948143 - rocketbot - INFO - For count: 2
2025-11-05 14:53:24.948143 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:53:24.948143 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:53:24.948143 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:53:25.135645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:53:25.135645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:53:26.142411 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:26.142411 - rocketbot - INFO - For count: 3
2025-11-05 14:53:26.142411 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:53:26.142411 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:53:26.142411 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:53:26.267415 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:53:26.267415 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:53:27.267453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:27.267453 - rocketbot - INFO - For count: 4
2025-11-05 14:53:27.267453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:53:27.267453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:53:27.267453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:53:27.454954 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:53:27.454954 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:53:28.470608 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:53:28.470608 - rocketbot - INFO - For count: 4
2025-11-05 14:53:28.470608 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:53:28.470608 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:53:28.579987 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:53:29.595645 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:53:29.658147 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:53:30.658179 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:53:30.673809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:53:30.673809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:53:30.673809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:53:30.673809 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:53:31.675749 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:53:31.863252 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:53:31.863252 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:53:32.864570 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:53:32.927071 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:53:32.927071 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:53:33.927897 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:53:34.006022 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:53:34.021644 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:53:34.021644 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:53:34.037269 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:53:34.037269 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:53:37.038653 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:53:37.038653 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:53:37.054279 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:53:37.054279 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:53:37.054279 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:53:37.054279 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:53:38.060610 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:53:38.248110 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:53:38.248110 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:53:39.248343 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:53:39.310838 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:53:39.310838 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:53:40.310847 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:53:40.388969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:53:40.388969 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:53:40.388969 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:53:40.388969 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:53:40.404599 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:53:40.404599 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:53:40.404599 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:53:40.420223 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:53:40.420223 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:53:40.435854 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:53:40.435854 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:53:40.435854 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:53:40.435854 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:53:40.451474 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:53:40.451474 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:53:40.467099 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:53:40.467099 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:53:40.482729 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:53:40.482729 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:53:40.607723 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:53:40.623348 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:53:40.623348 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:53:40.638974 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:53:40.654600 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:53:40.654600 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:53:43.482743 - Rocketbot - ERROR - EXCEPTION IN (<string> Rocketbot, L_1246 ""): SessionNotCreatedException: Message: session not created: Chrome failed to start: crashed.\n  (session not created: DevToolsActivePort file doesn't exist)\n  (The process started from chrome location C:\Program Files\Google\Chrome\Application\chrome.exe is no longer running, so ChromeDriver is assuming that Chrome has crashed.)\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n	0x16358c3\n	0x1635904\n	0x144e76d\n	0x1484f91\n	0x147ff9a\n	0x14c8993\n	0x14c830a\n	0x14bc766\n	0x148dac0\n	0x148ede4\n	0x18b7974\n	0x18b2bea\n	0x165e5b4\n	0x164dd28\n	0x1654d8d\n	0x163ded8\n	0x163e09c\n	0x1627d1a\n	0x73d262c4\n	0x76f20989\n	0x76f20954\n
2025-11-05 14:53:43.685869 - script - ERROR - EXCEPTION IN (<string> script, L_187 ""): SessionNotCreatedException: Message: session not created: Chrome failed to start: crashed.\n  (session not created: DevToolsActivePort file doesn't exist)\n  (The process started from chrome location C:\Program Files\Google\Chrome\Application\chrome.exe is no longer running, so ChromeDriver is assuming that Chrome has crashed.)\nStacktrace:\nSymbols not available. Dumping unresolved backtrace:\n	0x16358c3\n	0x1635904\n	0x144e76d\n	0x1484f91\n	0x147ff9a\n	0x14c8993\n	0x14c830a\n	0x14bc766\n	0x148dac0\n	0x148ede4\n	0x18b7974\n	0x18b2bea\n	0x165e5b4\n	0x164dd28\n	0x1654d8d\n	0x163ded8\n	0x163e09c\n	0x1627d1a\n	0x73d262c4\n	0x76f20989\n	0x76f20954\n
2025-11-05 14:53:45.900317 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpascripts : module  id: 3a2a68df-58cd-b3ba-779b-c8f0cb76f738 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"error","text":"Ocurrio un error al abrir WorkManager."}
2025-11-05 14:53:45.900317 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:53:45.900317 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18.1 - rpascripts : execscriptpython  id: 2d0b5df0-adc4-8fbc-b748-9f25074fbead -  - item = {gblItemActual}\n\nitem['Observaciones'] = "Ocurrio un error al abrir Workmanager. Revisar archivo de logs."\n\nSetVar("gblItemActual",item)
2025-11-05 14:53:45.900317 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18.2 - rpascripts : module  id: df2287e5-10f3-fc99-a34b-e1bd260eb8bc -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Ocurrio un error al abrir Workmanager."}
2025-11-05 14:53:45.915943 - rocketbot - INFO - request: scripts : line 1.18.3 - rpascripts : stop - id: 5bca7bb1-cdb8-e5ca-eb69-824e4087e6c7- - 
2025-11-05 14:53:45.915943 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:53:45.915943 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 14:53:45.931573 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 14:53:45.947203 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 14:53:45.947203 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 14:53:45.962814 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 14:53:45.962814 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 14:53:45.962814 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 14:53:48.668478 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 14:53:48.668478 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 14:53:48.668478 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 14:53:48.668478 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:53:48.684104 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:53:48.684104 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:53:48.684104 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:53:48.699729 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:53:50.512241 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:53:50.543503 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:53:50.543503 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:53:50.543503 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:53:50.559130 - rocketbot - INFO - For count: 17
2025-11-05 14:53:50.559130 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:53:50.574749 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:53:50.574749 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:53:50.574749 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:53:50.574749 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:53:50.574749 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:53:50.590377 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:53:50.590377 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:53:50.621624 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:53:50.621624 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:53:50.621624 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:53:50.637243 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:53:50.637243 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:53:50.637243 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:53:50.652874 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:53:50.652874 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:53:50.652874 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:53:50.652874 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:53:51.777880 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:53:51.777880 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:53:54.793520 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:53:55.309149 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:53:58.315812 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:53:58.621500 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:54:01.651799 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:54:01.667430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:54:01.667430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:54:01.667430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:54:01.667430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:54:02.683057 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:54:02.870562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:54:02.870562 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:54:03.886194 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:54:03.948700 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:54:03.948700 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:54:04.964337 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:54:05.042459 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:54:05.042459 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:54:05.042459 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:54:05.042459 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:54:05.042459 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:54:05.073717 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:54:05.089338 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:54:05.089338 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:54:05.104969 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:54:05.104969 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:54:07.110385 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:54:07.110385 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:54:07.610392 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:54:07.985403 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:54:08.993327 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:54:09.102709 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:54:10.118342 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:54:10.618349 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:54:12.621554 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:54:12.637185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:54:12.637185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:54:12.637185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:54:12.637185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:54:13.638501 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:54:13.826029 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:54:13.826029 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:54:14.841662 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:54:14.904166 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:54:14.904166 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:54:15.919802 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:54:15.997935 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:54:15.997935 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:54:15.997935 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:54:15.997935 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:54:15.997935 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:54:16.029179 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:54:16.044803 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:54:16.044803 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:54:16.060430 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:17.066258 - rocketbot - INFO - For count: 0
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:17.066258 - rocketbot - INFO - For count: 1
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:54:17.066258 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:54:17.128760 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:54:17.128760 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:54:18.128777 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:18.128777 - rocketbot - INFO - For count: 2
2025-11-05 14:54:18.128777 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:54:18.128777 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:54:18.128777 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:54:18.191279 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:54:18.191279 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:54:19.206912 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:19.206912 - rocketbot - INFO - For count: 3
2025-11-05 14:54:19.206912 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:54:19.206912 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:54:19.206912 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:54:19.269409 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:54:19.269409 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:54:20.272261 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:20.272261 - rocketbot - INFO - For count: 4
2025-11-05 14:54:20.272261 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:54:20.272261 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:54:20.272261 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:54:20.334764 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:54:20.334764 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:54:21.335716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:21.335716 - rocketbot - INFO - For count: 5
2025-11-05 14:54:21.335716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:54:21.335716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:54:21.335716 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:54:21.398217 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:54:21.398217 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:54:22.398231 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:54:22.398231 - rocketbot - INFO - For count: 5
2025-11-05 14:54:22.398231 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:54:22.413855 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:54:22.413855 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:54:22.413855 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:54:22.413855 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:54:23.414552 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:54:23.633300 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:54:23.633300 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:54:24.648694 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:54:24.711217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:54:24.711217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:54:25.712265 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:54:25.790393 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:54:25.806018 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:54:25.806018 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:54:25.821643 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:54:25.821643 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:54:25.821643 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:28.826451 - rocketbot - INFO - For count: 0
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:28.826451 - rocketbot - INFO - For count: 1
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:54:28.826451 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:54:28.951453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:54:28.951453 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:54:29.951467 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:29.951467 - rocketbot - INFO - For count: 2
2025-11-05 14:54:29.951467 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:54:29.951467 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:54:29.967092 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:54:30.154598 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:54:30.154598 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:54:31.155379 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:31.155379 - rocketbot - INFO - For count: 3
2025-11-05 14:54:31.155379 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:54:31.155379 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:54:31.155379 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:54:31.280383 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:54:31.280383 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:54:32.296019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:32.296019 - rocketbot - INFO - For count: 4
2025-11-05 14:54:32.296019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:54:32.296019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:54:32.296019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:54:32.483522 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:54:32.483522 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:54:33.499160 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:54:33.499160 - rocketbot - INFO - For count: 4
2025-11-05 14:54:33.499160 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:54:33.499160 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:54:33.608537 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:54:34.624175 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:54:34.686678 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:54:35.702315 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:54:35.717950 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:54:35.717950 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:54:35.717950 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:54:35.717950 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:54:36.733579 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:54:36.921416 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:54:36.921416 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:54:37.921430 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:54:37.983931 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:54:37.983931 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:54:38.997219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:54:39.075337 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:54:39.075337 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:54:39.075337 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:54:39.090968 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:54:39.090968 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:54:39.090968 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:54:39.090968 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:54:39.106589 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:54:39.106589 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:54:39.106589 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:54:39.106589 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:54:42.108479 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:54:42.108479 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:54:42.124102 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:54:42.124102 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:54:42.124102 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:54:42.124102 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:54:43.133399 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:54:43.320902 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:54:43.320902 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:54:44.320915 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:54:44.384091 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:54:44.384091 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:54:45.399055 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:54:45.477173 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:54:45.477173 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:54:45.477173 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:54:45.477173 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:54:45.492803 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:54:45.492803 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:54:45.492803 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:54:45.508432 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:54:45.508432 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:54:45.524054 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:54:45.524054 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:54:45.524054 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:54:45.524054 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:54:45.539678 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:54:45.539678 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:54:45.602178 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:54:45.602178 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:54:45.633428 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:54:45.633428 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:54:45.664679 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:54:45.664679 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:54:45.664679 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:54:45.680302 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:54:45.680302 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:54:45.680302 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:54:47.836942 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.3 - rpascripts : module  id: febe532a-d844-808e-d9fa-56e8ae6f729e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre el navegador."}
2025-11-05 14:54:47.841844 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.4 - rpaweb : waitforobject  id: 44e55dfb-486d-1e3a-2598-4411101be563 - xpath - {"object":"//a[contains(@class,\"navbar\") and (contains(text(),\"WorkManager\"))]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:54:47.863395 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.5 - rpalogic : evaluateIf  id: 80fc7905-39f5-f845-f984-01bd1e34ace2 -  - not {loc007EsperaObjeto}
2025-11-05 14:54:47.864394 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.6 - rpascripts : module  id: b0556c99-4b80-edd6-7811-f9367076e4c7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a maximizar la pagina."}
2025-11-05 14:54:47.868393 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.7 - rpaweb : maximize  id: 26325fd6-e765-670d-a1b6-ce22486c116c -  - 
2025-11-05 14:54:47.911293 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.8 - rpascripts : execscriptpython  id: f26fd7ac-90fc-053b-7209-9697ecafbdcd -  - global logger\n\nfrom VortexLibrary import logger\nimport win32com.client\nimport pygetwindow as gw\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task = tmp_global_obj["profile"]["name"]\n\n\ntab_name = "Iniciar sesión - Workmanager"\nlogger.info(f"Buscando ventana con título: {tab_name}")\nwindows = gw.getAllWindows()\nshell = win32com.client.Dispatch("WScript.Shell")\n\nfound = None\nfor w in windows:\n    logger.info(f"Ventana encontrada: '{w.title}'")\n    if tab_name.lower() in w.title.lower():\n        found = w\n        logger.info(f"Ventana con el título '{tab_name}' encontrada: '{w.title}'")\n        break\n\nif found:\n    hwnd = found._hWnd  # handle de la ventana\n    try:\n        import win32gui\n        import win32con\n        shell.SendKeys('%')  # truco: envía ALT para permitir SetForegroundWindow\n        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # restaura si está minimizada\n        win32gui.ShowWindow(hwnd, win32con.SW_MAXIMIZE)\n        win32gui.SetForegroundWindow(hwnd)\n        logger.info(f"Ventana '{found.title}' traída al frente y maximizada.")\n        print(f"Ventana '{found.title}' traída al frente y maximizada.")\n    except Exception as e:\n        logger.error(f"Error al traer la ventana al frente: {e}")\n        print(f"Error al traer la ventana al frente: {e}")\nelse:\n    logger.warning(f"No se encontró ninguna ventana con: {tab_name}")\n    print(f"No se encontró ninguna ventana con: {tab_name}")
2025-11-05 14:54:47.980145 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.9 - rpascripts : module  id: 680c8f2d-d561-4299-e736-401f7c20d9bf -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El navegador se cargo correctamente."}
2025-11-05 14:54:48.003524 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.10 - rpasystem : setVar  id: ae15e49d-9fd8-6ff7-6df5-bf9b6974e00e -  - True
2025-11-05 14:54:48.003524 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:54:48.003524 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.19 - - 009_IniciarSesionWorkManager
2025-11-05 14:54:48.027332 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1 - rpalogic : trycatch  id: 35bda62d-d144-b099-0a15-ce60351f67c4 -  - 
2025-11-05 14:54:48.028331 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.1 - rpasystem : setVar  id: 4f81a886-b606-c281-1646-91d8d910189c -  - False
2025-11-05 14:54:48.044330 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.2 - rpascripts : module  id: 9d3390f9-2a29-3869-fc00-e73603e01da8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Comienza el inicio de sesión de WorkManager."}
2025-11-05 14:54:48.049330 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.3 - rpaweb : waitforobject  id: b32df2ed-e697-246e-c465-0a05d6717a62 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:54:48.068398 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.4 - rpalogic : evaluateIf  id: f002c160-ce98-64b6-8b25-104473668ff8 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:54:48.069397 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.5 - rpascripts : module  id: 581b378d-a3ff-b8dd-d356-28f706834e5e -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:54:48.231305 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.6 - rpaweb : waitforobject  id: 49bf1bbd-8da4-905f-b356-5e5e263d6ee7 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:54:48.249108 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.7 - rpalogic : evaluateIf  id: 471f57c1-e45f-2a8a-2028-64e09fe8568f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:54:48.250107 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.8 - rpascripts : module  id: 7b948fff-3cd6-7d46-b70d-4709f3bcb71d -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:54:48.385622 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.9 - rpaweb : waitforobject  id: ed0c3962-cac0-6f2b-b35b-4d0eee4013a6 - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:54:48.426547 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.10 - rpalogic : evaluateIf  id: 25d1c4e5-054e-1e19-bb4d-708e525ade35 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:54:48.427556 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.11 - rpascripts : module  id: ac09fc73-207c-ddee-b1c7-1cb802d05c54 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:54:50.829758 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.12 - rpaweb : waitforobject  id: 38701775-1ecd-ed68-7ecc-af4a1472aac7 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:55:08.040377 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13 - rpalogic : evaluateIf  id: 1a3e7857-cf29-77d0-0182-ccbb232d80b3 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:08.040377 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.1 - rpascripts : module  id: 08c38f05-e48f-c218-3f46-4d5f1934b78d -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta disponible el botón para elegir la EMPRESA."}
2025-11-05 14:55:08.040377 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.2 - rpascripts : module  id: 1fe28bd8-c2ae-46ca-a881-12bb156ceeec -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a ver si se puede recuperar del error,"}
2025-11-05 14:55:08.056014 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.3 - rpaweb : waitforobject  id: eca118db-f03e-e34f-4542-301a4a46131f - xpath - {"object":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","wait_time":"5","wait_for":"present","before":"","after":""}
2025-11-05 14:55:08.071617 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.4 - rpalogic : evaluateIf  id: 27f9b5d3-5cee-aebd-8da3-c7bb6f7a083f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:08.071617 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.5 - rpascripts : module  id: 6ee31825-8388-4519-fb69-a71cf00a7d39 -  - {"module_name":"webpro","module":"getText","data":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","data_type":"xpath","wait":"5","result":"loc009TextoError"}
2025-11-05 14:55:08.165378 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.6 - rpascripts : module  id: be84962b-9b7f-c8e2-99fc-85147f678d90 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Texto de error: {loc009TextoError}"}
2025-11-05 14:55:08.165378 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7 - rpalogic : evaluateIf  id: 917bd2d8-1cc4-7c56-be99-fde54790df73 -  - "tiene una sesión abierta" in "{loc009TextoError}"
2025-11-05 14:55:08.165378 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.1 - rpaweb : waitforobject  id: 364e3aab-7c8c-5a11-49a5-67a1ce2b3719 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:08.180999 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.2 - rpalogic : evaluateIf  id: 8e8592e5-00a4-768d-0dd5-ca9a41d9a5cf -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:08.180999 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.3 - rpascripts : module  id: 06ab2e6a-c9f3-891c-541c-2d4a20189fa3 -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:55:08.325194 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.4 - rpaweb : waitforobject  id: e84e10d1-caff-9537-051c-554673a523f1 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:08.336145 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.5 - rpalogic : evaluateIf  id: 161c812b-6428-476a-8be4-79a08497b880 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:08.337144 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.6 - rpascripts : module  id: 18d32ff9-755a-ca68-a819-3a79d47e7f1a -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:55:08.473677 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.7 - rpaweb : waitforobject  id: 1fbe7191-4d48-7348-c63c-fe17ed1b702b - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:08.488482 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.8 - rpalogic : evaluateIf  id: 19d8f8c4-e003-622d-e9b8-655e4fba4864 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:08.489478 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.9 - rpascripts : module  id: 0c165a1d-0434-b861-6b63-1bf2b0a2c0f5 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:55:08.865529 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.10 - rpaweb : waitforobject  id: 75bf25e2-987c-d090-ef8a-99bf89b133e2 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:55:11.616334 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.11 - rpalogic : evaluateIf  id: df131682-a304-6cc9-37c4-8e230e1d77ec -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:55:11.618336 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.14 - rpascripts : module  id: 13093157-0084-3c31-205c-cd096c07f525 -  - {"module_name":"webpro","module":"clickPro","data":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:55:11.960444 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 008_ChequearWorkManagerAbierto
2025-11-05 14:55:11.977606 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1 - rpalogic : trycatch  id: 4f7a770b-1545-60cd-3c43-95398623e355 -  - 
2025-11-05 14:55:11.978606 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.1 - rpasystem : setVar  id: 0b359a66-be39-94e4-09cb-e29f94ba4d67 -  - False
2025-11-05 14:55:11.979606 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.2 - rpascripts : module  id: aca309de-d599-8d68-6ead-d81b7bd55602 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a chequear que la sesión este iniciada."}
2025-11-05 14:55:11.983606 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.3 - rpaweb : waitforobject  id: 5cae235a-a9a1-f6a2-8427-bb7eb365fc7f - xpath - {"object":"//a[contains(text(),\"{gblUsuarioPortal}\")]/img[contains(@class,\"img-circle\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4 - rpalogic : evaluateIf  id: 9b695608-21ad-0cc7-ffb7-91a8a4c13142 -  - not {loc008SesionIniciada}
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4.1 - rpascripts : module  id: ce9afa1f-f6bc-8277-2bd4-df01ac4f6915 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta iniciada la sesion."}
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.5 - rpasystem : setVar  id: 23b30aa9-fbe8-9feb-8921-f5d81c67f09b -  - True
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.16 - rpalogic : evaluateIf  id: 46ca9fb0-760a-4295-6abc-c06763c249bd -  - not {gblBandProceso}
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.17 - rpasystem : setVar  id: 1e53549c-3fd7-a083-9f16-a8c6d90dae2b -  - True
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.20 - rpalogic : evaluateIf  id: 52a1a6c0-653f-da29-293b-314c088a01ea -  - not {gblBandProceso}
2025-11-05 14:55:27.276099 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.21 - - 010_NavegarAdministrarProcesos
2025-11-05 14:55:27.307359 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1 - rpalogic : trycatch  id: 85425d0e-eb4f-61e4-986b-9e8531454f30 -  - 
2025-11-05 14:55:27.307359 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.1 - rpasystem : setVar  id: d1d8e02a-531b-cf34-fa6c-bc7ac48c60d9 -  - False
2025-11-05 14:55:27.307359 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.2 - rpaweb : waitforobject  id: 0a15fe3b-1de2-365c-e413-681ebf639a85 - xpath - {"object":"//a[contains(normalize-space(.),\"Configuración\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:27.322976 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.3 - rpalogic : evaluateIf  id: 2123abfd-648e-28da-2d33-adfd081e7cf2 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:55:27.322976 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.4 - rpaweb : click_web  id: 5eeac613-699c-8d0b-c281-eb3beacdf60f -  - {"data":"//a[contains(normalize-space(.),\"Configuración\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:55:27.485871 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.5 - rpaweb : waitforobject  id: b08141db-5839-afbe-970f-1552bb8868e1 - xpath - {"object":"//a[contains(normalize-space(.),\"Administrar procesos\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:27.503869 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.6 - rpalogic : evaluateIf  id: 4147830b-e888-2fef-4b82-9c2d418d613b -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:55:27.505869 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.7 - rpaweb : click_web  id: c48fffbe-4aec-3a0b-6676-18921deb189d -  - {"data":"//a[contains(normalize-space(.),\"Administrar procesos\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:55:28.714691 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.8 - rpaweb : waitforobject  id: cb0908ea-c510-b6b7-47ae-0caabd40d0cc - xpath - {"object":"//a[contains(normalize-space(.),\"Eliminar\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:28.733692 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.9 - rpalogic : evaluateIf  id: c6485db6-f831-39c5-ab7c-52c9b3f8d5a1 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:55:28.734689 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.10 - rpaweb : click_web  id: cf746297-1312-e8c0-c084-61331a7d37ba -  - {"data":"//a[contains(normalize-space(.),\"Eliminar\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:55:28.876028 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.11 - rpasystem : setVar  id: b8670c90-9ab0-4f7a-9da2-5365091450a1 -  - True
2025-11-05 14:55:28.882027 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.12 - rpascripts : module  id: e250e3b1-3482-b477-4300-99c82e80eceb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se navego correctamente a Administrar procesos"}
2025-11-05 14:55:28.898028 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.22 - rpalogic : evaluateIf  id: 6b234a06-af1f-be45-355a-dee764d2263d -  - not {gblBandProceso}
2025-11-05 14:55:28.900028 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.23 - - 011_BuscarPorNumeroDeProceso
2025-11-05 14:55:28.922028 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1 - rpalogic : trycatch  id: 5a94df60-327d-5d78-9c98-18d0ce4f8f41 -  - 
2025-11-05 14:55:28.923028 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.1 - rpasystem : setVar  id: 8c5a28ec-9a70-2c3e-cbfa-188945bc69d5 -  - False
2025-11-05 14:55:28.924029 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.2 - rpaweb : waitforobject  id: 25f879cc-311f-0e42-df39-6a934ccf9604 - xpath - {"object":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:28.943028 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.3 - rpalogic : evaluateIf  id: 169529d6-4d9a-d9f6-8179-2cac1d2c190d -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:55:28.944028 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.4 - rpascripts : module  id: 04e8740c-8465-903c-5dc7-cdc1086c58c5 -  - {"module_name":"webpro","module":"clickPro","data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","data_type":"xpath","wait":"15"}
2025-11-05 14:55:29.793733 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.5 - rpasystem : wait  id: a3d19044-6256-341c-297f-1385c518a2a5 -  - 1
2025-11-05 14:55:30.794969 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.6 - rpasystem : setVar  id: 31f679f2-b82d-a27d-36fd-71bd9a02cc72 -  - {gblItemActual}["Nro de Proceso"]
2025-11-05 14:55:30.795969 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.7 - rpascripts : module  id: 39fa7b61-a4ae-3ba8-b4ef-aa925223bace -  - {"module_name":"webpro","module":"CleanInputs","texto":"{loc011NroProceso}","search_data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","tipo":"xpath","sleep_":true}
2025-11-05 14:55:31.894118 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.8 - rpaweb : waitforobject  id: e5f17a30-98e8-26ac-9d64-0a5b3db7c58c - id - {"object":"buscarProcesoEliminarButton","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:31.911118 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.9 - rpalogic : evaluateIf  id: a02fe4c4-28b9-6c5d-ec8e-b526cfa1ed5e -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:55:31.912117 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.10 - rpascripts : module  id: 4038b1c5-ba84-527b-c6e8-8a7c9070b697 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"se pudo encontrar el botón para buscar proceso."}
2025-11-05 14:55:31.914117 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.11 - rpascripts : module  id: 856ce597-4f6e-6f79-0192-1d30fe3d996d -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"buscarProcesoEliminarButton\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:55:32.256785 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.12 - rpascripts : module  id: 1db9fab3-744a-b947-5cf6-16b3e236b1bf -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se da click en el boton que permitira buscar el proceso"}
2025-11-05 14:55:32.289786 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.13 - rpaweb : waitforobject  id: e5d3257a-f229-c7d9-1474-e98e269d29cb - xpath - {"object":"//p[contains(translate(normalize-space(.), \"ÁÉÍÓÚáéíóú\", \"AEIOUaeiou\"), \"No se encontro ningun proceso\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:32.294789 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14 - rpalogic : evaluateIf  id: a0ed021f-d5b8-65bf-829d-0bd083f8408f -  - {loc011EsperaDisponibilidad}
2025-11-05 14:55:32.295788 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.15 - rpascripts : module  id: e723de89-60b5-0b64-0047-86c5e07e2751 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se encontraron registros con el numero de proceso buscado"}
2025-11-05 14:55:32.309790 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.16 - rpaweb : waitforobject  id: 94abd698-ab3d-3092-ef06-7a0e783ea9d5 - xpath - {"object":"//table[contains(@class, 'table-bordered')]/tbody/tr[last()]/td/a","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:55:47.587047 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17 - rpalogic : evaluateIf  id: e3deceb0-55f6-7640-6a4f-df4bff517f23 -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:55:47.587047 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17.1 - rpascripts : module  id: 9f4b888b-deb8-4f33-ac6d-cfb5231c9656 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No se pudo encontrar el ultimo elemento de la tabla."}
2025-11-05 14:55:47.587047 - rocketbot - INFO - request: scripts : line 1.17.2 - rpascripts : stop - id: 3147aa2a-586a-43c4-28d4-215ccef7a1c0- - 
2025-11-05 14:55:47.587047 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24 - rpalogic : evaluateIf  id: 1967ed9c-96c0-554c-9092-351d68485942 -  - not {gblBandProceso}
2025-11-05 14:55:47.587047 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.1 - rpascripts : module  id: f5315364-0702-c1fe-f169-a4a381e52a41 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Ocurrio un error al buscar a el documento."}
2025-11-05 14:55:47.602674 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.2 - rpascripts : execscriptpython  id: f3846b4a-a1bd-08cd-8209-63a4592ab0bd -  - item = {gblItemActual}\n\nitem['Observaciones'] = "Ocurrio un error al buscar el proceso en Workmanager o no se encontraron resultados de la busqueda. Revisar archivo de logs."\n\nSetVar("gblItemActual",item)
2025-11-05 14:55:47.602674 - rocketbot - INFO - request: scripts : line 1.24.3 - rpascripts : stop - id: e632b3c5-c4c6-e4d4-9be5-49bd0acfcc85- - 
2025-11-05 14:55:47.602674 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:55:47.602674 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 14:55:47.631507 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 14:55:47.647505 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 14:55:47.648511 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 14:55:47.649506 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 14:55:47.652651 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 14:55:47.676647 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 14:55:50.354404 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 14:55:50.354404 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 14:55:50.354404 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 14:55:50.354404 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:55:50.370034 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:55:50.370034 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:55:50.370034 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:55:50.385656 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:55:52.104427 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:55:52.135688 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:55:52.135688 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:55:52.135688 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:55:52.151314 - rocketbot - INFO - For count: 18
2025-11-05 14:55:52.151314 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:55:52.166936 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:55:52.166936 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:55:52.166936 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:55:52.166936 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:55:52.166936 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:55:52.198183 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:55:52.198183 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:55:52.213814 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:55:52.213814 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:55:52.213814 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:55:52.229444 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:55:52.229444 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:55:52.229444 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:55:52.245058 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:55:52.245058 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:55:52.245058 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:55:52.245058 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:55:53.399576 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:55:53.399576 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:55:56.399663 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:55:56.899670 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:55:59.905709 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:56:00.218217 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:56:03.219216 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:56:03.234843 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:56:03.234843 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:56:03.234843 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:56:03.234843 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:56:04.247575 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:56:04.435080 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:56:04.435080 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:56:05.450716 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:56:05.513217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:56:05.513217 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:56:06.520051 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:56:06.598175 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:56:06.598175 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:56:06.598175 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:56:06.598175 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:56:06.598175 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13.1 - rpascripts : module  id: 146e1044-5c18-3a93-5642-8634a0cc7495 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No se pudo validar la pantalla de Login."}
2025-11-05 14:56:06.645054 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13.2 - rpasystem : setVar  id: 14b64318-085d-968e-b718-6a0c77d38766 -  - False
2025-11-05 14:56:06.645054 - rocketbot - INFO - request: scripts : line 1.13.3 - rpascripts : stop - id: 61b96818-9768-c731-d0c5-f3618fea41ac- - 
2025-11-05 14:56:06.645054 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:56:06.645054 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3.1 - rpascripts : module  id: e2c93419-3938-a50e-d8bd-2ed7a8fec8f3 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No fue posible abrir Siesa 8.5 para continuar con el proceso"}
2025-11-05 14:56:06.660687 - rocketbot - INFO - request: scripts : line 1.3.2 - rpascripts : stop - id: 6a55b210-c4e6-2483-6f09-e244bf7d82bc- - 
2025-11-05 14:56:06.660687 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:56:06.660687 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 14:56:06.676307 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 14:56:06.691930 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 14:56:06.691930 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 14:56:06.691930 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 14:56:06.691930 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 14:56:06.707555 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 14:56:16.899254 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 14:56:16.899254 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 14:56:16.899254 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 14:56:16.899254 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:56:16.914882 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:56:16.914882 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:56:16.914882 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:56:16.930499 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:56:18.774285 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:56:18.805539 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:56:18.805539 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:56:18.805539 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:56:18.821163 - rocketbot - INFO - For count: 19
2025-11-05 14:56:18.821163 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:56:18.836789 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:56:18.836789 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:56:18.836789 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:56:18.836789 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:56:18.852412 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:56:18.868048 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:56:18.868048 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:56:18.883669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:56:18.883669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:56:18.883669 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:56:18.899290 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:56:18.899290 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:56:18.899290 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:56:18.914915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:56:18.914915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:56:18.914915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:56:18.930540 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:56:20.039932 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:56:20.039932 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:56:23.050231 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:56:23.550246 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:56:26.564297 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:56:26.876796 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:56:29.898620 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:56:29.914256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:56:29.914256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:56:29.914256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:56:29.914256 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:56:30.916120 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:56:31.103623 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:56:31.103623 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:56:32.103643 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:56:32.166145 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:56:32.166145 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:56:33.181791 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:56:33.259915 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:56:33.259915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:56:33.259915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:56:33.259915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:56:33.259915 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:56:33.291169 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:56:33.306795 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:56:33.306795 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:56:33.322425 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:56:33.322425 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:56:35.338082 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:56:35.338082 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:56:35.838092 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:56:36.213105 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:56:37.216276 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:56:37.325653 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:56:38.325672 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:56:38.825685 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:56:40.827936 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:56:40.843568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:56:40.843568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:56:40.843568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:56:40.843568 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:56:41.859212 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:56:42.046710 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:56:42.046710 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:56:43.046730 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:56:43.109231 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:56:43.109231 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:56:44.109252 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:56:44.187381 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:56:44.187381 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:56:44.187381 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:56:44.281135 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:56:44.281135 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:56:44.312389 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:56:44.312389 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:56:44.312389 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:56:44.328012 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:56:44.328012 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:56:44.343637 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:56:44.343637 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:56:44.343637 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:56:44.343637 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:45.359276 - rocketbot - INFO - For count: 0
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:45.359276 - rocketbot - INFO - For count: 1
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:56:45.359276 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:56:45.421783 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:56:45.421783 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:56:46.437423 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:46.437423 - rocketbot - INFO - For count: 2
2025-11-05 14:56:46.437423 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:56:46.437423 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:56:46.437423 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:56:46.499929 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:56:46.499929 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:56:47.515569 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:47.515569 - rocketbot - INFO - For count: 3
2025-11-05 14:56:47.515569 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:56:47.515569 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:56:47.515569 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:56:47.578069 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:56:47.578069 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:56:48.579493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:48.579493 - rocketbot - INFO - For count: 4
2025-11-05 14:56:48.579493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:56:48.579493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:56:48.579493 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:56:48.641996 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:56:48.641996 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:56:49.657639 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:49.657639 - rocketbot - INFO - For count: 5
2025-11-05 14:56:49.657639 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:56:49.657639 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:56:49.657639 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:56:49.720140 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:56:49.751391 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:56:50.767036 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:56:50.767036 - rocketbot - INFO - For count: 5
2025-11-05 14:56:50.767036 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:56:50.782666 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:56:50.782666 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:56:50.782666 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:56:50.782666 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:56:51.784219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:56:51.971724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:56:51.971724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:56:52.972061 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:56:53.034563 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:56:53.034563 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:56:54.036628 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:56:54.114756 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:56:54.114756 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:56:54.114756 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:56:54.114756 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:56:54.130385 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:56:54.130385 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:56:54.130385 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:56:54.146002 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:56:54.146002 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:56:54.146002 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:56:54.146002 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:56:54.146002 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:56:57.148942 - rocketbot - INFO - For count: 0
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:56:57.148942 - rocketbot - INFO - For count: 1
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:56:57.148942 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:56:57.273945 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:56:57.273945 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:56:58.273970 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:56:58.273970 - rocketbot - INFO - For count: 2
2025-11-05 14:56:58.273970 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:56:58.273970 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:56:58.273970 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:56:58.461474 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:56:58.461474 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:56:59.472293 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:56:59.472293 - rocketbot - INFO - For count: 3
2025-11-05 14:56:59.472293 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:56:59.472293 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:56:59.472293 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:56:59.597299 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:56:59.612922 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:57:00.612941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:57:00.612941 - rocketbot - INFO - For count: 4
2025-11-05 14:57:00.612941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:57:00.612941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:57:00.612941 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:57:00.800444 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:57:00.800444 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:57:01.800464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:57:01.800464 - rocketbot - INFO - For count: 4
2025-11-05 14:57:01.800464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:57:01.800464 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:57:01.909848 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:57:02.925491 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:57:02.987988 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:57:03.988008 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:57:04.003636 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:57:04.003636 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:57:04.003636 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:57:04.003636 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:57:05.006597 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:57:05.209726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:57:05.209726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:57:06.225370 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:57:06.287875 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:57:06.287875 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:57:07.303700 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:57:07.381647 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:57:07.397271 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:57:07.397271 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:57:07.412899 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:57:07.412899 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:57:10.412958 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:57:10.412958 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:57:10.428774 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:57:10.428774 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:57:10.428774 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:57:10.428774 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:57:11.436489 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:57:11.623991 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:57:11.623991 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:57:12.624011 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:57:12.686519 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:57:12.686519 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:57:13.688769 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:57:13.766895 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:57:13.766895 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:57:13.766895 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:57:13.766895 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:57:13.782522 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:57:13.782522 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:57:13.782522 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:57:13.798159 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:57:13.798159 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:57:13.813772 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:57:13.813772 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:57:13.813772 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:57:13.813772 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:57:13.829403 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:57:13.829403 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:57:13.845021 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:57:13.845021 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:57:13.876276 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:57:13.876276 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:57:13.923147 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:57:13.923147 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:57:13.954400 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:57:13.970035 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:57:13.970035 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:57:13.970035 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:57:16.108357 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.3 - rpascripts : module  id: febe532a-d844-808e-d9fa-56e8ae6f729e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre el navegador."}
2025-11-05 14:57:16.114012 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.4 - rpaweb : waitforobject  id: 44e55dfb-486d-1e3a-2598-4411101be563 - xpath - {"object":"//a[contains(@class,\"navbar\") and (contains(text(),\"WorkManager\"))]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:16.135607 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.5 - rpalogic : evaluateIf  id: 80fc7905-39f5-f845-f984-01bd1e34ace2 -  - not {loc007EsperaObjeto}
2025-11-05 14:57:16.136554 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.6 - rpascripts : module  id: b0556c99-4b80-edd6-7811-f9367076e4c7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a maximizar la pagina."}
2025-11-05 14:57:16.140494 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.7 - rpaweb : maximize  id: 26325fd6-e765-670d-a1b6-ce22486c116c -  - 
2025-11-05 14:57:16.146908 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.8 - rpascripts : execscriptpython  id: f26fd7ac-90fc-053b-7209-9697ecafbdcd -  - global logger\n\nfrom VortexLibrary import logger\nimport win32com.client\nimport pygetwindow as gw\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task = tmp_global_obj["profile"]["name"]\n\n\ntab_name = "Iniciar sesión - Workmanager"\nlogger.info(f"Buscando ventana con título: {tab_name}")\nwindows = gw.getAllWindows()\nshell = win32com.client.Dispatch("WScript.Shell")\n\nfound = None\nfor w in windows:\n    logger.info(f"Ventana encontrada: '{w.title}'")\n    if tab_name.lower() in w.title.lower():\n        found = w\n        logger.info(f"Ventana con el título '{tab_name}' encontrada: '{w.title}'")\n        break\n\nif found:\n    hwnd = found._hWnd  # handle de la ventana\n    try:\n        import win32gui\n        import win32con\n        shell.SendKeys('%')  # truco: envía ALT para permitir SetForegroundWindow\n        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # restaura si está minimizada\n        win32gui.ShowWindow(hwnd, win32con.SW_MAXIMIZE)\n        win32gui.SetForegroundWindow(hwnd)\n        logger.info(f"Ventana '{found.title}' traída al frente y maximizada.")\n        print(f"Ventana '{found.title}' traída al frente y maximizada.")\n    except Exception as e:\n        logger.error(f"Error al traer la ventana al frente: {e}")\n        print(f"Error al traer la ventana al frente: {e}")\nelse:\n    logger.warning(f"No se encontró ninguna ventana con: {tab_name}")\n    print(f"No se encontró ninguna ventana con: {tab_name}")
2025-11-05 14:57:16.213130 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.9 - rpascripts : module  id: 680c8f2d-d561-4299-e736-401f7c20d9bf -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El navegador se cargo correctamente."}
2025-11-05 14:57:16.234609 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.10 - rpasystem : setVar  id: ae15e49d-9fd8-6ff7-6df5-bf9b6974e00e -  - True
2025-11-05 14:57:16.239058 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:57:16.240057 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.19 - - 009_IniciarSesionWorkManager
2025-11-05 14:57:16.257063 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1 - rpalogic : trycatch  id: 35bda62d-d144-b099-0a15-ce60351f67c4 -  - 
2025-11-05 14:57:16.258064 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.1 - rpasystem : setVar  id: 4f81a886-b606-c281-1646-91d8d910189c -  - False
2025-11-05 14:57:16.259065 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.2 - rpascripts : module  id: 9d3390f9-2a29-3869-fc00-e73603e01da8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Comienza el inicio de sesión de WorkManager."}
2025-11-05 14:57:16.264064 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.3 - rpaweb : waitforobject  id: b32df2ed-e697-246e-c465-0a05d6717a62 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:16.282989 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.4 - rpalogic : evaluateIf  id: f002c160-ce98-64b6-8b25-104473668ff8 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:16.283989 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.5 - rpascripts : module  id: 581b378d-a3ff-b8dd-d356-28f706834e5e -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:57:16.447302 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.6 - rpaweb : waitforobject  id: 49bf1bbd-8da4-905f-b356-5e5e263d6ee7 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:16.464042 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.7 - rpalogic : evaluateIf  id: 471f57c1-e45f-2a8a-2028-64e09fe8568f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:16.465042 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.8 - rpascripts : module  id: 7b948fff-3cd6-7d46-b70d-4709f3bcb71d -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:57:16.606022 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.9 - rpaweb : waitforobject  id: ed0c3962-cac0-6f2b-b35b-4d0eee4013a6 - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:16.625428 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.10 - rpalogic : evaluateIf  id: 25d1c4e5-054e-1e19-bb4d-708e525ade35 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:16.626428 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.11 - rpascripts : module  id: ac09fc73-207c-ddee-b1c7-1cb802d05c54 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:57:19.040154 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.12 - rpaweb : waitforobject  id: 38701775-1ecd-ed68-7ecc-af4a1472aac7 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:57:36.380306 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13 - rpalogic : evaluateIf  id: 1a3e7857-cf29-77d0-0182-ccbb232d80b3 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:36.380306 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.1 - rpascripts : module  id: 08c38f05-e48f-c218-3f46-4d5f1934b78d -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta disponible el botón para elegir la EMPRESA."}
2025-11-05 14:57:36.380306 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.2 - rpascripts : module  id: 1fe28bd8-c2ae-46ca-a881-12bb156ceeec -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a ver si se puede recuperar del error,"}
2025-11-05 14:57:36.411563 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.3 - rpaweb : waitforobject  id: eca118db-f03e-e34f-4542-301a4a46131f - xpath - {"object":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","wait_time":"5","wait_for":"present","before":"","after":""}
2025-11-05 14:57:36.427183 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.4 - rpalogic : evaluateIf  id: 27f9b5d3-5cee-aebd-8da3-c7bb6f7a083f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:36.427183 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.5 - rpascripts : module  id: 6ee31825-8388-4519-fb69-a71cf00a7d39 -  - {"module_name":"webpro","module":"getText","data":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","data_type":"xpath","wait":"5","result":"loc009TextoError"}
2025-11-05 14:57:36.505308 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.6 - rpascripts : module  id: be84962b-9b7f-c8e2-99fc-85147f678d90 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Texto de error: {loc009TextoError}"}
2025-11-05 14:57:36.505308 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7 - rpalogic : evaluateIf  id: 917bd2d8-1cc4-7c56-be99-fde54790df73 -  - "tiene una sesión abierta" in "{loc009TextoError}"
2025-11-05 14:57:36.505308 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.1 - rpaweb : waitforobject  id: 364e3aab-7c8c-5a11-49a5-67a1ce2b3719 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:36.520929 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.2 - rpalogic : evaluateIf  id: 8e8592e5-00a4-768d-0dd5-ca9a41d9a5cf -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:36.520929 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.3 - rpascripts : module  id: 06ab2e6a-c9f3-891c-541c-2d4a20189fa3 -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:57:36.658492 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.4 - rpaweb : waitforobject  id: e84e10d1-caff-9537-051c-554673a523f1 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:36.671493 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.5 - rpalogic : evaluateIf  id: 161c812b-6428-476a-8be4-79a08497b880 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:36.672490 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.6 - rpascripts : module  id: 18d32ff9-755a-ca68-a819-3a79d47e7f1a -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:57:36.817860 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.7 - rpaweb : waitforobject  id: 1fbe7191-4d48-7348-c63c-fe17ed1b702b - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:36.853154 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.8 - rpalogic : evaluateIf  id: 19d8f8c4-e003-622d-e9b8-655e4fba4864 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:36.854153 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.9 - rpascripts : module  id: 0c165a1d-0434-b861-6b63-1bf2b0a2c0f5 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:57:37.230978 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.10 - rpaweb : waitforobject  id: 75bf25e2-987c-d090-ef8a-99bf89b133e2 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:57:40.407386 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.11 - rpalogic : evaluateIf  id: df131682-a304-6cc9-37c4-8e230e1d77ec -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:57:40.408385 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.14 - rpascripts : module  id: 13093157-0084-3c31-205c-cd096c07f525 -  - {"module_name":"webpro","module":"clickPro","data":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:57:40.744587 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 008_ChequearWorkManagerAbierto
2025-11-05 14:57:40.761728 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1 - rpalogic : trycatch  id: 4f7a770b-1545-60cd-3c43-95398623e355 -  - 
2025-11-05 14:57:40.762724 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.1 - rpasystem : setVar  id: 0b359a66-be39-94e4-09cb-e29f94ba4d67 -  - False
2025-11-05 14:57:40.763724 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.2 - rpascripts : module  id: aca309de-d599-8d68-6ead-d81b7bd55602 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a chequear que la sesión este iniciada."}
2025-11-05 14:57:40.768725 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.3 - rpaweb : waitforobject  id: 5cae235a-a9a1-f6a2-8427-bb7eb365fc7f - xpath - {"object":"//a[contains(text(),\"{gblUsuarioPortal}\")]/img[contains(@class,\"img-circle\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4 - rpalogic : evaluateIf  id: 9b695608-21ad-0cc7-ffb7-91a8a4c13142 -  - not {loc008SesionIniciada}
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4.1 - rpascripts : module  id: ce9afa1f-f6bc-8277-2bd4-df01ac4f6915 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta iniciada la sesion."}
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.5 - rpasystem : setVar  id: 23b30aa9-fbe8-9feb-8921-f5d81c67f09b -  - True
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.16 - rpalogic : evaluateIf  id: 46ca9fb0-760a-4295-6abc-c06763c249bd -  - not {gblBandProceso}
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.17 - rpasystem : setVar  id: 1e53549c-3fd7-a083-9f16-a8c6d90dae2b -  - True
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.20 - rpalogic : evaluateIf  id: 52a1a6c0-653f-da29-293b-314c088a01ea -  - not {gblBandProceso}
2025-11-05 14:57:56.041467 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.21 - - 010_NavegarAdministrarProcesos
2025-11-05 14:57:56.072728 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1 - rpalogic : trycatch  id: 85425d0e-eb4f-61e4-986b-9e8531454f30 -  - 
2025-11-05 14:57:56.072728 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.1 - rpasystem : setVar  id: d1d8e02a-531b-cf34-fa6c-bc7ac48c60d9 -  - False
2025-11-05 14:57:56.072728 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.2 - rpaweb : waitforobject  id: 0a15fe3b-1de2-365c-e413-681ebf639a85 - xpath - {"object":"//a[contains(normalize-space(.),\"Configuración\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:56.088350 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.3 - rpalogic : evaluateIf  id: 2123abfd-648e-28da-2d33-adfd081e7cf2 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:57:56.088350 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.4 - rpaweb : click_web  id: 5eeac613-699c-8d0b-c281-eb3beacdf60f -  - {"data":"//a[contains(normalize-space(.),\"Configuración\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:57:56.251859 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.5 - rpaweb : waitforobject  id: b08141db-5839-afbe-970f-1552bb8868e1 - xpath - {"object":"//a[contains(normalize-space(.),\"Administrar procesos\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:56.270600 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.6 - rpalogic : evaluateIf  id: 4147830b-e888-2fef-4b82-9c2d418d613b -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:57:56.271730 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.7 - rpaweb : click_web  id: c48fffbe-4aec-3a0b-6676-18921deb189d -  - {"data":"//a[contains(normalize-space(.),\"Administrar procesos\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:57:57.152132 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.8 - rpaweb : waitforobject  id: cb0908ea-c510-b6b7-47ae-0caabd40d0cc - xpath - {"object":"//a[contains(normalize-space(.),\"Eliminar\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:57.172133 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.9 - rpalogic : evaluateIf  id: c6485db6-f831-39c5-ab7c-52c9b3f8d5a1 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:57:57.173129 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.10 - rpaweb : click_web  id: cf746297-1312-e8c0-c084-61331a7d37ba -  - {"data":"//a[contains(normalize-space(.),\"Eliminar\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:57:57.323369 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.11 - rpasystem : setVar  id: b8670c90-9ab0-4f7a-9da2-5365091450a1 -  - True
2025-11-05 14:57:57.324370 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.12 - rpascripts : module  id: e250e3b1-3482-b477-4300-99c82e80eceb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se navego correctamente a Administrar procesos"}
2025-11-05 14:57:57.335371 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.22 - rpalogic : evaluateIf  id: 6b234a06-af1f-be45-355a-dee764d2263d -  - not {gblBandProceso}
2025-11-05 14:57:57.387420 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.23 - - 011_BuscarPorNumeroDeProceso
2025-11-05 14:57:57.437584 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1 - rpalogic : trycatch  id: 5a94df60-327d-5d78-9c98-18d0ce4f8f41 -  - 
2025-11-05 14:57:57.438583 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.1 - rpasystem : setVar  id: 8c5a28ec-9a70-2c3e-cbfa-188945bc69d5 -  - False
2025-11-05 14:57:57.439583 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.2 - rpaweb : waitforobject  id: 25f879cc-311f-0e42-df39-6a934ccf9604 - xpath - {"object":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:57.458584 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.3 - rpalogic : evaluateIf  id: 169529d6-4d9a-d9f6-8179-2cac1d2c190d -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:57:57.459584 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.4 - rpascripts : module  id: 04e8740c-8465-903c-5dc7-cdc1086c58c5 -  - {"module_name":"webpro","module":"clickPro","data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","data_type":"xpath","wait":"15"}
2025-11-05 14:57:57.796752 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.5 - rpasystem : wait  id: a3d19044-6256-341c-297f-1385c518a2a5 -  - 1
2025-11-05 14:57:58.797806 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.6 - rpasystem : setVar  id: 31f679f2-b82d-a27d-36fd-71bd9a02cc72 -  - {gblItemActual}["Nro de Proceso"]
2025-11-05 14:57:58.847459 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.7 - rpascripts : module  id: 39fa7b61-a4ae-3ba8-b4ef-aa925223bace -  - {"module_name":"webpro","module":"CleanInputs","texto":"{loc011NroProceso}","search_data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","tipo":"xpath","sleep_":true}
2025-11-05 14:57:59.948369 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.8 - rpaweb : waitforobject  id: e5f17a30-98e8-26ac-9d64-0a5b3db7c58c - id - {"object":"buscarProcesoEliminarButton","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:57:59.965369 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.9 - rpalogic : evaluateIf  id: a02fe4c4-28b9-6c5d-ec8e-b526cfa1ed5e -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:57:59.966369 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.10 - rpascripts : module  id: 4038b1c5-ba84-527b-c6e8-8a7c9070b697 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"se pudo encontrar el botón para buscar proceso."}
2025-11-05 14:57:59.969371 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.11 - rpascripts : module  id: 856ce597-4f6e-6f79-0192-1d30fe3d996d -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"buscarProcesoEliminarButton\"]","data_type":"xpath","wait":"15"}
2025-11-05 14:58:00.313055 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.12 - rpascripts : module  id: 1db9fab3-744a-b947-5cf6-16b3e236b1bf -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se da click en el boton que permitira buscar el proceso"}
2025-11-05 14:58:00.315055 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.13 - rpaweb : waitforobject  id: e5d3257a-f229-c7d9-1474-e98e269d29cb - xpath - {"object":"//p[contains(translate(normalize-space(.), \"ÁÉÍÓÚáéíóú\", \"AEIOUaeiou\"), \"No se encontro ningun proceso\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:58:00.319056 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14 - rpalogic : evaluateIf  id: a0ed021f-d5b8-65bf-829d-0bd083f8408f -  - {loc011EsperaDisponibilidad}
2025-11-05 14:58:00.320055 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.15 - rpascripts : module  id: e723de89-60b5-0b64-0047-86c5e07e2751 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se encontraron registros con el numero de proceso buscado"}
2025-11-05 14:58:00.336055 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.16 - rpaweb : waitforobject  id: 94abd698-ab3d-3092-ef06-7a0e783ea9d5 - xpath - {"object":"//table[contains(@class, 'table-bordered')]/tbody/tr[last()]/td/a","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:58:15.631186 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17 - rpalogic : evaluateIf  id: e3deceb0-55f6-7640-6a4f-df4bff517f23 -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:58:15.631186 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17.1 - rpascripts : module  id: 9f4b888b-deb8-4f33-ac6d-cfb5231c9656 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No se pudo encontrar el ultimo elemento de la tabla."}
2025-11-05 14:58:15.631186 - rocketbot - INFO - request: scripts : line 1.17.2 - rpascripts : stop - id: 3147aa2a-586a-43c4-28d4-215ccef7a1c0- - 
2025-11-05 14:58:15.631186 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24 - rpalogic : evaluateIf  id: 1967ed9c-96c0-554c-9092-351d68485942 -  - not {gblBandProceso}
2025-11-05 14:58:15.631186 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.1 - rpascripts : module  id: f5315364-0702-c1fe-f169-a4a381e52a41 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Ocurrio un error al buscar a el documento."}
2025-11-05 14:58:15.646812 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.2 - rpascripts : execscriptpython  id: f3846b4a-a1bd-08cd-8209-63a4592ab0bd -  - item = {gblItemActual}\n\nitem['Observaciones'] = "Ocurrio un error al buscar el proceso en Workmanager o no se encontraron resultados de la busqueda. Revisar archivo de logs."\n\nSetVar("gblItemActual",item)
2025-11-05 14:58:15.646812 - rocketbot - INFO - request: scripts : line 1.24.3 - rpascripts : stop - id: e632b3c5-c4c6-e4d4-9be5-49bd0acfcc85- - 
2025-11-05 14:58:15.646812 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 14:58:15.646812 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 14:58:15.662436 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 14:58:15.678067 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 14:58:15.678067 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 14:58:15.678067 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 14:58:15.693689 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 14:58:15.709323 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 14:58:18.459728 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 14:58:18.459728 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 14:58:18.459728 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 14:58:18.459728 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 14:58:18.475359 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 14:58:18.475359 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 14:58:18.475359 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 14:58:18.490981 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 14:58:20.225402 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 14:58:20.256636 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 14:58:20.256636 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 14:58:20.256636 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 14:58:20.256636 - rocketbot - INFO - For count: 20
2025-11-05 14:58:20.256636 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 14:58:20.272263 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 14:58:20.272263 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 14:58:20.272263 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 14:58:20.287889 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 14:58:20.287889 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 14:58:20.303529 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 14:58:20.303529 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 14:58:20.319148 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 14:58:20.319148 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 14:58:20.334766 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 14:58:20.350392 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 14:58:20.350392 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 14:58:20.350392 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 14:58:20.366026 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 14:58:20.366026 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 14:58:20.366026 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 14:58:20.366026 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 14:58:21.482225 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 14:58:21.482225 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 14:58:24.497903 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:58:24.999901 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 14:58:27.999959 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 14:58:28.314100 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 14:58:31.333745 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:58:31.349376 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:58:31.349376 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:58:31.349376 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:58:31.349376 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:58:32.365014 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:58:32.552518 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:58:32.552518 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:58:33.552838 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:58:33.615341 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:58:33.615341 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:58:34.622179 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:58:34.700309 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:58:34.700309 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 14:58:34.700309 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 14:58:34.700309 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 14:58:34.715932 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 14:58:34.731564 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 14:58:34.747180 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 14:58:34.747180 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 14:58:34.762808 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 14:58:34.762808 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 14:58:36.778472 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 14:58:36.778472 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 14:58:37.280103 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 14:58:37.655110 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 14:58:38.725922 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 14:58:38.835301 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 14:58:39.850944 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 14:58:40.350959 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 14:58:42.367451 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:58:42.383087 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:58:42.383087 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:58:42.383087 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:58:42.383087 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:58:43.383935 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:58:43.571439 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:58:43.571439 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:58:44.575328 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:58:44.637832 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:58:44.637832 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:58:45.653476 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:58:45.731599 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:58:45.731599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 14:58:45.731599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 14:58:45.731599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 14:58:45.731599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 14:58:45.762860 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 14:58:45.778475 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 14:58:45.778475 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 14:58:45.794114 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:46.809748 - rocketbot - INFO - For count: 0
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:46.809748 - rocketbot - INFO - For count: 1
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:58:46.809748 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:58:46.872248 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:58:46.872248 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:58:47.876999 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:47.876999 - rocketbot - INFO - For count: 2
2025-11-05 14:58:47.876999 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:58:47.876999 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:58:47.876999 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:58:47.939505 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:58:47.939505 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:58:48.943158 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:48.943158 - rocketbot - INFO - For count: 3
2025-11-05 14:58:48.943158 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:58:48.943158 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:58:48.943158 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:58:49.005653 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:58:49.005653 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:58:50.009967 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:50.056845 - rocketbot - INFO - For count: 4
2025-11-05 14:58:50.056845 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:58:50.072470 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:58:50.072470 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:58:50.134969 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:58:50.134969 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:58:51.140682 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:51.140682 - rocketbot - INFO - For count: 5
2025-11-05 14:58:51.140682 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 14:58:51.140682 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 14:58:51.140682 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 14:58:51.203183 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 14:58:51.203183 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 14:58:52.205419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 14:58:52.205419 - rocketbot - INFO - For count: 5
2025-11-05 14:58:52.205419 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:58:52.221048 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:58:52.221048 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:58:52.221048 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:58:52.221048 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:58:53.236689 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:58:53.424198 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:58:53.424198 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:58:54.434106 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:58:54.496612 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:58:54.496612 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:58:55.498943 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:58:55.577068 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:58:55.577068 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:58:55.577068 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 14:58:55.592698 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 14:58:55.592698 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 14:58:55.592698 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 14:58:55.592698 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 14:58:55.608330 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 14:58:55.608330 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 14:58:55.608330 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 14:58:55.608330 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 14:58:55.608330 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:58:58.614745 - rocketbot - INFO - For count: 0
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:58:58.614745 - rocketbot - INFO - For count: 1
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:58:58.614745 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:58:58.739749 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:58:58.739749 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:58:59.739769 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:58:59.739769 - rocketbot - INFO - For count: 2
2025-11-05 14:58:59.739769 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:58:59.755392 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:58:59.755392 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:58:59.942898 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:58:59.942898 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:59:00.958541 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:59:00.958541 - rocketbot - INFO - For count: 3
2025-11-05 14:59:00.958541 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:59:00.958541 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:59:00.958541 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:59:01.083543 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:59:01.099168 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:59:02.099188 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:59:02.099188 - rocketbot - INFO - For count: 4
2025-11-05 14:59:02.099188 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 14:59:02.099188 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 14:59:02.099188 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 14:59:02.286693 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 14:59:02.286693 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 14:59:03.288770 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 14:59:03.288770 - rocketbot - INFO - For count: 4
2025-11-05 14:59:03.288770 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 14:59:03.288770 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 14:59:03.398148 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 14:59:04.398172 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 14:59:04.460669 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 14:59:05.463571 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:59:05.479204 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:59:05.479204 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:59:05.479204 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:59:05.479204 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:59:06.494842 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:59:06.682352 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:59:06.682352 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:59:07.697992 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:59:07.760494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:59:07.760494 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:59:08.760637 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 14:59:08.838759 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 14:59:08.854395 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 14:59:08.854395 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 14:59:08.870015 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 14:59:08.870015 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 14:59:11.871946 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 14:59:11.871946 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 14:59:11.887575 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 14:59:11.887575 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 14:59:11.887575 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 14:59:11.887575 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 14:59:12.894021 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 14:59:13.081526 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 14:59:13.081526 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 14:59:14.085830 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 14:59:14.148332 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 14:59:14.148332 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 14:59:15.150350 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 14:59:15.228480 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 14:59:15.228480 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 14:59:15.228480 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 14:59:15.228480 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:',"Doc_Alt:"]\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-]+)\s*\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 14:59:15.244102 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 14:59:15.244102 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 14:59:15.244102 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 14:59:15.259734 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 14:59:15.275363 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 14:59:15.275363 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 14:59:15.275363 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 14:59:15.275363 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.14 - rpascripts : module  id: 77d12794-c1b7-6f11-806f-4bcd08805b76 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El doc_alt obtenido en el aplicativo Siesa 8.5 cumple con las reglas de negocio. doc_alt obtenido: {gblItemActual}"}
2025-11-05 14:59:15.275363 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 026_CerrarAplicativoSiesa
2025-11-05 14:59:15.290981 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 14:59:15.290981 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 14:59:15.306610 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 14:59:15.306610 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 14:59:15.322232 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 14:59:15.322232 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 14:59:15.353491 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 14:59:15.369105 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.16 - rpalogic : evaluateIf  id: d78feeff-b3e3-e00e-0313-90554f6bc669 -  - not {gblBandProceso}
2025-11-05 14:59:15.369105 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.17 - - 007_AbrirWorkManager
2025-11-05 14:59:15.384731 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1 - rpalogic : trycatch  id: 20e9c49d-6f8d-312f-09c5-aa5914ecb310 -  - 
2025-11-05 14:59:15.415985 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.1 - rpasystem : setVar  id: 8d6d4ab5-121a-f454-6c6e-91d2002ad5be -  - False
2025-11-05 14:59:15.415985 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.2 - rpascripts : module  id: a5e9e02e-542b-6c7e-1b54-5668e9b4841e -  - {"module_name":"webpro","module":"open_browser","browser":"chrome","url_":"{gblUrlWorkManager}","timeout":"10","newId":"work_manager_instace","profile_path":"{gblRutaProcess}/profile","download_path":"{gblRutaInput}/Descargas","force_downloads":true,"arguments":" ['--disable-gpu','--no-sandbox']"}
2025-11-05 14:59:16.956957 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.3 - rpascripts : module  id: febe532a-d844-808e-d9fa-56e8ae6f729e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre el navegador."}
2025-11-05 14:59:16.969883 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.4 - rpaweb : waitforobject  id: 44e55dfb-486d-1e3a-2598-4411101be563 - xpath - {"object":"//a[contains(@class,\"navbar\") and (contains(text(),\"WorkManager\"))]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:17.645814 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.5 - rpalogic : evaluateIf  id: 80fc7905-39f5-f845-f984-01bd1e34ace2 -  - not {loc007EsperaObjeto}
2025-11-05 14:59:17.646813 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.6 - rpascripts : module  id: b0556c99-4b80-edd6-7811-f9367076e4c7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a maximizar la pagina."}
2025-11-05 14:59:17.651815 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.7 - rpaweb : maximize  id: 26325fd6-e765-670d-a1b6-ce22486c116c -  - 
2025-11-05 14:59:17.655817 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.8 - rpascripts : execscriptpython  id: f26fd7ac-90fc-053b-7209-9697ecafbdcd -  - global logger\n\nfrom VortexLibrary import logger\nimport win32com.client\nimport pygetwindow as gw\n\nlogger.log_path = "{gblRutaLogs}"\nlogger.task = tmp_global_obj["profile"]["name"]\n\n\ntab_name = "Iniciar sesión - Workmanager"\nlogger.info(f"Buscando ventana con título: {tab_name}")\nwindows = gw.getAllWindows()\nshell = win32com.client.Dispatch("WScript.Shell")\n\nfound = None\nfor w in windows:\n    logger.info(f"Ventana encontrada: '{w.title}'")\n    if tab_name.lower() in w.title.lower():\n        found = w\n        logger.info(f"Ventana con el título '{tab_name}' encontrada: '{w.title}'")\n        break\n\nif found:\n    hwnd = found._hWnd  # handle de la ventana\n    try:\n        import win32gui\n        import win32con\n        shell.SendKeys('%')  # truco: envía ALT para permitir SetForegroundWindow\n        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # restaura si está minimizada\n        win32gui.ShowWindow(hwnd, win32con.SW_MAXIMIZE)\n        win32gui.SetForegroundWindow(hwnd)\n        logger.info(f"Ventana '{found.title}' traída al frente y maximizada.")\n        print(f"Ventana '{found.title}' traída al frente y maximizada.")\n    except Exception as e:\n        logger.error(f"Error al traer la ventana al frente: {e}")\n        print(f"Error al traer la ventana al frente: {e}")\nelse:\n    logger.warning(f"No se encontró ninguna ventana con: {tab_name}")\n    print(f"No se encontró ninguna ventana con: {tab_name}")
2025-11-05 14:59:17.742822 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.9 - rpascripts : module  id: 680c8f2d-d561-4299-e736-401f7c20d9bf -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"El navegador se cargo correctamente."}
2025-11-05 14:59:17.765860 - rocketbot - INFO - request: 007_AbrirWorkManager : line 1.10 - rpasystem : setVar  id: ae15e49d-9fd8-6ff7-6df5-bf9b6974e00e -  - True
2025-11-05 14:59:17.767577 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.18 - rpalogic : evaluateIf  id: d927536d-89c6-25fd-4012-44c53ca5e6d9 -  - not {gblBandProceso}
2025-11-05 14:59:17.794651 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.19 - - 009_IniciarSesionWorkManager
2025-11-05 14:59:17.812649 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1 - rpalogic : trycatch  id: 35bda62d-d144-b099-0a15-ce60351f67c4 -  - 
2025-11-05 14:59:17.813650 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.1 - rpasystem : setVar  id: 4f81a886-b606-c281-1646-91d8d910189c -  - False
2025-11-05 14:59:17.814650 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.2 - rpascripts : module  id: 9d3390f9-2a29-3869-fc00-e73603e01da8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Comienza el inicio de sesión de WorkManager."}
2025-11-05 14:59:17.819649 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.3 - rpaweb : waitforobject  id: b32df2ed-e697-246e-c465-0a05d6717a62 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:17.836990 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.4 - rpalogic : evaluateIf  id: f002c160-ce98-64b6-8b25-104473668ff8 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:17.837991 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.5 - rpascripts : module  id: 581b378d-a3ff-b8dd-d356-28f706834e5e -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:59:17.999696 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.6 - rpaweb : waitforobject  id: 49bf1bbd-8da4-905f-b356-5e5e263d6ee7 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:18.017888 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.7 - rpalogic : evaluateIf  id: 471f57c1-e45f-2a8a-2028-64e09fe8568f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:18.018886 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.8 - rpascripts : module  id: 7b948fff-3cd6-7d46-b70d-4709f3bcb71d -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:59:18.155774 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.9 - rpaweb : waitforobject  id: ed0c3962-cac0-6f2b-b35b-4d0eee4013a6 - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:18.177926 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.10 - rpalogic : evaluateIf  id: 25d1c4e5-054e-1e19-bb4d-708e525ade35 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:18.178921 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.11 - rpascripts : module  id: ac09fc73-207c-ddee-b1c7-1cb802d05c54 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:59:20.596943 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.12 - rpaweb : waitforobject  id: 38701775-1ecd-ed68-7ecc-af4a1472aac7 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:59:37.888758 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13 - rpalogic : evaluateIf  id: 1a3e7857-cf29-77d0-0182-ccbb232d80b3 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:37.888758 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.1 - rpascripts : module  id: 08c38f05-e48f-c218-3f46-4d5f1934b78d -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta disponible el botón para elegir la EMPRESA."}
2025-11-05 14:59:37.888758 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.2 - rpascripts : module  id: 1fe28bd8-c2ae-46ca-a881-12bb156ceeec -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a ver si se puede recuperar del error,"}
2025-11-05 14:59:37.904395 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.3 - rpaweb : waitforobject  id: eca118db-f03e-e34f-4542-301a4a46131f - xpath - {"object":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","wait_time":"5","wait_for":"present","before":"","after":""}
2025-11-05 14:59:37.920009 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.4 - rpalogic : evaluateIf  id: 27f9b5d3-5cee-aebd-8da3-c7bb6f7a083f -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:37.920009 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.5 - rpascripts : module  id: 6ee31825-8388-4519-fb69-a71cf00a7d39 -  - {"module_name":"webpro","module":"getText","data":"//div[contains(@class,\"validation-summary-errors\")]/ul/li","data_type":"xpath","wait":"5","result":"loc009TextoError"}
2025-11-05 14:59:37.998137 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.6 - rpascripts : module  id: be84962b-9b7f-c8e2-99fc-85147f678d90 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Texto de error: {loc009TextoError}"}
2025-11-05 14:59:37.998137 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7 - rpalogic : evaluateIf  id: 917bd2d8-1cc4-7c56-be99-fde54790df73 -  - "tiene una sesión abierta" in "{loc009TextoError}"
2025-11-05 14:59:37.998137 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.1 - rpaweb : waitforobject  id: 364e3aab-7c8c-5a11-49a5-67a1ce2b3719 - id - {"object":"UserName","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:38.013762 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.2 - rpalogic : evaluateIf  id: 8e8592e5-00a4-768d-0dd5-ca9a41d9a5cf -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:38.013762 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.3 - rpascripts : module  id: 06ab2e6a-c9f3-891c-541c-2d4a20189fa3 -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblUsuarioWorkmanager}","search_data":"UserName","tipo":"id"}
2025-11-05 14:59:38.151331 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.4 - rpaweb : waitforobject  id: e84e10d1-caff-9537-051c-554673a523f1 - id - {"object":"Password","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:38.163330 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.5 - rpalogic : evaluateIf  id: 161c812b-6428-476a-8be4-79a08497b880 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:38.164329 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.6 - rpascripts : module  id: 18d32ff9-755a-ca68-a819-3a79d47e7f1a -  - {"module_name":"webpro","module":"CleanInputs","texto":"{gblContrasenaWorkmanager}","search_data":"Password","tipo":"id"}
2025-11-05 14:59:38.296874 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.7 - rpaweb : waitforobject  id: 1fbe7191-4d48-7348-c63c-fe17ed1b702b - xpath - {"object":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:38.319770 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.8 - rpalogic : evaluateIf  id: 19d8f8c4-e003-622d-e9b8-655e4fba4864 -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:38.320768 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.9 - rpascripts : module  id: 0c165a1d-0434-b861-6b63-1bf2b0a2c0f5 -  - {"module_name":"webpro","module":"clickPro","data":"//button[@type=\"submit\" and contains(normalize-space(.),\"Iniciar Sesión\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:59:38.847506 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.10 - rpaweb : waitforobject  id: 75bf25e2-987c-d090-ef8a-99bf89b133e2 - xpath - {"object":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","wait_time":"15","wait_for":"present","before":"","after":"2"}
2025-11-05 14:59:41.369956 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.13.7.11 - rpalogic : evaluateIf  id: df131682-a304-6cc9-37c4-8e230e1d77ec -  - not {loc009EsperaDisponibilidad}
2025-11-05 14:59:41.370956 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.14 - rpascripts : module  id: 13093157-0084-3c31-205c-cd096c07f525 -  - {"module_name":"webpro","module":"clickPro","data":"//a[contains(normalize-space(.),\"01 - ENERGIZANDO SAS\")]","data_type":"xpath","wait":"15"}
2025-11-05 14:59:41.708539 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.15 - - 008_ChequearWorkManagerAbierto
2025-11-05 14:59:41.724677 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1 - rpalogic : trycatch  id: 4f7a770b-1545-60cd-3c43-95398623e355 -  - 
2025-11-05 14:59:41.725678 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.1 - rpasystem : setVar  id: 0b359a66-be39-94e4-09cb-e29f94ba4d67 -  - False
2025-11-05 14:59:41.726678 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.2 - rpascripts : module  id: aca309de-d599-8d68-6ead-d81b7bd55602 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se va a chequear que la sesión este iniciada."}
2025-11-05 14:59:41.731677 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.3 - rpaweb : waitforobject  id: 5cae235a-a9a1-f6a2-8427-bb7eb365fc7f - xpath - {"object":"//a[contains(text(),\"{gblUsuarioPortal}\")]/img[contains(@class,\"img-circle\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4 - rpalogic : evaluateIf  id: 9b695608-21ad-0cc7-ffb7-91a8a4c13142 -  - not {loc008SesionIniciada}
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.4.1 - rpascripts : module  id: ce9afa1f-f6bc-8277-2bd4-df01ac4f6915 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No esta iniciada la sesion."}
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 008_ChequearWorkManagerAbierto : line 1.5 - rpasystem : setVar  id: 23b30aa9-fbe8-9feb-8921-f5d81c67f09b -  - True
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.16 - rpalogic : evaluateIf  id: 46ca9fb0-760a-4295-6abc-c06763c249bd -  - not {gblBandProceso}
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 009_IniciarSesionWorkManager : line 1.17 - rpasystem : setVar  id: 1e53549c-3fd7-a083-9f16-a8c6d90dae2b -  - True
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.20 - rpalogic : evaluateIf  id: 52a1a6c0-653f-da29-293b-314c088a01ea -  - not {gblBandProceso}
2025-11-05 14:59:57.023341 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.21 - - 010_NavegarAdministrarProcesos
2025-11-05 14:59:57.054592 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1 - rpalogic : trycatch  id: 85425d0e-eb4f-61e4-986b-9e8531454f30 -  - 
2025-11-05 14:59:57.054592 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.1 - rpasystem : setVar  id: d1d8e02a-531b-cf34-fa6c-bc7ac48c60d9 -  - False
2025-11-05 14:59:57.054592 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.2 - rpaweb : waitforobject  id: 0a15fe3b-1de2-365c-e413-681ebf639a85 - xpath - {"object":"//a[contains(normalize-space(.),\"Configuración\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:57.070217 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.3 - rpalogic : evaluateIf  id: 2123abfd-648e-28da-2d33-adfd081e7cf2 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:59:57.070217 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.4 - rpaweb : click_web  id: 5eeac613-699c-8d0b-c281-eb3beacdf60f -  - {"data":"//a[contains(normalize-space(.),\"Configuración\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:59:57.231855 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.5 - rpaweb : waitforobject  id: b08141db-5839-afbe-970f-1552bb8868e1 - xpath - {"object":"//a[contains(normalize-space(.),\"Administrar procesos\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:57.249313 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.6 - rpalogic : evaluateIf  id: 4147830b-e888-2fef-4b82-9c2d418d613b -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:59:57.250314 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.7 - rpaweb : click_web  id: c48fffbe-4aec-3a0b-6676-18921deb189d -  - {"data":"//a[contains(normalize-space(.),\"Administrar procesos\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:59:58.028732 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.8 - rpaweb : waitforobject  id: cb0908ea-c510-b6b7-47ae-0caabd40d0cc - xpath - {"object":"//a[contains(normalize-space(.),\"Eliminar\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:58.049731 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.9 - rpalogic : evaluateIf  id: c6485db6-f831-39c5-ab7c-52c9b3f8d5a1 -  - not {loc010EsperaDisponibilidad}
2025-11-05 14:59:58.050732 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.10 - rpaweb : click_web  id: cf746297-1312-e8c0-c084-61331a7d37ba -  - {"data":"//a[contains(normalize-space(.),\"Eliminar\")]","data_type":"xpath","wait_time":"15","move":true}
2025-11-05 14:59:58.202953 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.11 - rpasystem : setVar  id: b8670c90-9ab0-4f7a-9da2-5365091450a1 -  - True
2025-11-05 14:59:58.210954 - rocketbot - INFO - request: 010_NavegarAdministrarProcesos : line 1.12 - rpascripts : module  id: e250e3b1-3482-b477-4300-99c82e80eceb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se navego correctamente a Administrar procesos"}
2025-11-05 14:59:58.219956 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.22 - rpalogic : evaluateIf  id: 6b234a06-af1f-be45-355a-dee764d2263d -  - not {gblBandProceso}
2025-11-05 14:59:58.220954 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.23 - - 011_BuscarPorNumeroDeProceso
2025-11-05 14:59:58.245957 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1 - rpalogic : trycatch  id: 5a94df60-327d-5d78-9c98-18d0ce4f8f41 -  - 
2025-11-05 14:59:58.246954 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.1 - rpasystem : setVar  id: 8c5a28ec-9a70-2c3e-cbfa-188945bc69d5 -  - False
2025-11-05 14:59:58.247955 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.2 - rpaweb : waitforobject  id: 25f879cc-311f-0e42-df39-6a934ccf9604 - xpath - {"object":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 14:59:58.266959 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.3 - rpalogic : evaluateIf  id: 169529d6-4d9a-d9f6-8179-2cac1d2c190d -  - not {loc011EsperaDisponibilidad}
2025-11-05 14:59:58.267955 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.4 - rpascripts : module  id: 04e8740c-8465-903c-5dc7-cdc1086c58c5 -  - {"module_name":"webpro","module":"clickPro","data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","data_type":"xpath","wait":"15"}
2025-11-05 14:59:59.120449 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.5 - rpasystem : wait  id: a3d19044-6256-341c-297f-1385c518a2a5 -  - 1
2025-11-05 15:00:00.122398 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.6 - rpasystem : setVar  id: 31f679f2-b82d-a27d-36fd-71bd9a02cc72 -  - {gblItemActual}["Nro de Proceso"]
2025-11-05 15:00:00.123390 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.7 - rpascripts : module  id: 39fa7b61-a4ae-3ba8-b4ef-aa925223bace -  - {"module_name":"webpro","module":"CleanInputs","texto":"{loc011NroProceso}","search_data":"(//input[@id='nroProcesoEliminarText' and not(contains(@style,'display: none'))]  |   //input[@id='nroProcesoEliminarText']/preceding-sibling::input[not(contains(@style,'display: none'))])[1]","tipo":"xpath","sleep_":true}
2025-11-05 15:00:01.224577 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.8 - rpaweb : waitforobject  id: e5f17a30-98e8-26ac-9d64-0a5b3db7c58c - id - {"object":"buscarProcesoEliminarButton","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 15:00:01.241577 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.9 - rpalogic : evaluateIf  id: a02fe4c4-28b9-6c5d-ec8e-b526cfa1ed5e -  - not {loc011EsperaDisponibilidad}
2025-11-05 15:00:01.242576 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.10 - rpascripts : module  id: 4038b1c5-ba84-527b-c6e8-8a7c9070b697 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"se pudo encontrar el botón para buscar proceso."}
2025-11-05 15:00:01.244577 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.11 - rpascripts : module  id: 856ce597-4f6e-6f79-0192-1d30fe3d996d -  - {"module_name":"webpro","module":"clickPro","data":"//button[@id=\"buscarProcesoEliminarButton\"]","data_type":"xpath","wait":"15"}
2025-11-05 15:00:01.582507 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.12 - rpascripts : module  id: 1db9fab3-744a-b947-5cf6-16b3e236b1bf -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se da click en el boton que permitira buscar el proceso"}
2025-11-05 15:00:01.585502 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.13 - rpaweb : waitforobject  id: e5d3257a-f229-c7d9-1474-e98e269d29cb - xpath - {"object":"//p[contains(translate(normalize-space(.), \"ÁÉÍÓÚáéíóú\", \"AEIOUaeiou\"), \"No se encontro ningun proceso\")]","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 15:00:01.589503 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.14 - rpalogic : evaluateIf  id: a0ed021f-d5b8-65bf-829d-0bd083f8408f -  - {loc011EsperaDisponibilidad}
2025-11-05 15:00:01.590504 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.15 - rpascripts : module  id: e723de89-60b5-0b64-0047-86c5e07e2751 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se encontraron registros con el numero de proceso buscado"}
2025-11-05 15:00:01.628505 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.16 - rpaweb : waitforobject  id: 94abd698-ab3d-3092-ef06-7a0e783ea9d5 - xpath - {"object":"//table[contains(@class, 'table-bordered')]/tbody/tr[last()]/td/a","wait_time":"15","wait_for":"present","before":"","after":""}
2025-11-05 15:00:16.888494 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17 - rpalogic : evaluateIf  id: e3deceb0-55f6-7640-6a4f-df4bff517f23 -  - not {loc011EsperaDisponibilidad}
2025-11-05 15:00:16.888494 - rocketbot - INFO - request: 011_BuscarPorNumeroDeProceso : line 1.17.1 - rpascripts : module  id: 9f4b888b-deb8-4f33-ac6d-cfb5231c9656 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No se pudo encontrar el ultimo elemento de la tabla."}
2025-11-05 15:00:16.888494 - rocketbot - INFO - request: scripts : line 1.17.2 - rpascripts : stop - id: 3147aa2a-586a-43c4-28d4-215ccef7a1c0- - 
2025-11-05 15:00:16.888494 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24 - rpalogic : evaluateIf  id: 1967ed9c-96c0-554c-9092-351d68485942 -  - not {gblBandProceso}
2025-11-05 15:00:16.888494 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.1 - rpascripts : module  id: f5315364-0702-c1fe-f169-a4a381e52a41 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Ocurrio un error al buscar a el documento."}
2025-11-05 15:00:16.904123 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.24.2 - rpascripts : execscriptpython  id: f3846b4a-a1bd-08cd-8209-63a4592ab0bd -  - item = {gblItemActual}\n\nitem['Observaciones'] = "Ocurrio un error al buscar el proceso en Workmanager o no se encontraron resultados de la busqueda. Revisar archivo de logs."\n\nSetVar("gblItemActual",item)
2025-11-05 15:00:16.904123 - rocketbot - INFO - request: scripts : line 1.24.3 - rpascripts : stop - id: e632b3c5-c4c6-e4d4-9be5-49bd0acfcc85- - 
2025-11-05 15:00:16.904123 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 15:00:16.904123 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 15:00:16.919746 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 15:00:16.935371 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 15:00:16.935371 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 15:00:16.935371 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 15:00:16.950996 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 15:00:16.966621 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 15:00:19.717379 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.5 - rpascripts : module  id: 67da8fe8-be7a-d17a-deb9-fb6f975c7491 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se cierra WorkManager con éxito."}
2025-11-05 15:00:19.717379 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.6 - rpasystem : setVar  id: ad13a2f3-b65c-0eae-7459-57bfa6ad7b37 -  - True
2025-11-05 15:00:19.717379 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 15:00:19.717379 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 15:00:19.733007 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 15:00:19.733007 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 15:00:19.733007 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 15:00:19.748631 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 15:00:21.561173 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 15:00:21.592419 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 15:00:21.592419 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 15:00:21.608039 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 15:00:21.608039 - rocketbot - INFO - For count: 21
2025-11-05 15:00:21.608039 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 15:00:21.623669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 15:00:21.623669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 15:00:21.623669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 15:00:21.623669 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 15:00:21.639295 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 15:00:21.654916 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 15:00:21.654916 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 15:00:21.670543 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 15:00:21.670543 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 15:00:21.670543 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 15:00:21.686168 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 15:00:21.733044 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 15:00:21.733044 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 15:00:21.748669 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 15:00:21.748669 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 15:00:21.748669 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 15:00:21.764298 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
