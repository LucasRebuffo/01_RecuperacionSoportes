2025-11-05 11:32:30.709889 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 11:32:30.709889 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 11:32:30.709889 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 11:32:30.725518 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 11:32:30.772390 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 11:32:30.772390 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 11:32:30.772390 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 11:32:31.881788 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 11:32:31.897420 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 11:32:34.913096 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 11:32:35.413111 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 11:32:38.415009 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 11:32:38.727516 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 11:32:41.743199 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 11:32:41.758837 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 11:32:41.758837 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 11:32:41.758837 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 11:32:41.758837 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 11:32:42.761072 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 11:32:42.948581 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 11:32:42.948581 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 11:32:43.964221 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 11:32:44.026724 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 11:32:44.057974 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 11:32:45.058795 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 11:32:45.136916 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 11:32:45.152544 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 11:32:45.152544 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 11:32:45.152544 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 11:32:45.152544 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 11:32:45.183801 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 11:32:45.183801 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 11:32:45.183801 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 11:32:45.199418 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 11:32:45.199418 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 11:32:47.205298 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 11:32:47.205298 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 11:32:47.715161 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 11:32:48.090173 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 11:32:49.090192 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 11:32:49.199569 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 11:32:50.199589 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 11:32:50.699594 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 11:32:52.700871 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 11:32:52.716499 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 11:32:52.716499 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 11:32:52.716499 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 11:32:52.716499 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 11:32:53.716521 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 11:32:53.951305 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 11:32:53.951305 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 11:32:54.951326 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 11:32:55.013829 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 11:32:55.013829 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 11:32:56.029470 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 11:32:56.107599 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 11:32:56.107599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 11:32:56.107599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 11:32:56.107599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 11:32:56.107599 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 11:32:56.138850 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 11:32:56.138850 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 11:32:56.138850 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 11:32:56.154476 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 11:32:56.154476 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 11:32:56.170101 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 11:32:56.170101 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 11:32:56.170101 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 11:32:56.170101 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 11:32:57.185744 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 11:32:57.185744 - script - ERROR - EXCEPTION IN (<string> script, L_144 ""): SyntaxError: invalid syntax (<string>, line 5)
2025-11-05 11:32:57.326372 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: e578d0f0-6536-fc52-a2a3-2ba1914658f9 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"error","text":"Ocurrio un error en la nevagacion del aplicativo Siesa 8.5."}
2025-11-05 11:32:57.326372 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 11:32:57.326372 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7.1 - rpascripts : module  id: 796018cb-7fe8-1e1d-2014-100ec5266d4f -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No fue posible realizar la navegacion del menu de Siesa para posteriormente ingresar la informacion de la factura"}
2025-11-05 11:32:57.342001 - rocketbot - INFO - request: scripts : line 1.7.2 - rpascripts : stop - id: 28c2b7a2-a365-15f7-fb03-64827f94674d- - 
2025-11-05 11:32:57.357622 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 11:32:57.357622 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 11:32:57.357622 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 11:32:57.388878 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 11:32:57.388878 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 11:32:57.388878 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 11:32:57.388878 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 11:32:57.388878 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 11:32:57.388878 - rpaweb - ERROR - EXCEPTION IN (<string> rpaweb, L_176 ""): Exception: Webbrowser default not load
2025-11-05 11:32:57.693481 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpascripts : module  id: c84a5516-2214-068d-a176-669a083163f7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"error","text":"Ocurrió un error al cerrar Workmanager."}
2025-11-05 11:32:57.693481 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 11:32:57.693481 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 11:32:57.709103 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 11:32:57.709103 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 11:32:57.724726 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 11:32:57.724726 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 11:32:59.552888 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 11:32:59.584143 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 11:32:59.584143 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 11:32:59.584143 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 11:32:59.599764 - rocketbot - INFO - For count: 2
2025-11-05 11:32:59.599764 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 11:32:59.615397 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 11:32:59.615397 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 11:32:59.615397 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 11:32:59.615397 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 11:32:59.631015 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 11:32:59.646650 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 11:32:59.646650 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 11:32:59.662279 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 11:32:59.662279 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 11:32:59.662279 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 11:32:59.677895 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 11:32:59.677895 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 11:32:59.677895 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 11:32:59.693517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 11:32:59.693517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 11:32:59.693517 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 11:32:59.709140 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 11:33:00.865415 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 11:33:00.865415 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 11:33:03.876049 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 11:33:04.381818 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 11:33:07.381877 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 11:33:07.710009 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 11:33:10.723869 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 11:33:10.739500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 11:33:10.739500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 11:33:10.739500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 11:33:10.739500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 11:33:11.744161 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 11:33:11.931661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 11:33:11.931661 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 11:33:12.931680 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 11:33:12.994185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 11:33:12.994185 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 11:33:13.995149 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 11:33:14.073273 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 11:33:14.073273 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 11:33:14.073273 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 11:33:14.073273 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 11:33:14.073273 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13.1 - rpascripts : module  id: 146e1044-5c18-3a93-5642-8634a0cc7495 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No se pudo validar la pantalla de Login."}
2025-11-05 11:33:14.104532 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13.2 - rpasystem : setVar  id: 14b64318-085d-968e-b718-6a0c77d38766 -  - False
2025-11-05 11:33:14.104532 - rocketbot - INFO - request: scripts : line 1.13.3 - rpascripts : stop - id: 61b96818-9768-c731-d0c5-f3618fea41ac- - 
2025-11-05 11:33:14.120156 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 11:33:14.120156 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3.1 - rpascripts : module  id: e2c93419-3938-a50e-d8bd-2ed7a8fec8f3 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"No fue posible abrir Siesa 8.5 para continuar con el proceso"}
2025-11-05 11:33:14.135777 - rocketbot - INFO - request: scripts : line 1.3.2 - rpascripts : stop - id: 6a55b210-c4e6-2483-6f09-e244bf7d82bc- - 
2025-11-05 11:33:14.135777 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 11:33:14.135777 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2.1 - rpascripts : module  id: e9510ed8-ad56-913c-6285-bdca5aed5756 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"Algo fallo al realizar la busqueda por numero de proceso."}
2025-11-05 11:33:14.151402 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.2.2 - - 021_CerrarWorkmanager
2025-11-05 11:33:14.167029 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1 - rpalogic : trycatch  id: 4686e547-bd52-6dd5-8b73-bde33058db29 -  - 
2025-11-05 11:33:14.167029 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpasystem : setVar  id: d072c8e0-3d68-6560-d2a9-e376f7640c15 -  - False
2025-11-05 11:33:14.167029 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.2 - rpascripts : module  id: aebb285f-bada-e33d-0030-30a1c2e637ee -  - {"module_name":"System++","module":"cleanVars","vars":"loc021NavegadorAbierto"}
2025-11-05 11:33:14.167029 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.3 - rpascripts : module  id: 27ca5f6b-b4d5-2f0e-11d4-f36255676401 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se intenta cerrar Workmanager con Close Browser."}
2025-11-05 11:33:14.167029 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.4 - rpaweb : killdriver  id: ac96e4b0-8cf0-7476-f043-89404bf2efaf -  - 
2025-11-05 11:33:14.167029 - rpaweb - ERROR - EXCEPTION IN (<string> rpaweb, L_176 ""): Exception: Webbrowser default not load
2025-11-05 11:33:14.387856 - rocketbot - INFO - request: 021_CerrarWorkmanager : line 1.1 - rpascripts : module  id: c84a5516-2214-068d-a176-669a083163f7 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"error","text":"Ocurrió un error al cerrar Workmanager."}
2025-11-05 11:33:14.403484 - rocketbot - INFO - request: scripts : line 1.8.2.3 - rpascripts : stop - id: d8245ba0-a8a7-5d22-fea6-d21c7ea7884d- - 
2025-11-05 11:33:14.403484 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 11:33:14.419109 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 11:33:14.465982 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 11:33:14.465982 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 11:33:14.465982 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 11:33:16.262893 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 11:33:16.294145 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 11:33:16.294145 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 11:33:16.294145 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 11:33:16.309771 - rocketbot - INFO - For count: 3
2025-11-05 11:33:16.309771 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 11:33:16.325395 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 11:33:16.325395 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 11:33:16.325395 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 11:33:16.325395 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 11:33:16.325395 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 11:33:16.356645 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 11:33:16.356645 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 11:33:16.372284 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 11:33:16.372284 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 11:33:16.372284 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 11:33:16.387900 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 11:33:16.387900 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 11:33:16.387900 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 11:33:16.403520 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 11:33:16.403520 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 11:33:16.403520 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 11:33:16.419146 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
