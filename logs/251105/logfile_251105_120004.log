2025-11-05 12:00:30.588275 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 12:00:30.588275 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 12:00:30.588275 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 12:00:30.603902 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 12:00:30.619526 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 12:00:30.619526 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 12:00:30.619526 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 12:00:31.719568 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 12:00:31.751410 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 12:00:34.762407 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 12:00:35.278045 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 12:00:38.278323 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 12:00:38.606456 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 12:00:41.609600 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:00:41.625233 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:00:41.625233 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:00:41.625233 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:00:41.625233 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:00:42.640879 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:00:42.828386 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:00:42.828386 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:00:43.828413 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:00:43.890915 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:00:43.890915 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:00:44.890941 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:00:44.969072 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:00:44.984694 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 12:00:44.984694 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 12:00:44.984694 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 12:00:44.984694 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 12:00:45.015953 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 12:00:45.015953 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 12:00:45.015953 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 12:00:45.031572 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 12:00:45.031572 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 12:00:47.056425 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 12:00:47.056425 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 12:00:47.556442 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 12:00:47.931454 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 12:00:48.931482 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 12:00:49.040863 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 12:00:50.056511 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 12:00:50.556526 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 12:00:52.556587 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:00:52.572219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:00:52.572219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:00:52.572219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:00:52.572219 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:00:53.587870 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:00:53.775373 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:00:53.775373 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:00:54.782180 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:00:54.844683 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:00:54.844683 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:00:55.845422 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:00:55.923550 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:00:55.923550 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 12:00:55.923550 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 12:00:55.923550 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 12:00:55.923550 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 12:00:55.954808 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 12:00:55.970423 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 12:00:55.970423 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 12:00:55.986050 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:00:56.994846 - rocketbot - INFO - For count: 0
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:00:56.994846 - rocketbot - INFO - For count: 1
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:00:56.994846 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:00:57.057347 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:00:57.057347 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:00:58.060285 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:00:58.060285 - rocketbot - INFO - For count: 2
2025-11-05 12:00:58.060285 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:00:58.060285 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:00:58.060285 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:00:58.122786 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:00:58.122786 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:00:59.123061 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:00:59.123061 - rocketbot - INFO - For count: 3
2025-11-05 12:00:59.123061 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:00:59.123061 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:00:59.123061 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:00:59.185563 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:00:59.185563 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:00.185589 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:00.185589 - rocketbot - INFO - For count: 4
2025-11-05 12:01:00.185589 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:00.185589 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:00.185589 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:00.248091 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:00.248091 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:01.251255 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:01.251255 - rocketbot - INFO - For count: 5
2025-11-05 12:01:01.251255 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:01.251255 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:01.251255 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:01.313757 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:01.313757 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:02.316374 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:02.316374 - rocketbot - INFO - For count: 5
2025-11-05 12:01:02.316374 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:02.332003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:02.332003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:02.332003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:02.332003 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:01:03.347658 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:01:03.535163 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:01:03.535163 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:01:04.535190 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:01:04.597693 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:01:04.597693 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:01:05.598955 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:01:05.677081 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:01:05.677081 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 12:01:05.677081 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 12:01:05.692705 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 12:01:05.692705 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 12:01:05.692705 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 12:01:05.692705 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 12:01:05.708336 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 12:01:05.708336 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 12:01:05.708336 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 12:01:05.708336 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 12:01:05.708336 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:08.713019 - rocketbot - INFO - For count: 0
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:08.713019 - rocketbot - INFO - For count: 1
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:01:08.713019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:01:08.838022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:01:08.838022 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:01:09.839748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:09.839748 - rocketbot - INFO - For count: 2
2025-11-05 12:01:09.839748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:01:09.839748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:01:09.839748 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:01:10.028814 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:01:10.028814 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:01:11.036029 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:11.036029 - rocketbot - INFO - For count: 3
2025-11-05 12:01:11.036029 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:01:11.036029 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:01:11.036029 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:01:11.161026 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:01:11.161026 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:01:12.176676 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:12.176676 - rocketbot - INFO - For count: 4
2025-11-05 12:01:12.176676 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:01:12.176676 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:01:12.176676 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:01:12.364182 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:01:12.364182 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:01:13.379839 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:01:13.379839 - rocketbot - INFO - For count: 4
2025-11-05 12:01:13.379839 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 12:01:13.379839 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 12:01:13.504843 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 12:01:14.520494 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 12:01:14.582995 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 12:01:15.584481 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:15.600115 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:15.600115 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:15.600115 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:15.600115 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:01:16.602743 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:01:16.780403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:01:16.780403 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:01:17.780969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:01:17.843474 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:01:17.843474 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:01:18.844584 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:01:18.922714 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:01:18.922714 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 12:01:18.922714 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 12:01:18.922714 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 12:01:18.922714 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 12:01:18.938336 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 12:01:18.938336 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 12:01:18.953971 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 12:01:18.953971 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 12:01:18.953971 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 12:01:18.953971 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 12:01:21.956343 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 12:01:21.956343 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:21.971969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:21.971969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:21.971969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:21.971969 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:01:22.971996 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:01:23.159500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:01:23.159500 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:01:24.159532 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:01:24.222036 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:01:24.222036 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:01:25.223524 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:01:25.301655 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:01:25.301655 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 12:01:25.301655 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 12:01:25.301655 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:']\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-\s]+)\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 12:01:25.317279 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 12:01:25.317279 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 12:01:25.317279 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 12:01:25.332995 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 12:01:25.332995 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 12:01:25.348526 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 12:01:25.348526 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 12:01:25.348526 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 12:01:25.348526 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 12:01:25.348526 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 12:01:25.364152 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 12:01:25.364152 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 12:01:25.379780 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 12:01:25.379780 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 12:01:25.411027 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 12:01:25.411027 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 12:01:25.426654 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 12:01:25.426654 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 12:01:25.551659 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 12:01:25.551659 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 12:01:25.567285 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 12:01:25.582909 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 12:01:25.582909 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 12:01:25.582909 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 12:01:25.582909 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 12:01:27.301710 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 12:01:27.332960 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 12:01:27.332960 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 12:01:27.332960 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 12:01:27.348587 - rocketbot - INFO - For count: 2
2025-11-05 12:01:27.348587 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 12:01:27.364210 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 12:01:27.364210 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 12:01:27.364210 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 12:01:27.364210 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 12:01:27.364210 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 12:01:27.379837 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 12:01:27.395461 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 12:01:27.411090 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 12:01:27.411090 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 12:01:27.411090 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 12:01:27.426712 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 12:01:27.426712 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 12:01:27.426712 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 12:01:27.457962 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 12:01:27.457962 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 12:01:27.457962 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 12:01:27.457962 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 12:01:28.577002 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 12:01:28.577002 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 12:01:31.592107 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 12:01:32.094860 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 12:01:35.104049 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 12:01:35.510934 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 12:01:38.546209 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:38.561834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:38.561834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:38.561834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:38.561834 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:01:39.561866 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:01:39.749371 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:01:39.749371 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:01:40.749399 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:01:40.811903 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:01:40.811903 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:01:41.811932 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:01:41.890056 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:01:41.890056 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: 077d1075-b12c-9965-d8a7-3cf88dbd0dd0 -  - not {gblBandProceso}
2025-11-05 12:01:41.890056 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: b112488f-1d45-bb16-d707-bf2f8f67df37 -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = [\n        "codigo de usuario",  # campo loginz\n        "codigo de seguridad",  # campo password\n        "siesa",  # nombre producto\n        "autoriza el uso de esta copia",  # leyenda de legalidad\n        "serial:",  # info de copia\n    ]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de login de SIESA.")\n    SetVar('loc003PantallaLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de login.")\n    SetVar('loc003PantallaLogin', 'False')
2025-11-05 12:01:41.890056 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 426dceae-93ce-a7c3-be05-ddf332727196 -  - not {loc003PantallaLogin}
2025-11-05 12:01:41.905682 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.14 - rpascripts : module  id: 5af6ff3a-f147-325a-e567-0e1fda9863ad -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se abrio el aplicativo correctamente."}
2025-11-05 12:01:41.936937 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.15 - rpasystem : setVar  id: 8031df2f-282f-390b-bb25-292b6447ed93 -  - True
2025-11-05 12:01:41.936937 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.3 - rpalogic : evaluateIf  id: a847fa7d-da16-e9ae-e843-ff9dff9d2d18 -  - not {gblBandProceso}
2025-11-05 12:01:41.936937 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.4 - - 005_LoginSiesa8.5
2025-11-05 12:01:41.952559 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1 - rpalogic : trycatch  id: aec30957-3197-93af-7223-14ea505f6991 -  - 
2025-11-05 12:01:41.952559 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.1 - rpasystem : wait  id: 59fef937-baf8-54ee-afdd-cc2fc5d8f4a3 -  - 2
2025-11-05 12:01:43.952618 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.2 - rpasystem : setVar  id: 9b74d0a6-8ac8-3c9e-d1ba-7c96a728f2ea -  - False
2025-11-05 12:01:43.952618 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2c82a0f9-c7d6-a9f6-7b16-4ddb970e01ad -  - nameVentana = GetVar('loc005NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 12:01:44.468258 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: ed77a988-0f58-7dfb-c20f-70d6baefbfd9 -  - {"text":"{gblUsuarioSiesa85}"}
2025-11-05 12:01:44.843268 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.5 - rpasystem : wait  id: e9a6de64-0e74-73e5-670d-a8b92cc1f3ac -  - 1
2025-11-05 12:01:45.843297 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.6 - rpadesktop : send_keys  id: 2bd6ae86-c5e4-2b5d-df36-e88a0fce0989 -  - {"key":"TAB"}
2025-11-05 12:01:45.952684 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.7 - rpasystem : wait  id: 7b1f1dad-acad-3934-5889-b5f16e0d54e4 -  - 1
2025-11-05 12:01:46.952872 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.8 - rpadesktop : send_keys  id: 80da2a81-ddb9-8326-9e04-2cdfdda3f679 -  - {"text":"{gblContraseniaSiesa85}"}
2025-11-05 12:01:47.452721 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.9 - rpasystem : wait  id: f05879c0-db55-07f3-6820-9d729a573ad6 -  - 2
2025-11-05 12:01:49.456568 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:49.472192 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:49.472192 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:49.472192 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:49.472192 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:01:50.472221 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:01:50.659726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:01:50.659726 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:01:51.659760 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:01:51.769141 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:01:51.769141 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:01:52.784787 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:01:52.862913 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:01:52.862913 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.11 - rpalogic : evaluateIf  id: d8c02f65-2d08-d61e-0743-967498027923 -  - not {gblBandProceso}
2025-11-05 12:01:52.862913 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.12 - rpascripts : execscriptpython  id: 1592e55d-71a3-e6d0-0d25-512cfe3e187e -  - def es_pantalla_login(texto):\n    """\n    Valida si el texto recibido corresponde a la pantalla de login de SIESA.\n\n    Criterios:\n      - Debe estar la frase "Codigo de Usuario".\n      - Debe estar "SIESA" (puede estar en varias posiciones).\n      - Debe haber líneas de encabezado típicas como "autoriza el uso de esta copia"\n    """\n    from VortexLibrary import logger\n\n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    if not isinstance(texto, str):\n        logger.warning("El valor recibido para analizar pantalla de login no es string.")\n        return False\n\n    logger.info("Validando pantalla de login SIESA...")\n    patrones_requeridos = ["financiero"]\n    texto_min = texto.lower()\n\n    for patron in patrones_requeridos:\n        if patron not in texto_min:\n            logger.info(f"No se encontró el patrón requerido en pantalla: '{patron}'")\n            return False\n        else:\n            logger.info(f"Patrón encontrado: '{patron}'")\n\n    logger.info("Pantalla de login SIESA detectada exitosamente.")\n    return True\n\n\n# Ejemplo de uso:\nrespuesta_terminal = """{gblInfoPantalla}"""\n\nresultado = es_pantalla_login(respuesta_terminal)\n\nif resultado:\n    logger.info("Detectada pantalla de post login de SIESA.")\n    SetVar('loc005PantallaPostLogin', 'True')\nelse:\n    logger.info("No se detecta pantalla de post login.")\n    SetVar('loc005PantallaPostLogin', 'False')
2025-11-05 12:01:52.862913 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.13 - rpalogic : evaluateIf  id: 7a5f60f3-8dfe-6799-3131-ce376256b86d -  - not {loc005PantallaPostLogin}
2025-11-05 12:01:52.862913 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.14 - rpascripts : module  id: aed63aee-02f6-53bd-fa04-a552604571a0 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio sesion en el aplicativo correctamente."}
2025-11-05 12:01:52.909791 - rocketbot - INFO - request: 005_LoginSiesa8.5 : line 1.15 - rpasystem : setVar  id: 5e0b2982-75bb-ca83-f874-14db7a7eddae -  - True
2025-11-05 12:01:52.909791 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.5 - rpalogic : evaluateIf  id: aa6d3189-3fcc-88a2-9692-ed354c14a6c0 -  - not {gblBandProceso}
2025-11-05 12:01:52.909791 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.6 - - 006_NavegacionMenuSiesa
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1 - rpalogic : trycatch  id: d3008b59-47f2-b737-9f57-6651d000b2f0 -  - 
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.1 - rpascripts : module  id: 74be9457-75a7-933b-2757-68999e74ba38 -  - {"module_name":"System++","module":"cleanVars","vars":"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso"}
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.2 - rpasystem : setVar  id: c6db3640-60ca-0334-5e35-3d9d00e4d476 -  - False
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.3 - rpasystem : setVar  id: 2ee8f980-8483-115e-9f7f-392599ef36cc -  - False
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.4 - rpascripts : module  id: ffd8e0a3-51be-e786-0bb6-103a60c1005c -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5"}
2025-11-05 12:01:52.925419 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.5 - rpasystem : wait  id: 45462b1a-962d-5d6e-e184-b04ea64b960d -  - 1
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.6 - rpascripts : execscriptpython  id: 5803bb43-c912-27fc-731e-d849a814d484 -  - from VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc006ListaNavegacionSiesa", lista_listas)\n\nprint(lista_listas)\n
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:53.941070 - rocketbot - INFO - For count: 0
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:53.941070 - rocketbot - INFO - For count: 1
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:53.941070 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:54.003572 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:54.003572 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:55.003604 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:55.003604 - rocketbot - INFO - For count: 2
2025-11-05 12:01:55.003604 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:55.003604 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:55.003604 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:55.066104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:55.066104 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:56.066134 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:56.066134 - rocketbot - INFO - For count: 3
2025-11-05 12:01:56.066134 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:56.066134 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:56.066134 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:56.128636 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:56.128636 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:57.131363 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:57.131363 - rocketbot - INFO - For count: 4
2025-11-05 12:01:57.131363 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:57.131363 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:57.131363 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:57.193865 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:57.193865 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:58.195595 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:58.195595 - rocketbot - INFO - For count: 5
2025-11-05 12:01:58.195595 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.1 - rpasystem : setVar  id: 170498e8-1298-8bee-fd74-c6b1295c088c -  - {Loc006ItemACtual}[0]
2025-11-05 12:01:58.195595 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.2 - rpasystem : setVar  id: 259036b6-b221-30ef-db01-113ca88bc04f -  - {Loc006ItemACtual}[1]
2025-11-05 12:01:58.195595 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.3 - rpadesktop : send_keys  id: 04147493-5a16-accd-4977-335743b0b66a -  - {"text":"{Loc006LetraNavegacion}"}
2025-11-05 12:01:58.258094 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.4 - rpascripts : module  id: d80279e8-b706-f040-8ccd-b6211110a164 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}"}
2025-11-05 12:01:58.258094 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7.5 - rpasystem : wait  id: 374ded0c-f517-dd68-89d2-3db3e94e6ceb -  - 1
2025-11-05 12:01:59.262152 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.7 - rpalogic : for  id: 6da8cac0-6bd0-6d8d-0dae-338fb628f711 -  - {"iterable":"{loc006ListaNavegacionSiesa}","count":0}
2025-11-05 12:01:59.262152 - rocketbot - INFO - For count: 5
2025-11-05 12:01:59.262152 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:01:59.277777 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:01:59.277777 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:01:59.277777 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:01:59.277777 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:02:00.290732 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:02:00.465790 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:02:00.465790 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:02:01.469058 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:02:01.531364 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:02:01.531364 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:02:02.535316 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:02:02.613441 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:02:02.691571 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9 - rpalogic : evaluateIf  id: 03d92ef7-40ff-32ff-f929-ea6fe8cce140 -  - """{gblInfoPantalla}""" != ""
2025-11-05 12:02:02.691571 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.9.1 - rpascripts : execscriptpython  id: 680f0eab-2d63-cb78-681d-6d310ae1d1b0 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("empresa")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc006ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc006ContinuarProceso", False)
2025-11-05 12:02:02.707197 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.10 - rpalogic : evaluateIf  id: 026a5ed0-e9a0-db8f-7885-1550609ec9aa -  - not {loc006ContinuarProceso}
2025-11-05 12:02:02.707197 - rocketbot - INFO - request: 006_NavegacionMenuSiesa : line 1.11 - rpasystem : setVar  id: 50a6f971-6d9e-ef34-9532-e634d271b504 -  - True
2025-11-05 12:02:02.707197 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.7 - rpalogic : evaluateIf  id: fbb3ebb9-0bbc-08e7-21ab-b4aabf3b5566 -  - not {gblBandProceso}
2025-11-05 12:02:02.707197 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8 - - 022_IngresoFacturaSiesa
2025-11-05 12:02:02.722823 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1 - rpalogic : trycatch  id: 19e15d07-8d5d-6822-d52c-ce656297bf4f -  - 
2025-11-05 12:02:02.722823 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.1 - rpascripts : module  id: 2e0d824f-eef5-b5eb-c8c9-8f5fc8367b4a -  - {"module_name":"System++","module":"cleanVars","vars":"loc022ListaIngresoInformacion,loc022ItemActual,loc022ValorOpcion,loc022NombreOpcion,loc022ContinuarProceso"}
2025-11-05 12:02:02.722823 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.2 - rpasystem : setVar  id: 64a65984-2395-df12-ab3c-a16e62ac2253 -  - False
2025-11-05 12:02:02.722823 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.3 - rpasystem : setVar  id: 346e7071-bdda-4847-dfa8-eab346718909 -  - False
2025-11-05 12:02:02.722823 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.4 - rpasystem : wait  id: aab379c3-e643-c31e-ecdd-3167cb3e927d -  - 3
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.5 - rpascripts : execscriptpython  id: 8454e51d-6443-7b97-9da7-5b6d6c3b5a23 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Inicialización del diccionario\ndiccionario = {}\n\n# Obtención de variables globales\n#empresa = GetVar("gblPrefijoEmpresa")\n#centro_costos = GetVar("gblCentroDeCostos")\n#tipo_documento = GetVar("gblTipoDeDocumento")\n#numero_documento = GetVar("gblNumeroDocumento")\nitem = {gblItemActual}\n\n# Construcción del diccionario con la información que se ingresará en el aplicativo Siesa 8.5\ndiccionario["Empresa"] = "TI" if item["Empresa"].strip().lower() == "ticenergi" else "EN"\ndiccionario["Centro de costos"] = "001"\ndiccionario["Tipo de documento"] = item["Tipo Docto"]\ndiccionario["Número de documento"] = item["Nro Docto"]\n\n# Registro informativo del contenido que se enviará\nlogger.info(f"Se ingresará la información de la factura en el aplicativo Siesa 8.5 de la siguiente manera: {diccionario}")\n\n# Convertir el diccionario en una lista de listas (clave, valor)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar("loc022ListaIngresoInformacion", lista_listas)
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:05.736019 - rocketbot - INFO - For count: 0
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:05.736019 - rocketbot - INFO - For count: 1
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:02:05.736019 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:02:05.861024 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:02:05.861024 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:02:06.870756 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:06.870756 - rocketbot - INFO - For count: 2
2025-11-05 12:02:06.870756 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:02:06.870756 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:02:06.870756 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:02:07.058267 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:02:07.058267 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:02:08.073920 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:08.073920 - rocketbot - INFO - For count: 3
2025-11-05 12:02:08.073920 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:02:08.073920 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:02:08.073920 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:02:08.198925 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:02:08.245802 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:02:09.254306 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:09.254306 - rocketbot - INFO - For count: 4
2025-11-05 12:02:09.254306 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.1 - rpasystem : setVar  id: 4718a463-997b-fb3b-47ed-a6ef85448447 -  - {loc022ItemActual}[0]
2025-11-05 12:02:09.254306 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.2 - rpasystem : setVar  id: 65033dbc-3443-4d5f-9eac-c7aa41005595 -  - {loc022ItemActual}[1]
2025-11-05 12:02:09.254306 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.3 - rpadesktop : send_keys  id: 6be04214-4021-5890-6572-ba4980d87137 -  - {"text":"{loc022ValorOpcion}"}
2025-11-05 12:02:09.441848 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.4 - rpascripts : module  id: 1624a967-1efa-8e0b-f9f3-c9519a6a3c42 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"A continuacion se ingresara la informacion en el aplicativo Siesa 8.5. Opcion en la que se ingresara la informacion: {loc022NombreOpcion}. Valor que se ingresara: {loc022ValorOpcion}"}
2025-11-05 12:02:09.441848 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6.5 - rpasystem : wait  id: 0c7fed35-b382-d9d8-ace3-1ce877583b8a -  - 1
2025-11-05 12:02:10.449270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.6 - rpalogic : for  id: 29eb5feb-8b91-a873-f1f2-3aa7ae3df98e -  - {"iterable":"{loc022ListaIngresoInformacion}","count":0}
2025-11-05 12:02:10.449270 - rocketbot - INFO - For count: 4
2025-11-05 12:02:10.449270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.7 - rpascripts : module  id: 22f660a1-9920-3b46-8c5e-5b46e1e111b9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se envio un enter para confirmar el numero de documento ingresado"}
2025-11-05 12:02:10.449270 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.8 - rpadesktop : send_keys  id: 6efa36a2-c5e5-11e9-84fe-a3dd0f10f4be -  - {"key":"ENTER"}
2025-11-05 12:02:10.558649 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.9 - rpasystem : wait  id: 04edb12e-ff30-113e-182c-8f765c1c0fa5 -  - 1
2025-11-05 12:02:11.560348 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.10 - rpadesktop : send_keys  id: 76d049ad-15e0-5554-2b9e-72d15dde9402 -  - {"text":"2"}
2025-11-05 12:02:11.622851 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.11 - rpasystem : wait  id: 25626bbd-0d69-5894-daec-effff4debadb -  - 1
2025-11-05 12:02:12.623524 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.12 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:02:12.639148 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:02:12.639148 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:02:12.639148 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:02:12.639148 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:02:13.639183 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:02:13.827155 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:02:13.827155 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:02:14.839157 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:02:14.901662 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:02:14.901662 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:02:15.902876 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13 - rpalogic : evaluateIf  id: 9d090eb6-bfbd-8b83-99d4-c41f02f3350c -  - """{gblInfoPantalla}""" != ""
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.13.1 - rpascripts : execscriptpython  id: a09c2704-b0f5-b0b6-9c83-23198dc548b8 -  - from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar("gblInfoPantalla")\nlogger.info("Se obtiene la información del portapapeles")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find("contabilizacion")\n\nif palabra_referencia != -1:\n    logger.info("Se encontró la palabra de referencia 'contabilizacion' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente")\n    SetVar("loc022ContinuarProceso", True)\nelse:\n    logger.info("No fue posible encontrar la palabra de referencia 'contabilizacion', la navegación no se realizó con éxito")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar("loc022ContinuarProceso", False)
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.14 - rpalogic : evaluateIf  id: 32410a28-3fe1-da5e-8f7e-961a22059976 -  - not {loc022ContinuarProceso}
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 022_IngresoFacturaSiesa : line 1.15 - rpasystem : setVar  id: 95751de0-5dbf-b255-96db-e536c8e4db61 -  - True
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.9 - rpalogic : evaluateIf  id: ba31eb21-16b3-508b-2790-378fe1be25fb -  - not {gblBandProceso}
2025-11-05 12:02:15.981004 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 024_ConsultaDocAlt
2025-11-05 12:02:15.996627 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1 - rpalogic : trycatch  id: d73307f6-19e2-4a35-b2d3-c5e8a63051f9 -  - 
2025-11-05 12:02:16.012252 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.1 - rpascripts : module  id: e5d87448-f18c-5917-eb09-e05c7ba3d658 -  - {"module_name":"System++","module":"cleanVars","vars":"loc024ContinuarProceso"}
2025-11-05 12:02:16.012252 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.2 - rpasystem : setVar  id: 046a05ec-5df0-8bd6-88e1-fd83759b8636 -  - False
2025-11-05 12:02:16.012252 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.3 - rpasystem : wait  id: d004a9af-a1fa-a839-e424-52d83cd12c26 -  - 3
2025-11-05 12:02:19.021982 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.4 - rpascripts : module  id: cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se inicia el bot que obtiene la informacion correspondiente a doc_alt"}
2025-11-05 12:02:19.021982 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.5 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:02:19.037597 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:02:19.037597 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:02:19.037597 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:02:19.037597 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:02:20.037630 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:02:20.225136 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:02:20.225136 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:02:21.225169 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:02:21.287673 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:02:21.287673 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
2025-11-05 12:02:22.288933 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.10 - rpascripts : module  id: 48a1d356-892b-85e1-72ac-998173bbea84 -  - {"module_name":"clipboard","module":"getClipboard","var_":"gblInfoPantalla"}
2025-11-05 12:02:22.367089 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.11 - rpasystem : setVar  id: f2ff01d2-d37a-8119-ca89-51981835da8c -  - True
2025-11-05 12:02:22.367089 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6 - rpalogic : evaluateIf  id: bb064d9c-3219-c52b-ec3c-bee8deb61910 -  - """{gblInfoPantalla}""" != "" 
2025-11-05 12:02:22.367089 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.1 - rpascripts : module  id: e5a368f7-88a0-16f4-2fec-c2731f534f41 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles: {gblInfoPantalla}"}
2025-11-05 12:02:22.367089 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.6.2 - rpascripts : execscriptpython  id: 7002b697-980d-6d7a-ebec-0745624fb7a3 -  - \nglobal logger\n\nimport re\nfrom VortexLibrary import logger\n# Configuración inicial del logger\nlogger.log_path = GetVar("gblRutaLogs")  # Se debe usar GetVar para obtener la ruta real\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    \n    logger.info("Iniciando extracción de información de Siesa.")\n\n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:']\n    logger.info(f"Lista de patrones utilizados para buscar doc_alt: {listaConcidencias}")\n    doct_alt = ""\n    doc_alt_encontrado = False\n    for item in listaConcidencias:\n        logger.info(f"Buscando patrón de doc_alt: {item}")\n        match = re.search(rf"{re.escape(item)}\s*([A-Za-z0-9-\s]+)\|", texto)\n        if match:\n            logger.info(f"Patrón de doc_alt encontrado: {item}")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f"Valor extraído de doc_alt: '{doct_alt}'")\n            doc_alt_encontrado = True\n            break  # Se toma la primera coincidencia encontrada\n    if not doc_alt_encontrado:\n        logger.warning("No se encontró ningún campo doc_alt en el texto de entrada.")\n\n    # Buscar Doc_Ref\n    logger.info("Buscando el campo Doc_Ref en el texto de entrada.")\n    doc_ref_match = re.search(r"Doc_Ref\.\s*:\s*([A-Za-z0-9-]*)", texto)\n    if doc_ref_match:\n        doc_ref = doc_ref_match.group(1)\n        logger.info(f"Valor extraído de Doc_Ref: '{doc_ref}'")\n    else:\n        doc_ref = ""\n        logger.warning("No se encontró ningún campo Doc_Ref en el texto de entrada.")\n    \n    diccionarioelementos["Doct_Alt"] = doct_alt\n    diccionarioelementos["Doc_Ref"] = doc_ref\n\n    logger.info(f"Diccionario elementos extraído: {diccionarioelementos}")\n    return diccionarioelementos\n\n\n\nlogger.info("Obteniendo variable 'gblInfoPantalla' para procesar en obtenerInfoSiesa.")\ntexto = GetVar('gblInfoPantalla')\nlogger.info(f"Texto de entrada: {texto[:500]}{'...' if len(texto) > 500 else ''}")  # log parcial por si es grande\ndiccionarioelementos = obtenerInfoSiesa(texto)\nlogger.info(f"Diccionario de elementos finales: {diccionarioelementos}")\nSetVar('loc024DiccionarioDocAltSiesa', diccionarioelementos)
2025-11-05 12:02:22.382715 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7 - rpalogic : group  id: e4675e46-ce5b-2288-aedd-af947f7d4201 -  - 
2025-11-05 12:02:22.382715 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.1 - rpascripts : execscriptpython  id: 3bbd9292-c618-d2ab-71ee-9d00aa5059c0 -  - item = {gblItemActual}\n\nitem["Doc Alt"] = {loc024DiccionarioDocAltSiesa}.get('Doct_Alt')\n\nSetVar("gblItemActual",item)
2025-11-05 12:02:22.382715 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.7.2 - rpascripts : module  id: d7e6a312-83ea-b86a-887c-b76a885ca241 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblItemActual}"}
2025-11-05 12:02:22.398330 - rocketbot - INFO - request: 024_ConsultaDocAlt : line 1.8 - rpasystem : setVar  id: eff22e15-b4a9-301c-7ee7-ddf353b52f4b -  - True
2025-11-05 12:02:22.398330 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.11 - rpalogic : evaluateIf  id: 55008d30-1f9a-52b6-c9cf-bafc7859f61f -  - not {gblBandProceso}
2025-11-05 12:02:22.413955 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.12 - rpascripts : execscriptpython  id: c18eeeaa-9141-2649-079f-7dd281ae7ec6 -  - import re\n"""\nReglas que se deben cumplir:\n- Si tiene más de dos letras, descartado\n- Si tiene la letra 'p', pasa\n- Si son solo números, pasa\n"""\n\ntry:\n    item = {gblItemActual}\n    docAlt = item["Doc Alt"]\n    #docRef = GetVar('gblDocRef')\n    \n    if docAlt == "":\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt se encuentra vacio")\n\n    # Validamos la cantidad de letras\n    letras = re.findall(r"[A-Za-z]", docAlt)\n    if len(letras) >= 2:\n        SetVar('loc025DocAltInvalido', False)\n        raise ValueError("El doc_Alt contiene dos o mas letras, no pasa las reglas de negocio")\n\n    # Validamos si contiene la letra 'p'\n    if 'p' in docAlt.lower():  # se asegura de detectar 'p' mayúscula o minúscula\n        docAlt = docAlt.replace("p", "").replace("P", "").strip()\n        item["Nro de Proceso"] = docAlt\n        \n        SetVar('loc025DocAltInvalido', True)\n        raise ValueError("Se identifica la letra 'p' en docAlt, se puede continuar con el proceso")\n    \n    docAlt = docAlt.strip()\n    item["Nro de Proceso"] = docAlt\n    \n    SetVar('loc025DocAltInvalido', True)\n    SetVar("gblItemActual",item)\n\nexcept ValueError as e:\n    print(f"aviso: {e}")
2025-11-05 12:02:22.413955 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13 - rpalogic : evaluateIf  id: 3b29b7f5-a61a-1f90-c75b-63d634742d17 -  - not {loc025DocAltInvalido}
2025-11-05 12:02:22.413955 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.1 - rpascripts : module  id: 20ae6fa6-705b-3eeb-7be8-18339b718cf0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"warning","text":"El doc_alt obtenido en Siesa 8.5 no cumple las reglas de negocio; no es posible continuar con el proceso. doc_alt obtenido: {gblItemActual}"}
2025-11-05 12:02:22.413955 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.13.2 - rpascripts : execscriptpython  id: ac9454f3-09c0-30f2-d301-9754bd5eb21b -  - item = {gblItemActual}\ndocAlt = item["Doc Alt"]\n\nif docAlt != "":\n    #item['Doc Alt'] = "No cumple reglas de negocio"\n    item['Observaciones'] = f"El doc_alt encontrado en el aplicativo Siesa no cumple con las reglas de negocio. doc_alt encontrado: {docAlt}"\nelse:\n    #item['Doc Alt'] = "no se encontro"\n    item['Observaciones'] = "La opcion doc_alt encontrada en siesa no contiene informacion."\n\nitem["Estado Procesamiento"] = "Buscado por Numero de Proceso"\nSetVar("gblItemActual", item)
2025-11-05 12:02:22.413955 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.13.3 - - 026_CerrarAplicativoSiesa
2025-11-05 12:02:22.429585 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1 - rpalogic : trycatch  id: 47bc170b-eee3-550d-c059-eaa356148a92 -  - 
2025-11-05 12:02:22.429585 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.1 - rpascripts : module  id: b058e209-a7e6-fc41-b6cd-9053ef18bfd9 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Inicia Bot encargado de cerrar el aplicativo siesa 8.5"}
2025-11-05 12:02:22.445210 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.2 - rpasystem : setVar  id: 102e7774-766a-62a6-d0d2-1041ade3b857 -  - False
2025-11-05 12:02:22.445210 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.3 - rpascripts : execscriptpython  id: 5e1407a6-b9f2-aafa-e3ff-2d89dad20ea7 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\ndef cerrar_putty():\n    import psutil\n\n    try:\n        nombre_proceso = "putty.exe"\n        procesos_cerrados = 0\n\n        # Buscar todos los procesos activos\n        for proceso in psutil.process_iter(['pid', 'name']):\n            try:\n                if proceso.info['name'] and proceso.info['name'].lower() == nombre_proceso.lower():\n                    logger.info(f"Intentando cerrar {proceso.info['name']} (PID {proceso.pid})")\n\n                    # Cerrar hijos primero (si existen)\n                    hijos = proceso.children(recursive=True)\n                    for hijo in hijos:\n                        try:\n                            logger.info(f"Cerrando hijo: {hijo.name()} (PID {hijo.pid})")\n                            hijo.terminate()\n                        except Exception as e:\n                            logger.warning(f"No se pudo cerrar hijo PID {hijo.pid}: {e}")\n\n                    # Esperar a que los hijos terminen\n                    psutil.wait_procs(hijos, timeout=5)\n\n                    # Terminar el proceso principal\n                    proceso.terminate()\n                    proceso.wait(timeout=5)\n\n                    logger.info(f"Proceso {nombre_proceso} (PID {proceso.pid}) cerrado exitosamente.")\n                    procesos_cerrados += 1\n\n            except (psutil.NoSuchProcess, psutil.AccessDenied):\n                continue\n\n        if procesos_cerrados == 0:\n            msg = f"No se encontró ningun proceso activo con el nombre {nombre_proceso}."\n            print(msg)\n            logger.warning(msg)\n            SetVar('loc026ContinuarProceso', False)\n        else:\n            msg_success = f"Se cerraron {procesos_cerrados} instancia(s) de {nombre_proceso}."\n            print(msg_success)\n            logger.info(msg_success)\n            SetVar('loc026ContinuarProceso', True)\n\n    except Exception as e:\n        msg_error = f"Error al intentar cerrar procesos {nombre_proceso}: {e}"\n        print(msg_error)\n        SetVar('loc026ContinuarProceso', False)\n        logger.warning(msg_error)\n        raise\n\n\n# Ejecutamos la función\ncerrar_putty()
2025-11-05 12:02:22.476459 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.4 - rpalogic : evaluateIf  id: 4b1529b8-f5b1-d336-dd27-d0dd28207268 -  - not {loc026ContinuarProceso}
2025-11-05 12:02:22.476459 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.5 - rpascripts : module  id: ab698d53-feb3-2d6f-d968-7d289ddb84e0 -  - {"module_name":"sendToLogs","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se cerro correctamente el aplicativo Siesa 8.5"}
2025-11-05 12:02:22.492084 - rocketbot - INFO - request: 026_CerrarAplicativoSiesa : line 1.6 - rpasystem : setVar  id: 8ee14f29-8c6b-0105-aa95-d92a2e685f1d -  - True
2025-11-05 12:02:22.507712 - rocketbot - INFO - request: scripts : line 1.13.4 - rpascripts : stop - id: a097e819-6a25-1066-2407-5e15dd2f7a3b- - 
2025-11-05 12:02:22.523337 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8.2 - rpalogic : evaluateIf  id: f1209a06-27c8-8878-48f3-4b8d110a9c2c -  - not {gblBandProceso}
2025-11-05 12:02:22.523337 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.9 - rpasystem : setVar  id: f391a538-2467-74c5-b329-4b1e4bb46a82 -  - True
2025-11-05 12:02:22.523337 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.3 - - 020_ActualizarArchivoDeSeguimiento
2025-11-05 12:02:22.538961 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1 - rpalogic : trycatch  id: 5e5f2e68-5eb4-e159-78a1-f2cd7b7d2e65 -  - 
2025-11-05 12:02:22.538961 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.1 - rpasystem : setVar  id: eef211a6-7519-a87d-8265-1fc55d6a4955 -  - False
2025-11-05 12:02:22.538961 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.2 - rpascripts : module  id: d0e81fc6-575f-7011-38e9-41640639161e -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza la actualizacion del archivo de seguimiento."}
2025-11-05 12:02:22.554585 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.3 - rpascripts : execpython  id: 9f2bed1c-3659-4f97-2bb4-3b6851ebbcff -  - {gblRutaScripts}/ActualizarArchivoDeSeguimiento.py
2025-11-05 12:02:24.304644 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.4 - rpascripts : module  id: ac6a83fb-0cbc-482c-d919-b0c62d5f6d6c -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Actualización de archivo de seguimiento exitosa."}
2025-11-05 12:02:24.335896 - rocketbot - INFO - request: 020_ActualizarArchivoDeSeguimiento : line 1.5 - rpasystem : setVar  id: ecacfeb1-724b-51dd-e64b-b15d909ffde5 -  - True
2025-11-05 12:02:24.335896 - rocketbot - INFO - request: 000_MasterProceso : line 8.1.4 - rpalogic : evaluateIf  id: a3ff1aaf-71dd-b05d-d86f-f08973ff99cb -  - not {gblBandProceso}
2025-11-05 12:02:24.335896 - rocketbot - INFO - request: 000_MasterProceso : line 8.1 - rpalogic : for  id: a6582a5a-9fe1-495b-9e5a-59ad81601287 -  - {"iterable":"{gblItemsAProcesar}","count":0}
2025-11-05 12:02:24.351519 - rocketbot - INFO - For count: 3
2025-11-05 12:02:24.351519 - rocketbot - INFO - request: scripts : execRocketBotDB : line 8.1.1 - - 018_ProcesarRegistro
2025-11-05 12:02:24.367153 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1 - rpalogic : trycatch  id: 4c2e4868-c950-6199-a507-6bca1e960e73 -  - 
2025-11-05 12:02:24.367153 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.1 - rpasystem : setVar  id: e9315313-62f9-5127-b5c2-cd2752a36d5f -  - False
2025-11-05 12:02:24.367153 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.2 - rpascripts : module  id: 78279ff1-7bfe-c873-44aa-1432de02a918 -  - {"module_name":"System++","module":"cleanVars","vars":"loc018FlujoAProcesar"}
2025-11-05 12:02:24.367153 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.3 - rpascripts : module  id: bf21b7ed-d3f9-e6c7-ef84-98743ba65986 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Comienza el procesamiento del registro: {gblItemActual}"}
2025-11-05 12:02:24.382774 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.4 - rpascripts : module  id: 1d58a1a4-02ce-b105-bf2d-995e2e30c36a -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se procede a clasificar curso de accion a tomar."}
2025-11-05 12:02:24.398399 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.5 - rpascripts : execscriptpython  id: c0dca269-bd13-7494-84d6-0d4dec680be2 -  - if {gblItemActual}['Documento Cruce'] != '':\n  SetVar("loc018FlujoAProcesar",1)\n  \nSetVar("gblNroDoc",{gblItemActual}["Nro Docto"])\nSetVar("gblTipoDoc",{gblItemActual}["Tipo Docto"])
2025-11-05 12:02:24.398399 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.6 - rpascripts : module  id: 49a582ed-1999-b65d-3868-0ddd9c3087fb -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Flujo a trabajar: {loc018FlujoAProcesar}"}
2025-11-05 12:02:24.414032 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.7 - rpalogic : evaluateIf  id: 537e6f13-402e-b86b-8e8d-af808ed0f748 -  - {gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] != "" 
2025-11-05 12:02:24.414032 - rocketbot - INFO - request: 018_ProcesarRegistro : line 1.8 - rpalogic : evaluateIf  id: e279c809-9d32-0a6a-d972-834b6c92fb81 -  - {gblItemActual}["Estado Procesamiento"] == "Buscado por Documento Cruce" or ({gblItemActual}["Estado Procesamiento"] == "Pendiente" and {gblItemActual}["Documento Cruce"] == "" )
2025-11-05 12:02:24.414032 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.8.1 - - 025_ProcesarFlujo2
2025-11-05 12:02:24.429648 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1 - rpalogic : trycatch  id: fbd940bf-555a-9d67-e0e9-188ccb3f1a67 -  - 
2025-11-05 12:02:24.429648 - rocketbot - INFO - request: 025_ProcesarFlujo2 : line 1.1 - rpasystem : setVar  id: 52020385-5c3f-6da3-0ed1-eb91a1db97c8 -  - False
2025-11-05 12:02:24.429648 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.2 - - 003_AbrirSiesa8.5
2025-11-05 12:02:24.445271 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1 - rpalogic : trycatch  id: 791cf817-563a-4f8a-a892-2f5c13f8a36e -  - 
2025-11-05 12:02:24.445271 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.1 - rpasystem : setVar  id: 5e12baab-e255-ea0d-9a48-fd92d4649a9b -  - False
2025-11-05 12:02:24.445271 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.2 - rpascripts : module  id: b83d9f90-44c6-67a9-64cc-6513db8480af -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a iniciar el aplicativo de Siesa 8.5."}
2025-11-05 12:02:24.460898 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.3 - rpascripts : execscriptpython  id: 2ff61e90-2c0d-9eb4-1c00-11eba88d6842 -  - import pyautogui\nfrom time import sleep\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nlogger.info("Esperando 1 segundo antes de ejecutar pyautogui.hotkey('win', 'd').")\nsleep(1)  # (Opcional) Te da 1 seg antes de ejecutar\nlogger.info("Enviando hotkey 'win' + 'd' para mostrar el escritorio.")\npyautogui.hotkey('win', 'd')
2025-11-05 12:02:25.570747 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.4 - rpascripts : execscriptpython  id: 11b41548-f3b0-c1b8-7b10-217e8309faa1 -  - global logger\n\nfrom VortexLibrary import logger \nlogger.log_path = "{gblRutaLogs}"\nlogger.task_name = tmp_global_obj["profile"]["name"]\n\nruta = GetVar('loc003RutaEjecutable')\n\ndef ejecutar_exe(ruta_exe):\n    import os\n    import subprocess\n\n    # Verifica si el ejecutable existe en la ruta obtenida\n    if not os.path.exists(ruta_exe):\n        msg = f"El archivo no existe en la ruta: {ruta_exe}"\n        print(msg)\n        logger.warning(msg)\n        return\n    \n    try:\n        # Ejecutamos el ejecutable .exe de siesa 8.5\n        logger.info(f"Intentando ejecutar: {ruta_exe}")\n        subprocess.Popen(ruta_exe, shell=True)\n        msg_success = f"Ejecutando: {ruta_exe}"\n        print(msg_success)\n        logger.info(msg_success)\n    except Exception as e:\n        msg_error = f"Error al ejecutar el archivo: {e}"\n        print(msg_error)\n        logger.warning(msg_error)\n        raise e\n\n\n# Ejecutamos la función creada\nejecutar_exe(ruta)\n
2025-11-05 12:02:25.570747 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.5 - rpasystem : wait  id: f9c8b549-af85-eb6c-42c6-ba1b161756a9 -  - 3
2025-11-05 12:02:28.580093 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.6 - rpascripts : execscriptpython  id: d35d18bc-2a8d-b8ca-d532-30462da9739e -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef enfocar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando enfocar.")\n\n    ventana.activate()\n    sleep(0.5)\n\n    msg_success = f"Ventana enfocada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\n\nenfocar_ventana(nameVentana)
2025-11-05 12:02:29.095735 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.7 - rpasystem : wait  id: 58c12eaa-3eec-4dca-f7f1-eed5886bc3c5 -  - 3
2025-11-05 12:02:32.108574 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.8 - rpascripts : execscriptpython  id: 6c8a0ef1-3a77-8e60-a1f7-0d3a56c2950a -  - nameVentana = GetVar('loc003NombreVetana')\n\ndef maximizar_ventana(nombre):\n    import pygetwindow as gw\n    from time import sleep\n\n    from VortexLibrary import logger \n    logger.log_path = "{gblRutaLogs}"\n    logger.task_name = tmp_global_obj["profile"]["name"]\n\n    logger.info(f"Buscando ventanas abiertas para encontrar coincidencia con el nombre: '{nombre}'")\n    ventanas = gw.getAllTitles()\n    logger.info(f"Títulos de ventanas encontradas: {ventanas}")\n\n    coincidencias = [v for v in ventanas if nombre.lower() in v.lower() and v.strip() != ""]\n\n    if not coincidencias:\n        msg = f"No se encontró ninguna ventana con el nombre que contenga: '{nombre}'"\n        print(msg)\n        logger.warning(msg)\n        return\n\n    ventana = gw.getWindowsWithTitle(coincidencias[0])[0]\n    logger.info(f"Ventana encontrada con coincidencia: '{ventana.title}'. Intentando maximizar y enfocar.")\n\n    ventana.activate()\n    sleep(0.3)  # pequeña pausa para asegurar el enfoque\n    ventana.maximize()\n\n    msg_success = f"Ventana maximizada: {ventana.title}"\n    logger.info(msg_success)\n    print(msg_success)\n\nmaximizar_ventana(nameVentana)\n
2025-11-05 12:02:32.436708 - rocketbot - INFO - request: 003_AbrirSiesa8.5 : line 1.9 - rpasystem : wait  id: 2f34a246-8596-d1f7-ecb3-5f07f4cd35c8 -  - 3
2025-11-05 12:02:35.446649 - rocketbot - INFO - request: scripts : execRocketBotDB : line 1.10 - - 004_ObtenerInformacionDePantallaSiesa8.5
2025-11-05 12:02:35.462281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1 - rpalogic : trycatch  id: fa7c7061-0859-fcb6-9723-125ee17cc020 -  - 
2025-11-05 12:02:35.462281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.1 - rpasystem : setVar  id: a0717771-b651-c0cf-891f-3edb9bd05bbe -  - False
2025-11-05 12:02:35.462281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.2 - rpascripts : module  id: 1423ff36-a9f9-bfc7-a676-1688d9bd5ea4 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"info","text":"Se va a extraer el texto de la pantalla de Siesa8.5."}
2025-11-05 12:02:35.462281 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.3 - rpasystem : wait  id: f7cbe75d-c290-455d-ef71-5aed7486c17e -  - 1
2025-11-05 12:02:36.477939 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.4 - rpadesktop : send_keys  id: 17f67f4b-e9fc-4d46-0818-18407aa74b2a -  - {"text":"%{SPACE}"}
2025-11-05 12:02:36.665438 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.5 - rpascripts : module  id: 006abc75-e673-6c2d-31c3-24bd51157cf8 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Se abre menu contextual."}
2025-11-05 12:02:36.665438 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.6 - rpasystem : wait  id: 30428fbb-ffa5-73dc-0be2-2608b4c0cc24 -  - 1
2025-11-05 12:02:37.667090 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.7 - rpadesktop : send_keys  id: 251f900c-e1d9-ea83-dff5-c2baf916fe7f -  - {"text":"o"}
2025-11-05 12:02:37.729593 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.8 - rpascripts : module  id: a40c5f60-941b-be13-5d67-86a2ebeb3c04 -  - {"module_name":"Vortex-Utils","module":"sendText","path":"{gblRutaLogs}","infoType":"trace","text":"Copiar al portapapeles."}
2025-11-05 12:02:37.729593 - rocketbot - INFO - request: 004_ObtenerInformacionDePantallaSiesa8.5 : line 1.9 - rpasystem : wait  id: dd7d7ecd-aaeb-fd97-889a-79d99f19bd89 -  - 1
