{"project":{"commands":[{"father":"trycatch","command":"","id":"d73307f6-19e2-4a35-b2d3-c5e8a63051f9","group":"logic","mode_live":false,"children":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"loc024ContinuarProceso\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"cleanVars","id":"e5d87448-f18c-5917-eb09-e05c7ba3d658","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.00299835205078125","extra":[]},{"father":"wait","command":"3","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"d004a9af-a1fa-a839-e424-52d83cd12c26","group":"system","mode_live":false,"children":[],"else":[],"line":"1.2","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"3.062572956085205","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"info\",\"text\":\"Se inicia el bot que obtiene la informacion correspondiente a doc_alt y doc_ref\"}","index":2,"execute_debugg":0,"img":"","screenshot":"","line":"1.3","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"cf5cf9a9-19e8-0bec-6184-6ee542cbb8f0","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"setVar","command":"False","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"046a05ec-5df0-8bd6-88e1-fd83759b8636","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.4","description":"Inicializamos la bandera del proceso","execute":2,"index":3,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":[]},{"father":"execRocketBotDB","command":"004_ObtenerInformacionDePantallaSiesa8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"e45f6af4-e55b-61dc-4e4a-9d6f862a211f","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.5","execute":2,"index":4,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"3.3282082080841064","extra":[]},{"father":"evaluateIf","command":"\"\"\"{gblInfoPantalla}\"\"\" != \"\" ","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"bb064d9c-3219-c52b-ec3c-bee8deb61910","group":"logic","mode_live":false,"children":[{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"Se obtuvo la informacion contenida en el aplicativo Siesa 8.5 desde el portapapeles\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.6.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"e5a368f7-88a0-16f4-2fec-c2731f534f41","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"execScriptPython","command":"import re\n\ndef obtenerInfoSiesa(texto: str) -> dict:\n    import re\n    from VortexLibrary import logger\n    # Configuración inicial del logger\n    logger.log_path = GetVar(\"gblRutaLogs\")  # Se debe usar GetVar para obtener la ruta real\n    logger.task_name = tmp_global_obj[\"profile\"][\"name\"]\n    \n    diccionarioelementos = {}\n\n    # Lista de posibles coincidencias para Doc_Alt\n    listaConcidencias = ['Doct_Alt:', 'Doc.Alt.:', 'Doc_alt:', 'Doc.Alt:']\n    logger.info(f\"Esta es la lista de coincidencias que se buscaron para el campo doc_alt: {listaConcidencias}\")\n    doct_alt = \"\"\n    for item in listaConcidencias:\n        match = re.search(rf\"{re.escape(item)}\\s*([A-Za-z0-9-\\s]+)\\|\", texto)\n        if match:\n            logger.info(f\"Esta fue la coincidencia de doc_alt que se encontro en el aplicativo Siesa 8.5: {item}\")\n            doct_alt = match.group(1)\n            doct_alt = doct_alt.strip()\n            logger.info(f\"Esta es la informacion obtenida de la opcion doc_alt: {doct_alt}\")\n            break  # Se toma la primera coincidencia encontrada\n\n    # Buscar Doc_Ref\n    doc_ref_match = re.search(r\"Doc_Ref\\.\\s*:\\s*([A-Za-z0-9-]*)\", texto)\n    doc_ref = doc_ref_match.group(1) if doc_ref_match else \"\"\n    \n    diccionarioelementos[\"Doct_Alt\"] = doct_alt\n    diccionarioelementos[\"Doc_Ref\"] = doc_ref\n    \n    return diccionarioelementos\n\n\n# Ejemplo de prueba\ntexto = GetVar('gblInfoPantalla')\ndiccionarioelementos = obtenerInfoSiesa(texto)\nSetVar('gblDiccionarioDocAltSiesa', diccionarioelementos)","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"1.6.2","description":"obtenemos la informacion establecida en Doc_Alt y Doc_ref","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"7002b697-980d-6d7a-ebec-0745624fb7a3","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.005999326705932617","extra":[]}],"else":[{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"warning\",\"text\":\"No fue posible obtener la informacion del portapapeles correspondiente al aplicativo Siesa 8.5\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.6.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"201cdf4b-f9aa-0aa1-f09b-753e4c74e9f2","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":""},{"father":"setVar","command":"False","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"b2a56b6b-426e-567b-3f43-1ce2cc31c593","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.6.2","description":"","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":""},{"father":"stop","command":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"284db4a7-71c5-0399-907a-c7b06262c73e","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.6.3","execute":2,"index":2,"execute_debugg":0,"img":"","message":"","screenshot":""}],"line":"1.6","description":"Se validó que es posible obtener la información del aplicativo Siesa 8.5.","execute":2,"index":5,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":"True"}},{"father":"group","command":"","id":"e4675e46-ce5b-2288-aedd-af947f7d4201","group":"logic","mode_live":false,"children":[{"father":"setVar","command":"{gblDiccionarioDocAltSiesa}.get('Doct_Alt')","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"92be5844-6e0f-26b9-a102-e12ca594b627","group":"system","mode_live":false,"var":"gblDocAlt","children":[],"else":[],"execute":2,"message":"","time":"0.09375238418579102","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"Se asigna la informacion encontrada en el campo doc_alt, informacion encontrada: {gblDocAlt}\"}","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.2","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"d7e6a312-83ea-b86a-887c-b76a885ca241","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"setVar","command":"{gblDiccionarioDocAltSiesa}.get('Doc_Ref')","index":2,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.3","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"186433d2-dada-f03f-b945-f97857cc6499","group":"system","mode_live":false,"var":"gblDocRef","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"Se asigna la informacion correspondiente al doc_ref del aplicativo Siesa 8.5, informacion asignada: {gblDocRef}\"}","index":3,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.4","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"10537f0f-23c9-0172-1352-9f8c0c67b383","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"else":[],"line":"1.7","description":"Asignamos el valor de doc_alt y doc_ref obtenidos del aplicativo Siesa 8.5.","execute":2,"index":6,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":true}},{"father":"setVar","command":"True","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"eff22e15-b4a9-301c-7ee7-ddf353b52f4b","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.8","execute":2,"index":7,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":[]}],"else":[],"line":1,"execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0009996891021728516","extra":{"res":true}}],"ifs":[],"modules":[{"name":"System++","status":"Installed","version":"2.5","last_version":"2.5"},{"name":"sendToLogs","status":"Installed","version":"2.0"},{"name":"Vortex-Utils","status":"Installed","version":"1.0"},{"name":"clipboard","status":"Installed","version":"3.2.1","last_version":"3.2.1"}],"profile":{"log_destination":"db_path","deactivate_log":false,"log_path":null,"name":"024_ConsultaDocAlt","description":"Bot diseñado para encontrar la informacion de Doc_Alt y Doc_Ref del aplicativo siesa 8.5"},"vars":[{"name":"gblBandProceso","data":"True","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblInfoPantalla","data":"Using username \"energizando\".\r\nLast login: Wed Oct 22 16:12:05 2025 from 190.145.210.50\r\n+------------------------------------------------------------------------------+ | Ver.006.20250218           CONTABILIDAD GENERAL            OCTUBRE  23, 2025 | | UFCG1021            DOCUMENTOS - CONSULTA POR NUMERO                ROCKET   | +------------------------[ UFCG1C01.Ver.011.20250218 ]-------------------------+ +---------------------------------[ DOCUMENTO ]--------------------------------+ |Empresa : TI  C.O: 001 Doc.Nro: NI-000119 Fecha: 2021/02/24 Doc.Alt.: NI 119  | |Tercero :   900379268        TICLINE SAS                                      | |                                                                              | | Libro          Valor_Docto       Valor_Debito      Valor_Credito             | | NCIF            140,580.00         140,580.00         140,580.00             | +------------------------------------------------------------------------------+                         +-------------------------+                                                      |   OPCIONES A CONSULTAR  |                                                      |-------------------------|                                                      |> Otros Datos Basicos    |                                                      |  Contabilizacion        |                                                      +-------------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Enter-Acepta                                         PageDown PageUp ESC-Retorna na \r\n\r\n","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblRutaLogs","data":"C:/Users/administrator.ENERGIZANDO/Documents/01_RecuperacionSoportes/Process/logs/Log_22102025-183443.log","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblDiccionarioDocAltSiesa","data":"{'Doct_Alt': 'NI 119', 'Doc_Ref': ''}","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"loc024ContinuarProceso","data":"","type":"string","category":"validacion","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblDocAlt","data":"","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblDocRef","data":"","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":false}],"expose":{"title":{"en":"024_ConsultaDocAlt expose","es":"024_ConsultaDocAlt expose","pr":"024_ConsultaDocAlt expose"},"description":{"en":"Bot diseñado para encontrar la informacion de Doc_Alt y Doc_Ref del aplicativo siesa 8.5","es":"Bot diseñado para encontrar la informacion de Doc_Alt y Doc_Ref del aplicativo siesa 8.5","pr":"Bot diseñado para encontrar la informacion de Doc_Alt y Doc_Ref del aplicativo siesa 8.5"},"form":[]}}}