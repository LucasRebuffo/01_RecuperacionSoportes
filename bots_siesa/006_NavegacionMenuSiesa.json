{"project":{"commands":[{"father":"trycatch","command":"","id":"d3008b59-47f2-b737-9f57-6651d000b2f0","group":"logic","mode_live":false,"children":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"Loc006OpcionNavegacion,Loc006LetraNavegacion,Loc006ItemACtual,loc006ListaNavegacionSiesa,loc006ContinuarProceso\"}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"cleanVars","id":"74be9457-75a7-933b-2757-68999e74ba38","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.1","execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.004000186920166016","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"info\",\"text\":\"Se inicio el bot de navegacion en el menu del aplicativo Siesa 8.5\"}","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"1.2","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"ffd8e0a3-51be-e786-0bb6-103a60c1005c","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0030002593994140625","extra":[]},{"father":"setVar","command":"False","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"c6db3640-60ca-0334-5e35-3d9d00e4d476","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"line":"1.3","execute":2,"index":2,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0009999275207519531","extra":[],"description":"se inicializa bandera de proceso"},{"father":"setVar","command":"False","index":3,"execute_debugg":0,"img":"","screenshot":"","line":"1.4","description":"se inicializa bandera de proceso","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"2ee8f980-8483-115e-9f7f-392599ef36cc","group":"system","mode_live":false,"var":"loc006ContinuarProceso","children":[],"else":[],"execute":2,"message":"","time":"0.0009999275207519531","extra":[]},{"father":"wait","command":"1","index":4,"execute_debugg":0,"img":"","screenshot":"","line":"1.5","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"45462b1a-962d-5d6e-e184-b04ea64b960d","group":"system","mode_live":false,"children":[],"else":[],"execute":2,"message":""},{"father":"execScriptPython","command":"from VortexLibrary import logger \nlogger.log_path = \"{gblRutaLogs}\"\nlogger.task_name = tmp_global_obj[\"profile\"][\"name\"]\n\ndiccionario = {gblDiccionarioNavegacionSiesa}\n\nlogger.info(f\"Esta es la navegacion que se realizara en el aplicativo Siesa 8.5: {diccionario}\")\n\n# Convertir a lista de listas (no de tuplas)\nlista_listas = [[clave, valor] for clave, valor in diccionario.items()]\n\n# Guardar para usar en Rocketbot\nSetVar(\"loc006ListaNavegacionSiesa\", lista_listas)\n\nprint(lista_listas)\n","index":5,"execute_debugg":0,"img":"","screenshot":"","line":"1.6","description":"Se transforma el diccionario  de navegacion en una lista de pares (clave, valor).","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"5803bb43-c912-27fc-731e-d849a814d484","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":""},{"father":"for","command":"{\"iterable\":\"{loc006ListaNavegacionSiesa}\",\"count\":0}","index":6,"execute_debugg":0,"img":"","screenshot":"","line":"1.7","description":"Iteramos por cada item de navegacion ","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","var":"Loc006ItemACtual","id":"6da8cac0-6bd0-6d8d-0dae-338fb628f711","group":"logic","mode_live":false,"children":[{"father":"setVar","command":"{Loc006ItemACtual}[0]","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.1","description":"Se indico la opcion actual del aplicativo Siesa desde la cual se realizara la navegacion","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"170498e8-1298-8bee-fd74-c6b1295c088c","group":"system","mode_live":false,"var":"Loc006OpcionNavegacion","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"setVar","command":"{Loc006ItemACtual}[1]","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.2","description":"Letra que representa la opcion actual del aplicativo siesa","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"259036b6-b221-30ef-db01-113ca88bc04f","group":"system","mode_live":false,"var":"Loc006LetraNavegacion","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"send_keys","command":"{\"text\":\"{Loc006LetraNavegacion}\"}","disabled":false,"index":2,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.3","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"04147493-5a16-accd-4977-335743b0b66a","group":"desktop","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.07812666893005371","extra":[]},{"father":"module","command":"{\"module_name\":\"sendToLogs\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"trace\",\"text\":\"Navega en la opcion {Loc006OpcionNavegacion} con la letra de referencia {Loc006LetraNavegacion}\"}","disabled":false,"index":3,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.4","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"d80279e8-b706-f040-8ccd-b6211110a164","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]},{"father":"wait","command":"1","index":4,"execute_debugg":0,"img":"","screenshot":"","line":"1.7.5","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"374ded0c-f517-dd68-89d2-3db3e94e6ceb","group":"system","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"1.000462293624878","extra":[],"disabled":false}],"else":[],"execute":2,"message":"","time":"0.0","extra":{"res":false,"count":5}},{"father":"execRocketBotDB","command":"004_ObtenerInformacionDePantallaSiesa8.5","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"d8da7438-4662-2ed5-7633-6992d6acc135","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.8","execute":2,"index":7,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"3.333958625793457","extra":[]},{"father":"evaluateIf","command":"\"\"\"{gblInfoPantalla}\"\"\" != \"\"","index":8,"execute_debugg":0,"img":"","screenshot":"","line":"1.9","description":"Se valido si se obtiene la informacion correspondiente del aplicativo Siesa","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"03d92ef7-40ff-32ff-f929-ea6fe8cce140","group":"logic","mode_live":false,"children":[{"father":"execScriptPython","command":"from VortexLibrary import logger\n\n# Configuración inicial del logger\nlogger.log_path = GetVar(\"gblRutaLogs\")  # Usa GetVar para obtener el valor real\nlogger.task_name = tmp_global_obj[\"profile\"][\"name\"]\n\n# Obtenemos la información copiada de Siesa 8.5\ntexto = GetVar(\"gblInfoPantalla\")\nlogger.info(\"Se obtiene la información del portapapeles\")\n\n# Convertimos el texto obtenido de Siesa a minúsculas para trabajar con un mismo tipo de letra\ntexto = texto.lower()\n\n# Se busca la palabra de referencia 'empresa' para identificar la correcta navegación\npalabra_referencia = texto.find(\"empresa\")\n\nif palabra_referencia != -1:\n    logger.info(\"Se encontró la palabra de referencia 'Empresa' en la información procesada del aplicativo Siesa, la navegación se realizó exitosamente\")\n    SetVar(\"loc006ContinuarProceso\", True)\nelse:\n    logger.info(\"No fue posible encontrar la palabra de referencia 'Empresa', la navegación no se realizó con éxito\")  # <-- corregido 'logge' y 'Emprsea'\n    SetVar(\"loc006ContinuarProceso\", False)","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.9.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"680f0eab-2d63-cb78-681d-6d310ae1d1b0","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"else":[],"execute":2,"message":"","time":"0.0","extra":{"res":"True"}},{"father":"evaluateIf","command":"not {loc006ContinuarProceso}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"026a5ed0-e9a0-db8f-7885-1550609ec9aa","group":"logic","mode_live":false,"children":[{"father":"setVar","command":"False","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.10.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"6e34a01d-7741-42cb-6c52-a5224d98f789","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"execute":2,"message":""},{"father":"stop","command":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"311da50d-0314-5aaa-b8fe-7e226caab74e","group":"scripts","mode_live":false,"children":[],"else":[],"line":"1.10.2","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":""}],"else":[],"line":"1.10","description":"Se valido si la navegacion en el aplicativo Siesa no fue exitosa","execute":2,"index":9,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":"False"}},{"father":"setVar","command":"True","index":10,"execute_debugg":0,"img":"","screenshot":"","line":"1.11","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"50a6f971-6d9e-ef34-9532-e634d271b504","group":"system","mode_live":false,"var":"gblBandProceso","children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"else":[{"father":"module","command":"{\"module_name\":\"Vortex-Utils\",\"module\":\"sendText\",\"path\":\"{gblRutaLogs}\",\"infoType\":\"error\",\"text\":\"Ocurrio un error en la nevagacion del aplicativo Siesa 8.5.\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"1.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendText","id":"e578d0f0-6536-fc52-a2a3-2ba1914658f9","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.0","extra":[]}],"line":1,"execute":2,"index":0,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0020041465759277344","extra":{"res":true}}],"ifs":[],"modules":[{"name":"System++","status":"Installed","version":"2.5","last_version":"2.5"},{"name":"sendToLogs","status":"Installed","version":"2.0"},{"name":"Vortex-Utils","status":"Installed","version":"1.0"},{"name":"clipboard","status":"Installed","version":"3.2.1","last_version":"3.2.1"}],"profile":{"log_destination":"db_path","deactivate_log":false,"log_path":null,"name":"006_NavegacionMenuSiesa","description":"Bot encargado de realizar la navegacion inicial en el aplicativo Siesa 8.5, deteniendose en la opcion \"Consulta por numero\"."},"vars":[{"name":"gblDiccionarioNavegacionSiesa","data":"{\n    'Financiero': 'f',\n    'Contabilidad General': 'g',\n    'Contab': 'n',\n    'Auditoria de Documentos': 'r',\n    'Consulta por Numero': 'n'\n}","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"Loc006OpcionNavegacion","data":"","type":"string","category":"info( nombre y letra que erpresenta la navegacion)","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"Loc006LetraNavegacion","data":"","type":"string","category":"info( nombre y letra que erpresenta la navegacion)","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"Loc006ItemACtual","data":"","type":"string","category":"iterador","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"loc006ListaNavegacionSiesa","data":"","type":"string","category":"informacion de navegacion siesa","status":"0","constant":false,"defaultValue":"","disabled":false},{"name":"gblInfoPantalla","data":"Using username \"energizando\".\r\nLast login: Tue Oct 21 12:35:33 2025 from 190.145.210.50\r\n+------------------------------------------------------------------------------+ | Ver.006.20250218           CONTABILIDAD GENERAL            OCTUBRE  21, 2025 | | UFCG1021            DOCUMENTOS - CONSULTA POR NUMERO                ROCKET   | +------------------------------------------------------------------------------+ +------------------------------------------------------------------------------+ |Empresa       : __                                                            | |C.O.          :              (Enter=Todos)                                    | |Tipo Documento:              (Enter=Todos)                                    | |Nro. Documento:              (Enter=Todos)                                    | |                                                                              | |Fecha Inicial :              (Enter=Desde el inicio)                          | |                                                                              | +------------------------------------------------------------------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  F2-Consulta             F4-Borra               F10-Termina ESC-Retorna na \r\n\r\n","type":"string","category":"prueba","status":"0","constant":false,"defaultValue":"","disabled":true},{"name":"loc006ContinuarProceso","data":"","type":"string","category":"validacion (badera para continuar proceso)","status":"0","constant":false,"defaultValue":"","disabled":false}],"expose":{"title":{"en":"006_NavegacionMenuSiesa expose","es":"006_NavegacionMenuSiesa expose","pr":"006_NavegacionMenuSiesa expose"},"description":{"en":"Bot encargado de realizar la navegacion inicial en el aplicativo Siesa 8.5, deteniendose en la opcion \"Consulta por numero\".","es":"Bot encargado de realizar la navegacion inicial en el aplicativo Siesa 8.5, deteniendose en la opcion \"Consulta por numero\".","pr":"Bot encargado de realizar la navegacion inicial en el aplicativo Siesa 8.5, deteniendose en la opcion \"Consulta por numero\"."},"form":[]}}}